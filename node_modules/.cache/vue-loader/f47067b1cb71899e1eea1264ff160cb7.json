{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\src\\App.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\src\\App.vue","mtime":1597889072248},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KQGltcG9ydCAnLi9zdHlsZXMvaW5kZXguc2Nzcyc7DQojYXBwIHsNCiAgaGVpZ2h0OiAxMDAlOw0KICB3aWR0aDogMTAwJTsNCiAgZGlzcGxheTogZmxleDsNCiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgbWluLWhlaWdodDogMTAwdmg7DQp9DQouY2hpbGQtdmlldyB7ICANCiAgcG9zaXRpb246IGFic29sdXRlOyAgDQogIGxlZnQ6IDA7ICANCiAgdG9wOiAwOyAgDQogIHdpZHRoOiAxMDAlOyAgDQogIGhlaWdodDogMTAwJTsgIA0KICB0cmFuc2l0aW9uOiBhbGwgLjVzIGN1YmljLWJlemllciguNTUsMCwuMSwxKTsgIA0KfSAgDQoudHJhbnNpdGlvbi1wYWdlLWVudGVyIHsgIA0KICBvcGFjaXR5OiAwOyAgDQogIC13ZWJraXQtdHJhbnNmb3JtOiB0cmFuc2xhdGUoMzBweCwgMCk7ICANCiAgdHJhbnNmb3JtOiB0cmFuc2xhdGUoMzBweCwgMCk7ICANCn0gIA0KLnRyYW5zaXRpb24tcGFnZS1sZWF2ZS1hY3RpdmUgeyAgDQogIG9wYWNpdHk6IDA7ICANCiAgLXdlYmtpdC10cmFuc2Zvcm06IHRyYW5zbGF0ZSgtMzBweCwgMCk7ICANCiAgdHJhbnNmb3JtOiB0cmFuc2xhdGUoLTMwcHgsIDApOyAgDQp9ICANCg0K"},{"version":3,"sources":["App.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"App.vue","sourceRoot":"src","sourcesContent":["<!--\r\n * @Description: \r\n * @Version: 1.0\r\n * @Autor: cherry\r\n * @Date: 2020-06-04 14:15:58\r\n * @LastEditors: cherry\r\n * @LastEditTime: 2020-08-11 16:34:55\r\n--> \r\n<template>\r\n  <div id=\"app\">\r\n    <!-- <transition :name=\"transitionName\">  -->\r\n      <keep-alive :include=\"cachedViews\">\r\n        <router-view class=\"child-view\" v-wechat-title=\"$route.meta.title\"> </router-view>  \r\n      </keep-alive>\r\n    <!-- </transition> -->\r\n    <!-- 返回首页 -->\r\n    <back-icon></back-icon>\r\n  </div>\r\n</template>\r\n<script>\r\nimport getWXSign from \"@/utils/wx\"\r\nimport { mapGetters, mapActions, mapMutations } from \"vuex\";\r\nconst { AUTH_API }= require('@/config/index.js')\r\nimport utils from '@utils/utils'\r\n\r\nexport default {\r\n  name: \"App\",\r\n  data() {\r\n    return {\r\n      transitionName: 'transition-page'\r\n    }\r\n  },\r\n  //监听路由的路径，可以通过不同的路径去选择不同的切换效果  \r\n  watch: {  \r\n    '$route' (to, from) {  \r\n      if(to.path == '/'){  \r\n        this.transitionName = '';  \r\n      }else{  \r\n        this.transitionName = 'transition-page';  \r\n      }  \r\n      const { name } = this.$route\r\n      if (name) {\r\n        this.ADD_CACHED_VIEWS(this.$route)\r\n      }\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters(['cachedViews'])\r\n  },\r\n\r\n  methods: {\r\n    ...mapActions('index', [\r\n      // 获取当前位置经纬度信息\r\n      'setLocationCityInfo'\r\n    ]),\r\n    ...mapMutations('index', [\r\n      'SET_WXUSER',\r\n      'SET_VIPCARDINFO',\r\n      'ADD_CACHED_VIEWS'\r\n    ]),\r\n    // 初始化微信\r\n    getWxInit() {\r\n      // 处理路由token\r\n      let lasturl\r\n      if(window.$mode === 'hash') {\r\n        lasturl = utils.delData()\r\n      } else {\r\n        lasturl = utils.deleteUrlParams()\r\n      }\r\n      history.replaceState(null,null,lasturl)\r\n      console.log(lasturl, '==============lasturl', history)\r\n      setTimeout(() => {\r\n        getWXSign().then(wx => {\r\n          console.log(wx, '-----------wx')\r\n          window.$wx = wx\r\n        }).catch(res => {\r\n          console.log(res, '---------getWXSignError')\r\n        })\r\n      }, 500);\r\n    },\r\n    onCodeHandle() {\r\n      $eventBus.$on('handleCode', (res) => {\r\n        if(res === 9) { // 未授权\r\n          try {\r\n            this.$router.replace({\r\n              name: 'entrance'\r\n            })\r\n          } catch (error) {\r\n            console.err(error)\r\n          }\r\n        }\r\n      })\r\n    },\r\n    // 处理路由携带token直接跳转\r\n    tokenLink() {\r\n      let queryData\r\n      if(window.$mode === 'hash') {\r\n        queryData = utils.getData()\r\n      } else {\r\n        queryData = utils.formatUrlParams()\r\n      }\r\n      // console.log(queryData, '==000=====0000', window.location.href)\r\n      if(queryData && queryData.token && queryData.entrance === 'once') {\r\n        this.getWxInit()\r\n        this.$save.set('session', 'token', queryData.token)\r\n        this.$api.appInit().then(res => {\r\n          // 处理入口逻辑\r\n          if(res.state) {\r\n            let {vipCardInfo = {}, wxUser, target, param} = res.info\r\n            this.SET_WXUSER(wxUser)\r\n            this.SET_VIPCARDINFO(vipCardInfo)\r\n            // 储存会员卡信息\r\n            if (vipCardInfo.onceVip && !vipCardInfo.vipUser) {\r\n              vipCardInfo.isExpiration = true\r\n            }\r\n          }        \r\n        })\r\n      }\r\n    }\r\n  },\r\n  created() {\r\n  },\r\n  mounted() {\r\n    this.onCodeHandle()\r\n    console.log('app------mounted', this.$route, window.location,  '---------现在的路由')\r\n    if(!this.$save.get('session', 'token')) {\r\n      this.setLocationCityInfo()\r\n      // this.tokenLink()\r\n    }\r\n  },\r\n  destroyed() {\r\n\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n@import './styles/index.scss';\r\n#app {\r\n  height: 100%;\r\n  width: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  min-height: 100vh;\r\n}\r\n.child-view {  \r\n  position: absolute;  \r\n  left: 0;  \r\n  top: 0;  \r\n  width: 100%;  \r\n  height: 100%;  \r\n  transition: all .5s cubic-bezier(.55,0,.1,1);  \r\n}  \r\n.transition-page-enter {  \r\n  opacity: 0;  \r\n  -webkit-transform: translate(30px, 0);  \r\n  transform: translate(30px, 0);  \r\n}  \r\n.transition-page-leave-active {  \r\n  opacity: 0;  \r\n  -webkit-transform: translate(-30px, 0);  \r\n  transform: translate(-30px, 0);  \r\n}  \r\n\r\n</style>\r\n"]}]}