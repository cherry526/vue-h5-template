{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\src\\App.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\src\\App.vue","mtime":1597889072248},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgZ2V0V1hTaWduIGZyb20gIkAvdXRpbHMvd3giDQppbXBvcnQgeyBtYXBHZXR0ZXJzLCBtYXBBY3Rpb25zLCBtYXBNdXRhdGlvbnMgfSBmcm9tICJ2dWV4IjsNCmNvbnN0IHsgQVVUSF9BUEkgfT0gcmVxdWlyZSgnQC9jb25maWcvaW5kZXguanMnKQ0KaW1wb3J0IHV0aWxzIGZyb20gJ0B1dGlscy91dGlscycNCg0KZXhwb3J0IGRlZmF1bHQgew0KICBuYW1lOiAiQXBwIiwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgdHJhbnNpdGlvbk5hbWU6ICd0cmFuc2l0aW9uLXBhZ2UnDQogICAgfQ0KICB9LA0KICAvL+ebkeWQrOi3r+eUseeahOi3r+W+hO+8jOWPr+S7pemAmui/h+S4jeWQjOeahOi3r+W+hOWOu+mAieaLqeS4jeWQjOeahOWIh+aNouaViOaenCAgDQogIHdhdGNoOiB7ICANCiAgICAnJHJvdXRlJyAodG8sIGZyb20pIHsgIA0KICAgICAgaWYodG8ucGF0aCA9PSAnLycpeyAgDQogICAgICAgIHRoaXMudHJhbnNpdGlvbk5hbWUgPSAnJzsgIA0KICAgICAgfWVsc2V7ICANCiAgICAgICAgdGhpcy50cmFuc2l0aW9uTmFtZSA9ICd0cmFuc2l0aW9uLXBhZ2UnOyAgDQogICAgICB9ICANCiAgICAgIGNvbnN0IHsgbmFtZSB9ID0gdGhpcy4kcm91dGUNCiAgICAgIGlmIChuYW1lKSB7DQogICAgICAgIHRoaXMuQUREX0NBQ0hFRF9WSUVXUyh0aGlzLiRyb3V0ZSkNCiAgICAgIH0NCiAgICB9DQogIH0sDQogIGNvbXB1dGVkOiB7DQogICAgLi4ubWFwR2V0dGVycyhbJ2NhY2hlZFZpZXdzJ10pDQogIH0sDQoNCiAgbWV0aG9kczogew0KICAgIC4uLm1hcEFjdGlvbnMoJ2luZGV4JywgWw0KICAgICAgLy8g6I635Y+W5b2T5YmN5L2N572u57uP57qs5bqm5L+h5oGvDQogICAgICAnc2V0TG9jYXRpb25DaXR5SW5mbycNCiAgICBdKSwNCiAgICAuLi5tYXBNdXRhdGlvbnMoJ2luZGV4JywgWw0KICAgICAgJ1NFVF9XWFVTRVInLA0KICAgICAgJ1NFVF9WSVBDQVJESU5GTycsDQogICAgICAnQUREX0NBQ0hFRF9WSUVXUycNCiAgICBdKSwNCiAgICAvLyDliJ3lp4vljJblvq7kv6ENCiAgICBnZXRXeEluaXQoKSB7DQogICAgICAvLyDlpITnkIbot6/nlLF0b2tlbg0KICAgICAgbGV0IGxhc3R1cmwNCiAgICAgIGlmKHdpbmRvdy4kbW9kZSA9PT0gJ2hhc2gnKSB7DQogICAgICAgIGxhc3R1cmwgPSB1dGlscy5kZWxEYXRhKCkNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIGxhc3R1cmwgPSB1dGlscy5kZWxldGVVcmxQYXJhbXMoKQ0KICAgICAgfQ0KICAgICAgaGlzdG9yeS5yZXBsYWNlU3RhdGUobnVsbCxudWxsLGxhc3R1cmwpDQogICAgICBjb25zb2xlLmxvZyhsYXN0dXJsLCAnPT09PT09PT09PT09PT1sYXN0dXJsJywgaGlzdG9yeSkNCiAgICAgIHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICBnZXRXWFNpZ24oKS50aGVuKHd4ID0+IHsNCiAgICAgICAgICBjb25zb2xlLmxvZyh3eCwgJy0tLS0tLS0tLS0td3gnKQ0KICAgICAgICAgIHdpbmRvdy4kd3ggPSB3eA0KICAgICAgICB9KS5jYXRjaChyZXMgPT4gew0KICAgICAgICAgIGNvbnNvbGUubG9nKHJlcywgJy0tLS0tLS0tLWdldFdYU2lnbkVycm9yJykNCiAgICAgICAgfSkNCiAgICAgIH0sIDUwMCk7DQogICAgfSwNCiAgICBvbkNvZGVIYW5kbGUoKSB7DQogICAgICAkZXZlbnRCdXMuJG9uKCdoYW5kbGVDb2RlJywgKHJlcykgPT4gew0KICAgICAgICBpZihyZXMgPT09IDkpIHsgLy8g5pyq5o6I5p2DDQogICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5yZXBsYWNlKHsNCiAgICAgICAgICAgICAgbmFtZTogJ2VudHJhbmNlJw0KICAgICAgICAgICAgfSkNCiAgICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgY29uc29sZS5lcnIoZXJyb3IpDQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICB9KQ0KICAgIH0sDQogICAgLy8g5aSE55CG6Lev55Sx5pC65bimdG9rZW7nm7TmjqXot7PovawNCiAgICB0b2tlbkxpbmsoKSB7DQogICAgICBsZXQgcXVlcnlEYXRhDQogICAgICBpZih3aW5kb3cuJG1vZGUgPT09ICdoYXNoJykgew0KICAgICAgICBxdWVyeURhdGEgPSB1dGlscy5nZXREYXRhKCkNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHF1ZXJ5RGF0YSA9IHV0aWxzLmZvcm1hdFVybFBhcmFtcygpDQogICAgICB9DQogICAgICAvLyBjb25zb2xlLmxvZyhxdWVyeURhdGEsICc9PTAwMD09PT09MDAwMCcsIHdpbmRvdy5sb2NhdGlvbi5ocmVmKQ0KICAgICAgaWYocXVlcnlEYXRhICYmIHF1ZXJ5RGF0YS50b2tlbiAmJiBxdWVyeURhdGEuZW50cmFuY2UgPT09ICdvbmNlJykgew0KICAgICAgICB0aGlzLmdldFd4SW5pdCgpDQogICAgICAgIHRoaXMuJHNhdmUuc2V0KCdzZXNzaW9uJywgJ3Rva2VuJywgcXVlcnlEYXRhLnRva2VuKQ0KICAgICAgICB0aGlzLiRhcGkuYXBwSW5pdCgpLnRoZW4ocmVzID0+IHsNCiAgICAgICAgICAvLyDlpITnkIblhaXlj6PpgLvovpENCiAgICAgICAgICBpZihyZXMuc3RhdGUpIHsNCiAgICAgICAgICAgIGxldCB7dmlwQ2FyZEluZm8gPSB7fSwgd3hVc2VyLCB0YXJnZXQsIHBhcmFtfSA9IHJlcy5pbmZvDQogICAgICAgICAgICB0aGlzLlNFVF9XWFVTRVIod3hVc2VyKQ0KICAgICAgICAgICAgdGhpcy5TRVRfVklQQ0FSRElORk8odmlwQ2FyZEluZm8pDQogICAgICAgICAgICAvLyDlgqjlrZjkvJrlkZjljaHkv6Hmga8NCiAgICAgICAgICAgIGlmICh2aXBDYXJkSW5mby5vbmNlVmlwICYmICF2aXBDYXJkSW5mby52aXBVc2VyKSB7DQogICAgICAgICAgICAgIHZpcENhcmRJbmZvLmlzRXhwaXJhdGlvbiA9IHRydWUNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9ICAgICAgICANCiAgICAgICAgfSkNCiAgICAgIH0NCiAgICB9DQogIH0sDQogIGNyZWF0ZWQoKSB7DQogIH0sDQogIG1vdW50ZWQoKSB7DQogICAgdGhpcy5vbkNvZGVIYW5kbGUoKQ0KICAgIGNvbnNvbGUubG9nKCdhcHAtLS0tLS1tb3VudGVkJywgdGhpcy4kcm91dGUsIHdpbmRvdy5sb2NhdGlvbiwgICctLS0tLS0tLS3njrDlnKjnmoTot6/nlLEnKQ0KICAgIGlmKCF0aGlzLiRzYXZlLmdldCgnc2Vzc2lvbicsICd0b2tlbicpKSB7DQogICAgICB0aGlzLnNldExvY2F0aW9uQ2l0eUluZm8oKQ0KICAgICAgLy8gdGhpcy50b2tlbkxpbmsoKQ0KICAgIH0NCiAgfSwNCiAgZGVzdHJveWVkKCkgew0KDQogIH0NCn0NCg=="},{"version":3,"sources":["App.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAoBA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"App.vue","sourceRoot":"src","sourcesContent":["<!--\r\n * @Description: \r\n * @Version: 1.0\r\n * @Autor: cherry\r\n * @Date: 2020-06-04 14:15:58\r\n * @LastEditors: cherry\r\n * @LastEditTime: 2020-08-11 16:34:55\r\n--> \r\n<template>\r\n  <div id=\"app\">\r\n    <!-- <transition :name=\"transitionName\">  -->\r\n      <keep-alive :include=\"cachedViews\">\r\n        <router-view class=\"child-view\" v-wechat-title=\"$route.meta.title\"> </router-view>  \r\n      </keep-alive>\r\n    <!-- </transition> -->\r\n    <!-- 返回首页 -->\r\n    <back-icon></back-icon>\r\n  </div>\r\n</template>\r\n<script>\r\nimport getWXSign from \"@/utils/wx\"\r\nimport { mapGetters, mapActions, mapMutations } from \"vuex\";\r\nconst { AUTH_API }= require('@/config/index.js')\r\nimport utils from '@utils/utils'\r\n\r\nexport default {\r\n  name: \"App\",\r\n  data() {\r\n    return {\r\n      transitionName: 'transition-page'\r\n    }\r\n  },\r\n  //监听路由的路径，可以通过不同的路径去选择不同的切换效果  \r\n  watch: {  \r\n    '$route' (to, from) {  \r\n      if(to.path == '/'){  \r\n        this.transitionName = '';  \r\n      }else{  \r\n        this.transitionName = 'transition-page';  \r\n      }  \r\n      const { name } = this.$route\r\n      if (name) {\r\n        this.ADD_CACHED_VIEWS(this.$route)\r\n      }\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters(['cachedViews'])\r\n  },\r\n\r\n  methods: {\r\n    ...mapActions('index', [\r\n      // 获取当前位置经纬度信息\r\n      'setLocationCityInfo'\r\n    ]),\r\n    ...mapMutations('index', [\r\n      'SET_WXUSER',\r\n      'SET_VIPCARDINFO',\r\n      'ADD_CACHED_VIEWS'\r\n    ]),\r\n    // 初始化微信\r\n    getWxInit() {\r\n      // 处理路由token\r\n      let lasturl\r\n      if(window.$mode === 'hash') {\r\n        lasturl = utils.delData()\r\n      } else {\r\n        lasturl = utils.deleteUrlParams()\r\n      }\r\n      history.replaceState(null,null,lasturl)\r\n      console.log(lasturl, '==============lasturl', history)\r\n      setTimeout(() => {\r\n        getWXSign().then(wx => {\r\n          console.log(wx, '-----------wx')\r\n          window.$wx = wx\r\n        }).catch(res => {\r\n          console.log(res, '---------getWXSignError')\r\n        })\r\n      }, 500);\r\n    },\r\n    onCodeHandle() {\r\n      $eventBus.$on('handleCode', (res) => {\r\n        if(res === 9) { // 未授权\r\n          try {\r\n            this.$router.replace({\r\n              name: 'entrance'\r\n            })\r\n          } catch (error) {\r\n            console.err(error)\r\n          }\r\n        }\r\n      })\r\n    },\r\n    // 处理路由携带token直接跳转\r\n    tokenLink() {\r\n      let queryData\r\n      if(window.$mode === 'hash') {\r\n        queryData = utils.getData()\r\n      } else {\r\n        queryData = utils.formatUrlParams()\r\n      }\r\n      // console.log(queryData, '==000=====0000', window.location.href)\r\n      if(queryData && queryData.token && queryData.entrance === 'once') {\r\n        this.getWxInit()\r\n        this.$save.set('session', 'token', queryData.token)\r\n        this.$api.appInit().then(res => {\r\n          // 处理入口逻辑\r\n          if(res.state) {\r\n            let {vipCardInfo = {}, wxUser, target, param} = res.info\r\n            this.SET_WXUSER(wxUser)\r\n            this.SET_VIPCARDINFO(vipCardInfo)\r\n            // 储存会员卡信息\r\n            if (vipCardInfo.onceVip && !vipCardInfo.vipUser) {\r\n              vipCardInfo.isExpiration = true\r\n            }\r\n          }        \r\n        })\r\n      }\r\n    }\r\n  },\r\n  created() {\r\n  },\r\n  mounted() {\r\n    this.onCodeHandle()\r\n    console.log('app------mounted', this.$route, window.location,  '---------现在的路由')\r\n    if(!this.$save.get('session', 'token')) {\r\n      this.setLocationCityInfo()\r\n      // this.tokenLink()\r\n    }\r\n  },\r\n  destroyed() {\r\n\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n@import './styles/index.scss';\r\n#app {\r\n  height: 100%;\r\n  width: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  min-height: 100vh;\r\n}\r\n.child-view {  \r\n  position: absolute;  \r\n  left: 0;  \r\n  top: 0;  \r\n  width: 100%;  \r\n  height: 100%;  \r\n  transition: all .5s cubic-bezier(.55,0,.1,1);  \r\n}  \r\n.transition-page-enter {  \r\n  opacity: 0;  \r\n  -webkit-transform: translate(30px, 0);  \r\n  transform: translate(30px, 0);  \r\n}  \r\n.transition-page-leave-active {  \r\n  opacity: 0;  \r\n  -webkit-transform: translate(-30px, 0);  \r\n  transform: translate(-30px, 0);  \r\n}  \r\n\r\n</style>\r\n"]}]}