{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\src\\components\\common\\tabs\\sortTab.vue?vue&type=style&index=0&id=1270a36c&lang=scss&scoped=true&","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\src\\components\\common\\tabs\\sortTab.vue","mtime":1596624611120},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLnRhYmJhciB7DQogIGZvbnQtc2l6ZTogMjhweDsNCiAgcGFkZGluZzogMCAzMHB4Ow0KICBjb2xvcjogIzNDM0Y0RDsNCiAgcG9zaXRpb246IHJlbGF0aXZlOw0KICB6LWluZGV4OiAxMDA7DQp9DQoNCi5uYXYgew0KICBoZWlnaHQ6IDgwcHg7DQogIHBvc2l0aW9uOiByZWxhdGl2ZTsNCiAgei1pbmRleDogMTA7DQp9DQoNCi5hY3RpdmUgew0KICBjb2xvcjogI0Q5MDYzNDsNCn0NCg0KLm5hdi1pY29uIHsNCiAgZm9udC1zaXplOiAxOHB4Ow0KICBtYXJnaW4tbGVmdDogNnB4Ow0KfQ0KDQouc2Nyb2xsLWJveCB7DQogIGhlaWdodDogODEwcHg7DQogIG92ZXJmbG93OiBhdXRvOw0KfQ0KDQouc29ydC1saXN0IHsNCiAgZm9udC1zaXplOiAyOHB4Ow0KICB3aWR0aDogMTAwJTsNCiAgbWF4LWhlaWdodDogODEwcHg7DQogIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgdG9wOiA4MHB4Ow0KICBsZWZ0OiAwOw0KICBiYWNrZ3JvdW5kOiAjZmZmOw0KICB6LWluZGV4OiAxMTsNCn0NCg0KLnNvcnQtbGkgew0KICBwYWRkaW5nLWxlZnQ6IDMwcHg7DQogIGhlaWdodDogOTBweDsNCiAgbGluZS1oZWlnaHQ6IDkwcHg7DQp9DQoNCi5jYXQtbGVmdCB7DQogIHdpZHRoOiAzMzBweDsNCiAgYmFja2dyb3VuZDogI0Y3RjhGQTsNCn0NCg0KLmNhdC1sZWZ0IC5jYXQtbGkgew0KICBiYWNrZ3JvdW5kOiAjRjdGOEZBOw0KfQ0KDQouY2F0LXJpZ2h0IHsNCiAgd2lkdGg6IDQyMHB4Ow0KfQ0KDQouY2F0LWxlZnQgLmN1cnJlbnQgew0KICBiYWNrZ3JvdW5kOiAjRkZGRkZGOw0KICBib3JkZXItbGVmdDogOXB4IHNvbGlkICNGQkNDOTM7DQp9DQouc29ydFRhYiB7DQogIHBvc2l0aW9uOiByZWxhdGl2ZQ0KfQ0KLm1hc2sgew0KICBwb3NpdGlvbjogYWJzb2x1dGU7DQogIHRvcDogODBweDsNCiAgbGVmdDogMDsNCiAgd2lkdGg6IDEwMCU7DQogIGhlaWdodDogMTAwdmg7DQogIGJhY2tncm91bmQ6IHJnYmEoMCwwLDAsLjUpOw0KICB6LWluZGV4OiAxMDsNCn0NCg=="},{"version":3,"sources":["sortTab.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6WA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"sortTab.vue","sourceRoot":"src/components/common/tabs","sourcesContent":["<!--\r\n * @Description: \r\n * @Version: 1.0\r\n * @Autor: yesong\r\n * @Date: 2020-07-29 16:08:49\r\n * @LastEditors: cherry\r\n * @LastEditTime: 2020-07-30 17:57:48\r\n--> \r\n<template>\r\n  <div class=\"sortTab\">\r\n    <div class=\"tabbar\" id=\"tabbar\" :style=\"{background:  isShowPanel ? '#fff' : '' }\">\r\n      <div class=\"nav flex-b\">\r\n        <div class=\"nav-item flex-v\" @click=\"_tabCLick(0)\">\r\n          <span>{{business}}</span>\r\n          <span class=\"nav-icon iconfont iconicon_spread\"></span>\r\n        </div>\r\n        <div class=\"nav-item flex-v\" @click=\"_tabCLick(1)\">\r\n          <span>{{category}}</span>\r\n          <span class=\"nav-icon iconfont iconicon_spread\"></span>\r\n        </div>\r\n        <div class=\"nav-item flex-v\" @click=\"_tabCLick(2)\">\r\n          <span>{{sort}}</span>\r\n          <span class=\"nav-icon iconfont iconicon_spread\"></span>\r\n        </div>\r\n      </div>\r\n      <div class=\"sort-list\" v-show=\"isShowPanel\" catchtouchmove=\"catchtouchmove\">\r\n        <div v-if=\"activeIndex == 0\" class=\"scroll-div flex\">\r\n          <div class=\"cat-left scroll-box\">\r\n            <div\r\n              :class=\"['sort-li', 'cat-li', curAreaIndex === -2 ? 'current': '']\"\r\n              @click=\"_selectArea(-2, '全城', 0)\"\r\n            >全城</div>\r\n            <div\r\n              :class=\"['sort-li', 'cat-li', curAreaIndex === -1 ? 'current': '']\"\r\n              @click=\"_selectArea(-1, '热门商圈', 0)\"\r\n            >热门商圈</div>\r\n            <div v-for=\"(item, key) in areaList\" :key=\"key\">\r\n              <div\r\n                :class=\"['sort-li', 'cat-li', curAreaIndex == key ? 'current' : '']\"\r\n                @click=\"_selectArea(key, item.areaName, item.areaId)\"\r\n              >{{item.areaName}}</div>\r\n            </div>\r\n          </div>\r\n          <div class=\"cat-right scroll-box\">\r\n            <!-- <div class=' sort-li cat-li' bindtap='changeList' data-name=\"附近\" data-tabtype=\"0\" data-type=\"1\">附近</div> -->\r\n            <div v-for=\"(item, key) in areaListSec\" :key=\"key\">\r\n              <div\r\n                class=\"sort-li cat-li\"\r\n                bindtap=\"changeList\"\r\n                :data-bid=\"item.busCircleId\"\r\n                :data-aid=\"currentAreaId\"\r\n                :data-name=\"item.busCircleName\"\r\n                :data-tabtype=\"0\"\r\n                :data-type=\"item.type\"\r\n                :data-range=\"item.range\"\r\n                @click=\"changeList(item.busCircleName, $event)\"\r\n              >{{item.busCircleName}}</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div v-else-if=\"activeIndex == 1\" class=\"scroll-div flex\">\r\n          <div class=\"cat-left scroll-box\">\r\n            <div\r\n              :class=\"['sort-li', 'cat-li', curIndex == -1 ? 'current': '']\"\r\n              bindtap=\"changeList\"\r\n              data-cid=\"0\"\r\n              data-name=\"全部品类\"\r\n              data-tabtype=\"1\"\r\n              data-type=\"4\"\r\n              @click=\"changeList('全部品类', $event)\"\r\n            >全部品类</div>\r\n            <div v-for=\"(item, key) in categoryListFirst\" :key=\"key\">\r\n              <div\r\n                :class=\"['sort-li', 'cat-li', curIndex == key ? 'current' : '']\"\r\n                :data-index=\"key\"\r\n                bindtap=\"_selectCate\"\r\n                :data-id=\"item.ctgId\"\r\n                :data-name=\"item.ctgName\"\r\n                @click=\"_selectCate(item.ctgId, key, item.ctgName)\"\r\n              >{{item.ctgName}}</div>\r\n            </div>\r\n          </div>\r\n          <div class=\"cat-right scroll-box\">\r\n            <div\r\n              class=\"sort-li cat-li\"\r\n              bindtap=\"changeList\"\r\n              :data-cid=\"currentCtgId\"\r\n              :data-pcid=\"currentCtgId\"\r\n              data-name=\"全部\"\r\n              data-tabtype=\"1\"\r\n              data-type=\"4\"\r\n              @click=\"changeList('全部', $event)\"\r\n            >全部</div>\r\n            <div v-for=\"(item, key) in categoryListSec\" :key=\"key\">\r\n              <div\r\n                class=\"sort-li cat-li\"\r\n                bindtap=\"changeList\"\r\n                :data-cid=\"item.ctgId\"\r\n                :data-pcid=\"currentCtgId\"\r\n                :data-name=\"item.ctgName\"\r\n                data-tabtype=\"1\"\r\n                data-type=\"4\"\r\n                @click=\"changeList(item.ctgName, $event)\"\r\n              >{{item.ctgName}}</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div v-else-if=\"activeIndex == 2\" class=\"scroll-div scroll-box\">\r\n            <template>\r\n              <div\r\n                v-for=\"(item, key) in sortList\"\r\n                :key=\"key\"\r\n                class=\"sort-li act-li\"\r\n                bindtap=\"changeList\"\r\n                :data-name=\"item.name\"\r\n                :data-sorttype=\"item.sortType\"\r\n                data-tabtype=\"2\"\r\n                data-type=\"5\"\r\n                @click=\"changeList(item.name, $event)\"\r\n              >{{item.name}}</div>\r\n            </template>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <van-overlay :show=\"isShowPanel\" @click=\"_hidePanel\" :lock-scroll=\"false\" />\r\n  </div>\r\n</template>\r\n<script>\r\nexport default {\r\n  name: 'sortTab',\r\n  props: {\r\n    cityId: {\r\n      type: Number,\r\n      default: 0\r\n    }\r\n  },\r\n  data () {\r\n    return {\r\n      business: '商圈·全城',\r\n      category: '全部品类',\r\n      sort: '综合排序',\r\n      discount: '折扣筛选',\r\n      type: 1,\r\n      curAreaIndex: -3,\r\n      curIndex: -2,\r\n      activeIndex: -1,\r\n      currentIndex: -1,\r\n      areaList: [],\r\n      areaListSec: [],\r\n      categoryListFirst: [],\r\n      currentCtgId: -1,\r\n      categoryListSec: [],\r\n      curCateName: '全部品类',\r\n      // 距离\r\n      distanceList: [\r\n        {\r\n          type: 1,\r\n          range: '0',\r\n          busCircleName: '全城'\r\n        },\r\n        {\r\n          type: 1,\r\n          range: '500',\r\n          busCircleName: '500米'\r\n        },\r\n        {\r\n          type: 1,\r\n          range: '1000',\r\n          busCircleName: '1000米'\r\n        },\r\n        {\r\n          type: 1,\r\n          range: '2000',\r\n          busCircleName: '2000米'\r\n        },\r\n        {\r\n          type: 1,\r\n          range: '5000',\r\n          busCircleName: '5000米'\r\n        }\r\n      ],\r\n      // 综合排序下拉(精品特卖)\r\n      sortList: [\r\n        {\r\n          sortType: '1',\r\n          name: '综合排序'\r\n        },\r\n        {\r\n          sortType: '2',\r\n          name: '人气最高'\r\n        },\r\n        {\r\n          sortType: '3',\r\n          name: '距离优先'\r\n        },\r\n        {\r\n          sortType: '4',\r\n          name: '低价优先'\r\n        },\r\n        {\r\n          sortType: '5',\r\n          name: '高价优先'\r\n        },\r\n        {\r\n          sortType: '6',\r\n          name: '销量最高'\r\n        }\r\n      ],\r\n      isShowPanel: false\r\n    }\r\n  },\r\n  watch: {\r\n    cityId (cityId, oldCityId) {\r\n      if (cityId) {\r\n        this.areaListFn(cityId)\r\n        this.categoryFn(cityId)\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    // 获取城市区域列表\r\n    areaListFn (cityId = 0) {\r\n      this.$api.business_area({\r\n        cityId,\r\n        type: 2\r\n      }).then(res => {\r\n        this.areaList = res.info.areaList\r\n      })\r\n    },\r\n    // 获取品类列表\r\n    categoryFn (cityId = 0, ctgId = 0) { // ctgId: 父集品类Id，获取第一级品类时，传0\r\n      this.$api.business_category({\r\n        cityId,\r\n        ctgId,\r\n        type: 2\r\n      }).then(res => {\r\n        if (res.state) {\r\n          let _list = res.info.categoryList\r\n          if (ctgId) {\r\n            this.categoryListSec = _list\r\n          } else {\r\n            this.categoryListFirst = _list\r\n          }\r\n        }\r\n      })\r\n    },\r\n    // 展开面板\r\n    _tabCLick (index) {\r\n      if (this.isShowPanel && index === this.activeIndex) {\r\n        this.activeIndex = -1\r\n        this.isShowPanel = false\r\n        this.$emit('changemask', false)\r\n      } else {\r\n        this.activeIndex = index\r\n        this.isShowPanel = true\r\n        this.$emit('changemask', true)\r\n      }\r\n    },\r\n    // 筛选二级区域\r\n    _selectArea (index, name, areaId = 0) {\r\n      const curAreaIndex = this.curAreaIndex\r\n      if (curAreaIndex === index) return\r\n      if (name === '全城') {\r\n        this.curAreaIndex = -2\r\n        this.areaListSec = this.distanceList\r\n      } else {\r\n        let cityId = this.cityId || '27087'\r\n        let hot = name === '热门商圈' ? 1 : 0\r\n        this.$api.business_circle_v2({\r\n          type: 2,\r\n          cityId,\r\n          areaId,\r\n          hot\r\n        }).then(res => {\r\n          if (res.state) {\r\n            let busCircleList = res.info.busCircleList || []\r\n            let obj = {\r\n              busCircleName: '全部'\r\n            }\r\n            busCircleList.unshift(obj)\r\n            busCircleList.forEach(itme => {\r\n              itme.type = 2\r\n            })\r\n            this.areaListSec = busCircleList\r\n          }\r\n        })\r\n        this.curAreaIndex = index\r\n      }\r\n      this.curAreaName = name\r\n      this.currentAreaId = areaId || 0\r\n    },\r\n    // 获取热门商圈\r\n    _getHotCircle (cityId) {\r\n      return new Promise((resolve, reject) => {\r\n        if (this.busCircleList) {\r\n          resolve(this.busCircleList)\r\n        } else {\r\n          this.$api.business_circle({\r\n            cityId: this.cityId\r\n          }).then(res => {\r\n            if (res.code === 0) {\r\n              let busCircleList = res.info.busCircleList || []\r\n              this.busCircleList = busCircleList\r\n              resolve(busCircleList)\r\n            } else {\r\n              reject(res)\r\n            }\r\n          })\r\n        }\r\n      })\r\n    },\r\n    // 筛选二级分类\r\n    _selectCate (ctgId, index, curCateName) {\r\n      let cityId = this.cityId\r\n      this.currentCtgId = ctgId\r\n      this.curIndex = index\r\n      this.curCateName = curCateName\r\n      this.categoryFn(cityId, ctgId)\r\n    },\r\n    _hidePanel () {\r\n      this.activeIndex = -1\r\n      this.isShowPanel = false\r\n      this.$emit('changemask', false)\r\n    },\r\n    // 选定筛选条件\r\n    changeList (name, event) {\r\n      let activeIndex = this.activeIndex\r\n      if (activeIndex === 0) {\r\n        // 选择全部时将tabbar上显示为一级菜单\r\n        if (name === '全部') {\r\n          name = this.curAreaName\r\n        }\r\n        this.business = name\r\n      } else if (activeIndex === 1) {\r\n        // 【全部品类】增加选中样式\r\n        if (name === '全部品类') {\r\n          this.curIndex = -1\r\n          this.categoryListSec = []\r\n          this.curCateName = '全部品类'\r\n          this.currentCtgId = 0\r\n        }\r\n        // 选择全部时将tabbar上显示为一级菜单\r\n        if (name === '全部') {\r\n          name = this.curCateName\r\n        }\r\n        this.category = name\r\n      } else if (activeIndex === 2) {\r\n        this.sort = name\r\n      } else if (activeIndex === 3) {\r\n        this.discount = name\r\n      }\r\n      this._hidePanel()\r\n      // 将条件传给父组件\r\n      this.$emit('changeList', event.target.dataset)\r\n    }\r\n  },\r\n  created () {\r\n    if (this.cityId) {\r\n      this.areaListFn(this.cityId)\r\n      this.categoryFn(this.cityId)\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.tabbar {\r\n  font-size: 28px;\r\n  padding: 0 30px;\r\n  color: #3C3F4D;\r\n  position: relative;\r\n  z-index: 100;\r\n}\r\n\r\n.nav {\r\n  height: 80px;\r\n  position: relative;\r\n  z-index: 10;\r\n}\r\n\r\n.active {\r\n  color: #D90634;\r\n}\r\n\r\n.nav-icon {\r\n  font-size: 18px;\r\n  margin-left: 6px;\r\n}\r\n\r\n.scroll-box {\r\n  height: 810px;\r\n  overflow: auto;\r\n}\r\n\r\n.sort-list {\r\n  font-size: 28px;\r\n  width: 100%;\r\n  max-height: 810px;\r\n  position: absolute;\r\n  top: 80px;\r\n  left: 0;\r\n  background: #fff;\r\n  z-index: 11;\r\n}\r\n\r\n.sort-li {\r\n  padding-left: 30px;\r\n  height: 90px;\r\n  line-height: 90px;\r\n}\r\n\r\n.cat-left {\r\n  width: 330px;\r\n  background: #F7F8FA;\r\n}\r\n\r\n.cat-left .cat-li {\r\n  background: #F7F8FA;\r\n}\r\n\r\n.cat-right {\r\n  width: 420px;\r\n}\r\n\r\n.cat-left .current {\r\n  background: #FFFFFF;\r\n  border-left: 9px solid #FBCC93;\r\n}\r\n.sortTab {\r\n  position: relative\r\n}\r\n.mask {\r\n  position: absolute;\r\n  top: 80px;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100vh;\r\n  background: rgba(0,0,0,.5);\r\n  z-index: 10;\r\n}\r\n</style>\r\n"]}]}