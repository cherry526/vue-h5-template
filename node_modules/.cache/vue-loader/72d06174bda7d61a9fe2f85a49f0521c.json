{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\src\\components\\common\\tabs\\sortTab.vue?vue&type=style&index=0&id=1270a36c&scoped=true&lang=scss&","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\src\\components\\common\\tabs\\sortTab.vue","mtime":1595902112892},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCi50YWJiYXJ7DQogIGZvbnQtc2l6ZTogMjhweDsNCiAgcGFkZGluZzogMCAzMHB4Ow0KICBjb2xvcjogIzNDM0Y0RDsNCiAgcG9zaXRpb246IHJlbGF0aXZlOw0KICB6LWluZGV4OiAxMzsNCn0NCi5uYXZ7DQogIGhlaWdodDogODBweDsNCn0NCi5hY3RpdmV7DQogIGNvbG9yOiAjRDkwNjM0Ow0KfQ0KLm5hdi1pY29uIHsNCiAgbWFyZ2luLWxlZnQ6IDEycHg7DQogIGZvbnQtc2l6ZTogMThweDsNCiAgY29sb3I6ICM2NjY1NjQ7DQp9DQouc2Nyb2xsLXZpZXcgew0KICBoZWlnaHQ6IDgxMHB4OyAgDQp9DQouc29ydC1saXN0ew0KICBmb250LXNpemU6IDI4cHg7DQogIHdpZHRoOiAxMDAlOw0KICBtYXgtaGVpZ2h0OiA4MTBweDsNCiAgcG9zaXRpb246IGFic29sdXRlOw0KICB0b3A6IDgwcHg7DQogIGxlZnQ6IDA7DQogIGJhY2tncm91bmQ6ICNmZmY7DQogIHotaW5kZXg6IDExOw0KfQ0KLnNvcnQtbGl7DQogIHBhZGRpbmctbGVmdDogMzBweDsNCiAgaGVpZ2h0OiA5MHB4Ow0KICBsaW5lLWhlaWdodDogOTBweDsNCn0NCi5jYXQtbGVmdHsNCiAgd2lkdGg6IDMzMHB4Ow0KICBiYWNrZ3JvdW5kOiAjRjdGOEZBDQp9DQouY2F0LWxlZnQgLmNhdC1saXsNCiAgYmFja2dyb3VuZDogI0Y3RjhGQQ0KfQ0KLmNhdC1yaWdodHsNCiAgd2lkdGg6IDQyMHB4DQp9DQouY2F0LWxlZnQgLmN1cnJlbnR7DQogIGJhY2tncm91bmQ6ICNGRkZGRkY7DQogIGJvcmRlci1sZWZ0OiA5cHggc29saWQgI0ZCQ0M5MzsNCn0NCi5zY3JvbGwtYm94IHsNCiAgd2lkdGg6IDEwMCU7DQogIGhlaWdodDogMTAwJTsNCiAgb3ZlcmZsb3cteTogc2Nyb2xsOw0KfQ0K"},{"version":3,"sources":["sortTab.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+YA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"sortTab.vue","sourceRoot":"src/components/common/tabs","sourcesContent":["<!--\r\n * @Description: \r\n * @Version: 1.0\r\n * @Autor: cherry\r\n * @Date: 2020-07-24 11:22:47\r\n * @LastEditors: cherry\r\n * @LastEditTime: 2020-07-28 10:08:32\r\n--> \r\n<template>\r\n  <div>\r\n    <div class=\"tabbar\" id=\"tabbar\" :style=\"{background:  isShowPanel ? '#fff' : '' }\">\r\n      <div class=\"nav flex-b\">\r\n        <div class=\"nav-item flex-v\" @click=\"_tabCLick(0)\">\r\n          <!-- <span>{{business}}</span> -->\r\n          <span>{{businessName}}</span>\r\n          <span class=\"nav-icon iconfont iconicon_spread\"></span>\r\n        </div>\r\n        <div class=\"nav-item flex-v\" @click=\"_tabCLick(1)\">\r\n          <span>{{category}}</span>\r\n          <span class=\"nav-icon iconfont iconicon_spread\"></span>\r\n        </div>\r\n        <div class=\"nav-item flex-v\" @click=\"_tabCLick(2)\">\r\n          <!-- <span>{{sort}}</span> -->\r\n          <span>{{sortName}}</span>\r\n          <span class=\"nav-icon iconfont iconicon_spread\"></span>\r\n        </div>\r\n      </div>\r\n\r\n      <div class='sort-list' v-show='isShowPanel'>\r\n        <div v-if=\"activeIndex == 0\" class=\"scroll-view flex\">\r\n          <div class=\"cat-left scroll-box\" scroll-y>\r\n            <div class=' sort-li cat-li' :class=\"curAreaIndex == -2 ? 'current' : '' \" @click='_selectArea({name: \"全城\", index: -2, type: 0})'>全城</div>\r\n            <div class=' sort-li cat-li' :class=\"curAreaIndex == -1 ? 'current' : '' \" @click='_selectArea({name: \"热门商圈\", index: -1})'>热门商圈</div>\r\n            <div v-for=\"(item, index) in areaList\" :key=\"index\">\r\n              <div class='sort-li cat-li' :class=\"curAreaIndex == index ? 'current' : '' \"  @click='_selectArea({name: item.areaName, index: index, aid: item.areaId, range: item.range})'>{{item.areaName}}</div>\r\n            </div>\r\n          </div>\r\n          <div class=\"cat-right scroll-box\" scroll-y>\r\n            <div v-for=\"(item, index) in areaListSec\" :key=\"index\">\r\n              <div class=' sort-li cat-li' @click='changeList({bid: item.busCircleId, aid: currentAreaId, name: item.busCircleName, tabtype: 0, type: item.type, range: item.range })'>{{item.busCircleName}}</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div v-else-if=\"activeIndex == 1\" class=\"scroll-view flex\">\r\n          <div class=\"cat-left scroll-box\" scroll-y>\r\n            <div class=' sort-li cat-li' :class=\"curIndex == -1 ? 'current' : '' \" @click='changeList({cid: 0, name: \"全部品类\", type: 4, tabtype: 1})'>全部品类</div>\r\n            <div v-for=\"(item, index) in categoryListFirst\" :key=\"index\">\r\n              <div class='sort-li cat-li' :class=\"curIndex == index ? 'current' : '' \"  @click='_selectCate({index: index, id: item.ctgId, name: item.ctgName })'>{{item.ctgName}}</div>\r\n            </div>\r\n          </div>\r\n          <div class=\"cat-right scroll-box\" scroll-y>\r\n            <div class=' sort-li cat-li' @click='changeList({cid: currentCtgId, pcid: currentCtgId, name: \"全部\", tabtype: 1, type: 4})'>全部</div>\r\n            <div v-for=\"(item, index) in categoryListSec\" :key=\"index\">\r\n              <div class=' sort-li cat-li' @click='changeList({cid: item.ctgId, pcid: currentCtgId, name: item.ctgName, tabtype: 1, type: 4})'>{{item.ctgName}}</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div v-else-if=\"activeIndex == 2\" class=\"scroll-view scroll-box\" scroll-y>\r\n          <div v-for=\"(item, index) in (isMall ? sortList2 : sortList)\" :key=\"index\">\r\n            <div class='sort-li act-li' @click='changeList({sorttype: item.sortType, name: item.name, tabtype: 2, type: 5})'>{{item.name}}</div>\r\n          </div>\r\n        </div>\r\n        <div v-else-if=\"activeIndex == 3\" class=\"scroll-view scroll-box\" scroll-y>\r\n          <div v-for=\"(item, index) in discountList\" :key=\"index\">\r\n            <div class='sort-li act-li' @click='changeList({discountrange: item.discountRange, name: item.name, tabtype: 3, type: 6})'>{{item.name}}</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <van-overlay :show=\"isShowPanel\" @click=\"_hidePanel\" :lock-scroll=\"false\" />\r\n    <!-- <div class=\"mask\" v-show='isShowPanel' @click=\"_hidePanel\"></div> -->\r\n  </div>\r\n</template>\r\n<script>\r\n  export default {\r\n    name: 'sortTab',\r\n    components: {},\r\n    props: {\r\n      cityId: {\r\n        type: String | Number,\r\n        default: 0\r\n      },\r\n      isShowDiscount: {\r\n        type: Boolean,\r\n        default: false\r\n      },\r\n      // 是否是特卖商城页面\r\n      isMall: {\r\n        type: Boolean,\r\n        default: false\r\n      },\r\n      business: {\r\n        type: String,\r\n        default: '商圈·全城'\r\n      },\r\n      category: {\r\n        type: String,\r\n        default: '全部品类'\r\n      },\r\n      sort: {\r\n        type: String,\r\n        default: '综合排序'\r\n      },\r\n      discount: {\r\n        type: String,\r\n        default: '折扣筛选'\r\n      },\r\n      refresh: {\r\n        type: Boolean,\r\n        default: false\r\n      },\r\n      sortType: {\r\n        type: String | Number,\r\n        default: 1\r\n      }\r\n    },\r\n    data() {\r\n      return {\r\n        currentCtgId: 0,\r\n        curIndex: 0,\r\n        curAreaIndex:0,\r\n        activeIndex:-1,\r\n        currentIndex:-1,\r\n        curCateName: '全部品类',\r\n        categoryListFirst: [],\r\n        categoryListSec: [],\r\n        areaListSec: [],\r\n        // 距离\r\n        distanceList: [\r\n          {\r\n            type: 1,\r\n            range:'0',\r\n            busCircleName: '全城'\r\n          },{\r\n          type: 1,\r\n          range:'500',\r\n          busCircleName: '500米'\r\n        },{\r\n          type: 1,\r\n          range:'1000',\r\n          busCircleName: '1000米'\r\n        },{\r\n          type: 1,\r\n          range:'2000',\r\n          busCircleName: '2000米'\r\n        },{\r\n          type: 1,\r\n          range:'5000',\r\n          busCircleName: '5000米'\r\n        }],\r\n        // 综合排序下拉(首页)\r\n        sortList:[{\r\n          sortType: '1',\r\n          name: '综合排序'\r\n        }, {\r\n          sortType: '2',\r\n          name: '人气最高'\r\n        },{\r\n          sortType: '3',\r\n          name: '距离优先'\r\n        },{\r\n          sortType: '7',\r\n          name: '返现最低',\r\n        },{\r\n          sortType: '6',\r\n          name: '返现最高',\r\n        },{\r\n          sortType: '4',\r\n          name: '人均最低',\r\n        },{\r\n          sortType: '5',\r\n          name: '人均最高',\r\n        }],\r\n        // 综合排序下拉(精品特卖)\r\n        sortList2:[{\r\n          sortType: '1',\r\n          name: '综合排序'\r\n        }, {\r\n          sortType: '2',\r\n          name: '人气最高'\r\n        },{\r\n          sortType: '3',\r\n          name: '距离优先'\r\n        },{\r\n          sortType: '4',\r\n          name: '低价优先',\r\n        },{\r\n          sortType: '5',\r\n          name: '高价优先',\r\n        },{\r\n          sortType: '6',\r\n          name: '销量最高',\r\n        }],\r\n        // 折扣筛选\r\n        discountList:[{\r\n          discountRange: '0',\r\n          name: '全部折扣'\r\n        }, {\r\n          discountRange: '8|10',\r\n          name: '8~10折'\r\n        },{\r\n          discountRange: '5|8',\r\n          name: '5~8折'\r\n        },{\r\n          discountRange: '5|-1',\r\n          name: '5折以下'\r\n        }],\r\n        isShowPanel: false,\r\n        sortName: this.sort,\r\n        businessName: this.business\r\n      }\r\n    },\r\n    watch: {\r\n      sort: function(val) {\r\n        this.sortName = val\r\n      },\r\n      business: function(val) {\r\n        this.businessName = val\r\n      },\r\n      cityId: function( cityId, oldValue) {\r\n        console.log('observers',cityId)\r\n        if(cityId) {\r\n          this.areaList(cityId)\r\n          this.categoryList(cityId)\r\n        }\r\n      },\r\n      refresh: function( refresh, oldValue) {\r\n        if(refresh) {\r\n          // this.business ='商圈·全城'\r\n          // this.category ='全部品类'\r\n          // this.sort = '综合排序'\r\n          // this.discount ='折扣筛选'\r\n          // this.activeIndex =-1\r\n          // this.currentIndex =-1\r\n          // this.curCateName ='全部品类'\r\n          // this.curAreaIndex = -3\r\n          // this.curIndex =-3\r\n        }\r\n      }\r\n    },\r\n    computed: {},\r\n    methods: {\r\n      // 获取城市区域列表\r\n      areaList(cityId = 0) {\r\n        // let type = this.isMall ? 2 : 1\r\n        let type = this.sortType\r\n        this.$api.business_area({ cityId, type })\r\n          .then(res => {\r\n            this.areaList = res.info.areaList\r\n          })\r\n      },\r\n      // 获取品类列表\r\n      categoryList(cityId = 0, ctgId = 0) { // ctgId: 父集品类Id，获取第一级品类时，传0\r\n        // let type = this.isMall ? 2 : 1\r\n        let type = this.sortType\r\n        this.$api.business_category({ cityId, ctgId, type })\r\n          .then(res => {\r\n            if(res.state) {\r\n              let _list = res.info.categoryList\r\n              if(ctgId) {\r\n                this.categoryListSec = _list\r\n              } else {\r\n                this.categoryListFirst = _list\r\n              }\r\n            }\r\n            \r\n          })\r\n      },\r\n      // 展开面板\r\n      _tabCLick(index) {\r\n        if(this.isShowPanel && index == this.activeIndex) {\r\n            this.activeIndex = -1\r\n            this.isShowPanel = false\r\n          // 将条件传给父组件\r\n          this.$emit('changemask', false)\r\n        } else {\r\n            this.activeIndex = index,\r\n            this.isShowPanel = true\r\n          // 将条件传给父组件\r\n          this.$emit('changemask', true)\r\n        }\r\n      },\r\n      // 筛选二级区域\r\n      _selectArea(e) {\r\n        console.log(e, '筛选二级区域')\r\n        const { index, name, aid:areaId = 0 } = e\r\n        const curAreaIndex = this.curAreaIndex;\r\n        if(curAreaIndex == index) return\r\n        if(name == '全城') {\r\n          this.curAreaIndex = -2\r\n          this.areaListSec = this.distanceList\r\n        } else {\r\n          // let type = this.isMall ? 2 : 1\r\n          let type = this.sortType\r\n          let cityId = this.cityId || '27087'\r\n          let hot = name === '热门商圈' ? 1 : 0\r\n          this.$api.business_circle_v2({\r\n            type,\r\n            cityId,\r\n            areaId,\r\n            hot\r\n          }).then(res => {\r\n            if(res.state) {\r\n              let busCircleList = res.info.busCircleList || []\r\n              let obj = {\r\n                busCircleName: '全部'\r\n              }\r\n              busCircleList.unshift(obj)\r\n              busCircleList.forEach(itme => {\r\n                itme.type = 2\r\n              });\r\n              this.areaListSec = busCircleList\r\n            }\r\n          })\r\n          this.curAreaIndex = index\r\n        }\r\n        this.curAreaName = name,\r\n        this.currentAreaId = areaId || 0\r\n      },\r\n      // 获取热门商圈\r\n      _getHotCircle(cityId) {\r\n        return new Promise((resolve, reject) => {\r\n          if(this.busCircleList) {\r\n            resolve(this.busCircleList)\r\n          } else {\r\n            this.$api.business_circle({\r\n              cityId: this.cityId\r\n            }).then(res => {\r\n              if(res.state) {\r\n                this.busCircleList = res.info.busCircleList || []\r\n                resolve(this.busCircleList)\r\n              } else {\r\n                reject(res)\r\n              }\r\n            })\r\n          }\r\n        })\r\n        \r\n      },\r\n      // 筛选二级分类\r\n      _selectCate(e) {\r\n        console.log(e, '筛选二级分类')\r\n        let cityId = this.cityId;\r\n        let ctgId = e.id || 0;\r\n        let index = e.index\r\n        let curCateName = e.name\r\n        this.currentCtgId = ctgId\r\n        this.curIndex = index\r\n        this.curCateName\r\n        this.categoryList(cityId, ctgId)\r\n        \r\n      },\r\n      _hidePanel() {\r\n        this.activeIndex = -1\r\n        this.isShowPanel = false\r\n        this.$emit('changemask', false)\r\n      },\r\n      // 选定筛选条件\r\n      changeList(e) {\r\n        let name = e.name;\r\n        let activeIndex = this.activeIndex\r\n        if(activeIndex == 0) {\r\n          // 选择全部时将tabbar上显示为一级菜单\r\n          if(name == '全部') {\r\n            name = this.curAreaName\r\n          }\r\n          // this.business = name\r\n          this.businessName = name\r\n        } else if(activeIndex == 1) {\r\n          // 【全部品类】增加选中样式\r\n          if(name == '全部品类') {\r\n            this.curIndex = -1\r\n            this.categoryListSec = []\r\n            this.curCateName = '全部品类'\r\n            this.currentCtgId = 0\r\n          }\r\n          // 选择全部时将tabbar上显示为一级菜单\r\n          if(name == '全部') {\r\n            name = this.curCateName\r\n          }\r\n          this.category = name\r\n        } else if(activeIndex == 2) {\r\n          // this.sort = name\r\n          this.sortName = name\r\n        } else if(activeIndex == 3) {\r\n          this.discount = name\r\n        }\r\n        this._hidePanel()\r\n        // 将条件传给父组件\r\n        this.$emit('changeList', e)\r\n      }\r\n    },\r\n    mounted() {\r\n    },\r\n    created() {\r\n    }\r\n  }\r\n</script>\r\n<style scoped lang='scss'>\r\n.tabbar{\r\n  font-size: 28px;\r\n  padding: 0 30px;\r\n  color: #3C3F4D;\r\n  position: relative;\r\n  z-index: 13;\r\n}\r\n.nav{\r\n  height: 80px;\r\n}\r\n.active{\r\n  color: #D90634;\r\n}\r\n.nav-icon {\r\n  margin-left: 12px;\r\n  font-size: 18px;\r\n  color: #666564;\r\n}\r\n.scroll-view {\r\n  height: 810px;  \r\n}\r\n.sort-list{\r\n  font-size: 28px;\r\n  width: 100%;\r\n  max-height: 810px;\r\n  position: absolute;\r\n  top: 80px;\r\n  left: 0;\r\n  background: #fff;\r\n  z-index: 11;\r\n}\r\n.sort-li{\r\n  padding-left: 30px;\r\n  height: 90px;\r\n  line-height: 90px;\r\n}\r\n.cat-left{\r\n  width: 330px;\r\n  background: #F7F8FA\r\n}\r\n.cat-left .cat-li{\r\n  background: #F7F8FA\r\n}\r\n.cat-right{\r\n  width: 420px\r\n}\r\n.cat-left .current{\r\n  background: #FFFFFF;\r\n  border-left: 9px solid #FBCC93;\r\n}\r\n.scroll-box {\r\n  width: 100%;\r\n  height: 100%;\r\n  overflow-y: scroll;\r\n}\r\n</style>"]}]}