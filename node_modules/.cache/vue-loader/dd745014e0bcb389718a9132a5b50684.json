{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\src\\components\\common\\common\\uploadImg.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\src\\components\\common\\common\\uploadImg.vue","mtime":1596624611100},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAndXBsb2FkSW1nJywKICBkYXRhKCkgewogICAgcmV0dXJuIHt9CiAgfSwKICBwcm9wczogewogICAgaW1nczogewogICAgICB0eXBlOiBBcnJheQogICAgfSwKICAgIHVwbG9hZEltZ051bTogewogICAgICB0eXBlOiBOdW1iZXIsCiAgICAgIGRlZmF1bHQ6IDEKICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7CiAgICAvLyBnZXRXWFNpZ24oKQogICAgLy8gICAudGhlbigpCiAgICAvLyAgIC5jYXRjaChlcnIgPT4ge30pOwogIH0sCiAgbWV0aG9kczogewogICAgY2hvb3NlSW1nKCkgewogICAgICB2YXIgdGhhdCA9IHRoaXM7CiAgICAgIGxldCBjb3VudCA9IHRoaXMudXBsb2FkSW1nTnVtIHx8IDE7CiAgICAgICAgICBjb3VudCA9IGNvdW50IC0gdGhpcy5pbWdzLmxlbmd0aAogICAgICAkd3guY2hvb3NlSW1hZ2UoewogICAgICAgIGNvdW50OiBjb3VudCwgLy8g6buY6K6kOQogICAgICAgIHNpemVUeXBlOiBbIm9yaWdpbmFsIiwgImNvbXByZXNzZWQiXSwgLy8g5Y+v5Lul5oyH5a6a5piv5Y6f5Zu+6L+Y5piv5Y6L57yp5Zu+77yM6buY6K6k5LqM6ICF6YO95pyJCiAgICAgICAgc291cmNlVHlwZTogWyJhbGJ1bSIsICJjYW1lcmEiXSwgLy8g5Y+v5Lul5oyH5a6a5p2l5rqQ5piv55u45YaM6L+Y5piv55u45py677yM6buY6K6k5LqM6ICF6YO95pyJCiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7CiAgICAgICAgICB2YXIgbG9jYWxJZHMgPSByZXMubG9jYWxJZHM7IC8vIOi/lOWbnumAieWumueFp+eJh+eahOacrOWcsElE5YiX6KGo77yMbG9jYWxJZOWPr+S7peS9nOS4umltZ+agh+etvueahHNyY+WxnuaAp+aYvuekuuWbvueJhwogICAgICAgICAgdmFyIGkgPSAwLAogICAgICAgICAgICBsZW4gPSBsb2NhbElkcy5sZW5ndGg7CiAgICAgICAgICBmdW5jdGlvbiB1cGxvYWQoKSB7CiAgICAgICAgICAgICR3eC51cGxvYWRJbWFnZSh7CiAgICAgICAgICAgICAgbG9jYWxJZDogbG9jYWxJZHNbaV0sIC8vIOmcgOimgeS4iuS8oOeahOWbvueJh+eahOacrOWcsElE77yM55SxY2hvb3NlSW1hZ2XmjqXlj6PojrflvpcKICAgICAgICAgICAgICBpc1Nob3dQcm9ncmVzc1RpcHM6IDEsIC8vIOm7mOiupOS4ujHvvIzmmL7npLrov5vluqbmj5DnpLoKICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHsKICAgICAgICAgICAgICAgIGkrKzsKICAgICAgICAgICAgICAgIGlmIChpIDwgbGVuKSB7CiAgICAgICAgICAgICAgICAgIHVwbG9hZCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdmFyIHNlcnZlcklkID0gcmVzLnNlcnZlcklkOyAvLyDov5Tlm57lm77niYfnmoTmnI3liqHlmajnq69JROWNs21lZGlhX2lk5bCG5qyhaWTkvKDnu5nlkI7lj7DvvIznhLblkI7ov5Tlm55vc3Plm77niYflnLDlnYAKICAgICAgICAgICAgICAgIHRoYXQuJGFwaS5kb3dubG9hZEltYWdlKHsKICAgICAgICAgICAgICAgICAgbWVkaWFJZDogc2VydmVySWQKICAgICAgICAgICAgICAgIH0pLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgICAgICAgaWYgKHJlcy5zdGF0ZSkgewogICAgICAgICAgICAgICAgICAgIHRoYXQuaW1ncy5wdXNoKHJlcy5pbmZvLm1lZGlhVXJsKQogICAgICAgICAgICAgICAgICAgIC8vIOmqjOivgeWbvueJh+aVj+aEnwogICAgICAgICAgICAgICAgICAgIHRoYXQuJGVtaXQoJ3VwZGF0ZTppbWdzJywgdGhhdC5pbWdzKQogICAgICAgICAgICAgICAgICAgIHRoYXQuJFRvYXN0KGDkuIrkvKDmiJDlip9gKQogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHRoYXQuJFRvYXN0KHJlcy5tZXNzYWdlKQogICAgICAgICAgICAgICAgICAgIHRoYXQuJGVtaXQoJ2ltZ0Vycm9yJywgcmVzLm1lc3NhZ2UpCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgICB1cGxvYWQoKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0KfQo="},{"version":3,"sources":["uploadImg.vue"],"names":[],"mappings":";;;;;;;;;;;;;;AAcA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"uploadImg.vue","sourceRoot":"src/components/common/common","sourcesContent":["<!--\r\n * @Description: \r\n * @Version: 1.0\r\n * @Autor: yesong\r\n * @Date: 2020-08-03 20:49:17\r\n * @LastEditors: yesong\r\n * @LastEditTime: 2020-08-04 18:02:51\r\n--> \r\n<template>\r\n  <div @click=\"chooseImg\">\r\n    <slot name=\"uploadImg\"></slot>\r\n  </div>\r\n</template>\r\n<script>\r\n  export default {\r\n    name: 'uploadImg',\r\n    data() {\r\n      return {}\r\n    },\r\n    props: {\r\n      imgs: {\r\n        type: Array\r\n      },\r\n      uploadImgNum: {\r\n        type: Number,\r\n        default: 1\r\n      }\r\n    },\r\n    created() {\r\n      // getWXSign()\r\n      //   .then()\r\n      //   .catch(err => {});\r\n    },\r\n    methods: {\r\n      chooseImg() {\r\n        var that = this;\r\n        let count = this.uploadImgNum || 1;\r\n            count = count - this.imgs.length\r\n        $wx.chooseImage({\r\n          count: count, // 默认9\r\n          sizeType: [\"original\", \"compressed\"], // 可以指定是原图还是压缩图，默认二者都有\r\n          sourceType: [\"album\", \"camera\"], // 可以指定来源是相册还是相机，默认二者都有\r\n          success: function(res) {\r\n            var localIds = res.localIds; // 返回选定照片的本地ID列表，localId可以作为img标签的src属性显示图片\r\n            var i = 0,\r\n              len = localIds.length;\r\n            function upload() {\r\n              $wx.uploadImage({\r\n                localId: localIds[i], // 需要上传的图片的本地ID，由chooseImage接口获得\r\n                isShowProgressTips: 1, // 默认为1，显示进度提示\r\n                success: function(res) {\r\n                  i++;\r\n                  if (i < len) {\r\n                    upload();\r\n                  }\r\n                  var serverId = res.serverId; // 返回图片的服务器端ID即media_id将次id传给后台，然后返回oss图片地址\r\n                  that.$api.downloadImage({\r\n                    mediaId: serverId\r\n                  }).then(res => {\r\n                    if (res.state) {\r\n                      that.imgs.push(res.info.mediaUrl)\r\n                      // 验证图片敏感\r\n                      that.$emit('update:imgs', that.imgs)\r\n                      that.$Toast(`上传成功`)\r\n                    } else {\r\n                      that.$Toast(res.message)\r\n                      that.$emit('imgError', res.message)\r\n                    }\r\n                  });\r\n                }\r\n              });\r\n            }\r\n            upload();\r\n          }\r\n        });\r\n      }\r\n    }\r\n  }\r\n</script>\r\n<style lang=\"less\" scoped>\r\n\r\n</style>\r\n\r\n\r\n"]}]}