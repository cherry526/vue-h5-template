{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\src\\views\\active\\giftBag.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\src\\views\\active\\giftBag.vue","mtime":1596627053467},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcEdldHRlcnMsIG1hcEFjdGlvbnMsIG1hcE11dGF0aW9ucyB9IGZyb20gInZ1ZXgiOwppbXBvcnQgc2Vja2lsbE1peGluIGZyb20gJ0AvbWl4aW5zL3NlY2tpbGxNaXhpbicgCmltcG9ydCBhY3RpdmVIZWFkZXIgZnJvbSAnQGNvbXBvbmVudHMvYWN0aXZlL2FjdGl2ZUhlYWRlcicKaW1wb3J0IGFjdGl2ZUNhc2ggZnJvbSAnQGNvbXBvbmVudHMvYWN0aXZlL2FjdGl2ZUNhc2gnCmltcG9ydCBhY3RpdmVHaWZ0IGZyb20gJ0Bjb21wb25lbnRzL2FjdGl2ZS9hY3RpdmVHaWZ0JwppbXBvcnQgYWN0aXZlR2lmdFJlYXNvbiBmcm9tICdAY29tcG9uZW50cy9hY3RpdmUvYWN0aXZlR2lmdFJlYXNvbicKaW1wb3J0IGFjdGl2ZUdyYXBoaWMgZnJvbSAnQGNvbXBvbmVudHMvYWN0aXZlL2FjdGl2ZUdyYXBoaWMnCmltcG9ydCBhY3RpdmVGb290ZXIgZnJvbSAnQGNvbXBvbmVudHMvYWN0aXZlL2FjdGl2ZUZvb3RlcicKaW1wb3J0IGFjdGl2ZVV0aWxzIGZyb20gJ0AvZmlsdGVycy9hY3RpdmUuanMnCmltcG9ydCBvcmRlclBheSBmcm9tICJAL3V0aWxzL3BheSIKaW1wb3J0IHV0aWxzIGZyb20gIkAvdXRpbHMvdXRpbHMiCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnZ2lmdEJhZycsCiAgbWl4aW5zOiBbc2Vja2lsbE1peGluXSwKICBjb21wdXRlZDogewogIH0sCiAgY29tcG9uZW50czogewogICAgYWN0aXZlSGVhZGVyLAogICAgYWN0aXZlQ2FzaCwKICAgIGFjdGl2ZUdpZnQsCiAgICBhY3RpdmVHaWZ0UmVhc29uLAogICAgYWN0aXZlR3JhcGhpYywKICAgIGFjdGl2ZUZvb3RlcgogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHJlYWR5OiBmYWxzZSwKICAgICAgdGltZXI6IG51bGwsCiAgICAgIGxpbWl0VGltZXI6IG51bGwsCiAgICAgIHNob3dQb3A6IGZhbHNlLAogICAgICBidG5UZXh0OiAn56uL5Y2z5oqi6LStJywKICAgICAgaGVhZGxpbmU6ICcnLAogICAgICBzaG93VGltZTogdHJ1ZSwKICAgICAgcmVtYWluVGltZTogMCwKICAgICAgY2hhbm5lbFR5cGU6ICcnLAogICAgICBvcHRpb25zOiB0aGlzLiRyb3V0ZS5xdWVyeSB8fCB7fSwKICAgICAgYnRuRGlzYWJsZWQ6IGZhbHNlLCAvLyDmjInpkq7mmK/lkKbkuI3lj6/nlKgKICAgICAgYnRuRm9udFNpemU6ICdmdDM0JywKICAgICAgc2VsQ2FzaHJlZDoge30sCiAgICAgIHNlbENvbnN1bWVyOiB7fSwKICAgICAgY29uZGl0aW9uSW5mbzoge30sCiAgICAgIHRyYWN2ZWxVc2VyTGlzdDogW10sCiAgICAgIHNlbERhdGU6IHsKICAgICAgICBzdGFydFRpbWU6ICcnCiAgICAgIH0sCiAgICAgIGluZm86IHt9LAogICAgICByZWNlaXZlT2JqOiB7CiAgICAgICAgMjogJ+aWsOeUqOaItycsCiAgICAgICAgMzogJ+S8muWRmCcsCiAgICAgICAgNDogJ+mdnuS8muWRmCcKICAgICAgfSwKICAgICAgZG93blRpbWU6IHsKICAgICAgICBob3VyOiAnMDAnLAogICAgICAgIG1pbnV0ZTogJzAwJywKICAgICAgICBzZWNvbmQ6ICcwMCcKICAgICAgfSwKICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICAuLi5tYXBHZXR0ZXJzKFsibG9jYXRpb25JbmZvIiwgInd4VXNlciIsICJsb2NhdGlvbkNpdHkiLCAidmlwQ2FyZEluZm8iLCAidXBkYXRlR2lmdCJdKQogIH0sCiAgbWV0aG9kczogewogICAgLi4ubWFwTXV0YXRpb25zKCdhY3RpdmUnLCBbCiAgICAgICdTRVRfVVBEQVRFR0lGVCcKICAgIF0pLAogIC8vIOiuvue9ruaPkOmGkgogICAgcmVtaW5kU2V0KGUpIHsKCiAgICB9LAoKICAgIGhhbmRsZXJMaW1pdChyZXMsIGZsYWcpewogICAgICBpZiAocmVzLmluZm8ubGltaXRBY3RTdGF0ZSA9PSA4IHx8IHJlcy5pbmZvLmxpbWl0QWN0U3RhdGUgPT0gOSkgewogICAgICAgIHJlcy5pbmZvLnRpbWVTdGF0ZSA9IDEKICAgICAgICB0aGlzLmhlYWRsaW5lID0gYWN0aXZlVXRpbHMuZ2V0RGF5TmFtZShyZXMuaW5mby5saW1pdFN0YXJ0VGltZSkKICAgICAgfSBlbHNlIGlmIChyZXMuaW5mby5saW1pdEFjdFN0YXRlID09IDEgfHwgcmVzLmluZm8ubGltaXRBY3RTdGF0ZSA9PSAzIHx8IHJlcy5pbmZvLmxpbWl0QWN0U3RhdGUgPT0gMTApIHsKICAgICAgICByZXMuaW5mby50aW1lU3RhdGUgPSAyCiAgICAgIH0gZWxzZSBpZiAocmVzLmluZm8ubGltaXRBY3RTdGF0ZSA9PSAyKSB7CiAgICAgICAgcmVzLmluZm8udGltZVN0YXRlID0gMwogICAgICB9IGVsc2UgewogICAgICAgIC8vIDHmnKrlvIDlp4sgMui/m+ihjOS4rSAz5bey57uT5p2fCiAgICAgICAgbGV0IGN1cnJlbnRUaW1lID0gK25ldyBEYXRlKCkKICAgICAgICBpZigocmVzLmluZm8ubGltaXRFbmRUaW1lPGN1cnJlbnRUaW1lKSAmJiAocmVzLmluZm8ubGltaXRTdGFydFRpbWU8Y3VycmVudFRpbWUpKSB7CiAgICAgICAgICByZXMuaW5mby50aW1lU3RhdGUgPSAzCiAgICAgICAgfSBlbHNlIGlmICgocmVzLmluZm8ubGltaXRFbmRUaW1lPmN1cnJlbnRUaW1lKSAmJiAocmVzLmluZm8ubGltaXRTdGFydFRpbWU8Y3VycmVudFRpbWUpKXsKICAgICAgICAgIHJlcy5pbmZvLnRpbWVTdGF0ZSA9IDIKICAgICAgICB9IGVsc2UgaWYgKHJlcy5pbmZvLmxpbWl0U3RhcnRUaW1lPmN1cnJlbnRUaW1lKSB7CiAgICAgICAgICByZXMuaW5mby50aW1lU3RhdGUgPSAxCiAgICAgICAgICB0aGlzLmhlYWRsaW5lID0gYWN0aXZlVXRpbHMuZ2V0RGF5TmFtZShyZXMuaW5mby5saW1pdFN0YXJ0VGltZSkKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYocmVzLmluZm8udGltZVN0YXRlICE9IDMpIHsKICAgICAgICBjbGVhckludGVydmFsKHRoaXMubGltaXRUaW1lcikKICAgICAgICB0aGlzLmxpbWl0VGltZXIgPSBzZXRJbnRlcnZhbCgoKSA9PiB7CiAgICAgICAgICBsZXQgbm93VGltZSA9ICtuZXcgRGF0ZSgpCiAgICAgICAgICB2YXIgY3V0VGltZSA9IDAKICAgICAgICAgIGlmKHJlcy5pbmZvLnRpbWVTdGF0ZSA9PSAxKSB7CiAgICAgICAgICAgIGN1dFRpbWUgPSByZXMuaW5mby5saW1pdFN0YXJ0VGltZSAtIG5vd1RpbWUKICAgICAgICAgIH0gZWxzZSB7IAogICAgICAgICAgICBjdXRUaW1lID0gcmVzLmluZm8ubGltaXRFbmRUaW1lIC0gbm93VGltZQogICAgICAgICAgfQogICAgICAgICAgdGhpcy5kb3duVGltZSA9IHV0aWxzLmNvdW50RG93bjMoY3V0VGltZSkKICAgICAgICAgIGlmKGN1dFRpbWUgPD0gMCAmJiAocmVzLmluZm8ubGltaXRBY3RTdGF0ZSAhPSAxMikpewogICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMubGltaXRUaW1lcikKICAgICAgICAgICAgdGhpcy5nZXRBY3REZXRhaWwoKQogICAgICAgICAgfQogICAgICAgIH0sIDEwMDApCiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5kb3duVGltZSA9IHsKICAgICAgICAgIGhvdXI6ICcwMCcsCiAgICAgICAgICBtaW51dGU6ICcwMCcsCiAgICAgICAgICBzZWNvbmQ6ICcwMCcKICAgICAgICB9CiAgICAgIH0KICAgICAgY29uc29sZS5sb2coJ3Jlcy4uLi4uLi4uLi4uJywgcmVzLmluZm8sIHRoaXMuZG93blRpbWUpCgogICAgICBpZihmbGFnKSB7CiAgICAgICAgLy8g5bey5oqi5a6M5rS75Yqo5by556qXCiAgICAgICAgaWYocmVzLmluZm8ubGltaXRBY3RTdGF0ZSA9PSAzIHx8IHJlcy5pbmZvLmxpbWl0QWN0U3RhdGUgPT0gMiB8fCAhdGhpcy5pbmZvLnJlbWFpbk51bSkgewogICAgICAgICAgdGhpcy5nZXRFbmRBY3RpdmUoKQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIC8vIOOAguOAguOAguOAguOAguOAguOAguOAguOAguOAguOAguOAguOAguOAguOAguOAguOAguOAguOAguOAguOAguS8mOWMlue7k+adn+OAguOAguOAguOAguOAguOAguOAguOAguOAguOAguOAguOAguOAguOAggoKICAgIGNsb3NlUG9wKCkgewogICAgICB0aGlzLnNob3dQb3AgPSBmYWxzZQogICAgfSwKCiAgICAvLyDnpLzljIXnibnmnInkv6Hmga8KICAgIGdldEdpZnRJbmZvKCkgewogICAgICByZXR1cm4gdGhpcy4kYXBpLmFjdF9naWZ0X2luZm8oewogICAgICAgIGNoYW5uZWxUeXBlOiB0aGlzLmNoYW5uZWxUeXBlLAogICAgICAgIHFyQ29kZTogdGhpcy5xckNvZGUsCiAgICAgICAgYWN0U246IHRoaXMuYWN0U24sCiAgICAgICAgbGF0OiB0aGlzLmxvY2F0aW9uSW5mby5sYXRpdHVkZSwKICAgICAgICBsbmc6IHRoaXMubG9jYXRpb25JbmZvLmxvbmdpdHVkZQogICAgICB9KS50aGVuKHJlcyA9PiB7CiAgICAgICAgaWYgKHJlcy5zdGF0ZSkgewogICAgICAgICAgbGV0IGNhcmRTdW0gPSAwCiAgICAgICAgICByZXMuaW5mby5jYXJkTGlzdC5mb3JFYWNoKChpdGVtKSA9PiB7CiAgICAgICAgICAgIGNhcmRTdW0gKz0gaXRlbS5jYXJkTnVtCiAgICAgICAgICB9KQogICAgICAgICAgdGhpcy5pbmZvID0gT2JqZWN0LmFzc2lnbih7IGNhcmRTdW0gfSwgdGhpcy5pbmZvLCByZXMuaW5mbykKICAgICAgICAgIGlmIChyZXMuaW5mby5yZW1haW5OdW0gPT0gMCkgewogICAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+W3suWUrue9hCcsIHRydWUpCiAgICAgICAgICB9CiAgICAgICAgICAKICAgICAgICB9CiAgICAgIH0pCiAgICB9LAoKICAgIGhhbmRsZXJCdG4odGV4dCwgZGlzYWJsZWQ9ZmFsc2UsIGZvbnRTaXplPSdmdDM0JykgewogICAgICB0aGlzLmJ0blRleHQgPSB0ZXh0CiAgICAgIHRoaXMuYnRuRm9udFNpemUgPSBmb250U2l6ZQogICAgICB0aGlzLmJ0bkRpc2FibGVkID0gZGlzYWJsZWQKICAgICAgaWYgKGRpc2FibGVkKSB7CiAgICAgICAgdGhpcy5zaG93VGltZSA9IGZhbHNlCiAgICAgIH0KICAgIH0sCgogICAgLy8g5Yik5pat55So5oi36LSt5Lmw5L+h5oGvCiAgICBnZXRSZWFsVGltZUluZm8obGltaXRGcmVxdWVuY3kpIHsKICAgICAgcmV0dXJuIHRoaXMuJGFwaS5yZWFsVGltZV9pbmZvKHsKICAgICAgICBhY3RTbjogdGhpcy5hY3RTbgogICAgICB9KS50aGVuKHJlcyA9PiB7CiAgICAgICAgaWYgKHJlcy5zdGF0ZSkgewogICAgICAgICAgdGhpcy5yZWFsSW5mbyA9IHJlcy5pbmZvCiAgICAgICAgfQogICAgICB9KQogICAgfSwKICAgIGdldFJlY2VpdmVDb25kaXRpb24gKCkgewogICAgICByZXR1cm4gdGhpcy4kYXBpLnJlY2VpdmVfY29uZGl0aW9uKHsKICAgICAgICBhY3RTbjogdGhpcy5hY3RTbgogICAgICB9KS50aGVuKHJlcz0+IHsKICAgICAgICBpZiAocmVzLnN0YXRlKSB7CiAgICAgICAgICB0aGlzLmNvbmRpdGlvbkluZm8gPSByZXMuaW5mbwogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICAvLyDlpITnkIbnq4vljbPpooblj5bnmoTmjInpkq4KICAgIGhhbmRsZXJSZWNlaXZlQnRuKCkgewogICAgICBsZXQgaGFzUmVjZWl2ZUNoYW5uZWxGcmVlR2lmdCA9IHRoaXMuaW5mby5oYXNSZWNlaXZlQ2hhbm5lbEZyZWVHaWZ0CiAgICAgIGxldCBjaGFubmVsVHlwZSA9IHRoaXMuY2hhbm5lbFR5cGUKICAgICAgdGhpcy5oYW5kbGVyQnRuKCfnq4vljbPpooblj5YnKQogICAgICBpZiAoaGFzUmVjZWl2ZUNoYW5uZWxGcmVlR2lmdCAmJiBjaGFubmVsVHlwZSA9PSAnQ0hBTk5FTF9BQ1RJVklUWV9MQUJFTF9TSE9XJykgdGhpcy5oYW5kbGVyQnRuKCfpooblj5bmrKHmlbDlt7LnlKjlrownLCB0cnVlKQogICAgfSwKCiAgICAvLyDpgJrnlKjmtLvliqjor6bmg4UKICAgIGdldEFjdERldGFpbChmbGFnKSB7CiAgICAgIHRoaXMuJFRvYXN0LmxvYWRpbmcoewogICAgICAgIG1lc3NhZ2U6ICfliqDovb3kuK0uLi4nLAogICAgICAgIGZvcmJpZENsaWNrOiB0cnVlLAogICAgICAgIGR1cmF0aW9uOiAwCiAgICAgIH0pCiAgICAgIHJldHVybiB0aGlzLiRhcGkuYWN0X2RldGFpbCh7CiAgICAgICAgY2hhbm5lbFR5cGU6IHRoaXMuY2hhbm5lbFR5cGUsCiAgICAgICAgcXJDb2RlOiB0aGlzLnFyQ29kZSwKICAgICAgICBhY3RTbjogdGhpcy5hY3RTbgogICAgICB9KS50aGVuKGFzeW5jIHJlcyA9PiB7CiAgICAgICAgaWYgKHJlcy5zdGF0ZSkgewogICAgICAgICAgdGhpcy5lbnVtS2V5ID0gcmVzLmluZm8uY2hpbGRFbnVtS2V5CiAgICAgICAgICB0aGlzLnNob3dTaGFyZSA9IHRydWUKCiAgICAgICAgICAvLyDlpITnkIbpmZDml7bnmoTlgJLorqHml7bnrYnpl67popggCiAgICAgICAgICBpZiAoIHJlcy5pbmZvLmNoaWxkRW51bUtleSA9PSAnQUNUX0dJRlRfUEFDS0FHRV9QVVJDSEFTRV9MSU1JVCcpIHsKICAgICAgICAgICAgdGhpcy5oYW5kbGVyTGltaXQocmVzLCBmbGFnKQogICAgICAgICAgfQogICAgICAgICAgcmVzLmluZm8uY2hhbm5lbFR5cGUgPSB0aGlzLmNoYW5uZWxUeXBlIHx8ICcnCiAgICAgICAgICB0aGlzLmluZm8gPSBPYmplY3QuYXNzaWduKHt9LCB0aGlzLmluZm8sIHJlcy5pbmZvKQogICAgICAgICAgdGhpcy5yZW1haW5UaW1lID0gcmVzLmluZm8ucmVtYWluVGltZQogICAgICAgICAgdGhpcy5zaG93VGltZSA9IHJlcy5pbmZvLnNob3dUaW1lCiAgICAgICAgICB0aGlzLnJlYWR5ID0gdHJ1ZQoKICAgICAgICAgIGNvbnNvbGUubG9nKCdpbmZvLi4uLi4uLi4uLicsIHRoaXMuaW5mbykKCiAgICAgICAgICAvLyDmjInpkq7mloflrZcKICAgICAgICAgIGxldCB2aXBVc2VyID0gdGhpcy52aXBDYXJkSW5mby52aXBVc2VyCiAgICAgICAgICB0aGlzLnZpcFVzZXIgPSB0aGlzLnZpcENhcmRJbmZvLnZpcFVzZXIKICAgICAgICAgIGxldCBjaGFubmVsVHlwZSA9IHRoaXMuY2hhbm5lbFR5cGUKICAgICAgICAgIGxldCByZXN0cmljdFN0YXRlID0gdGhpcy5pbmZvLnJlc3RyaWN0U3RhdGUKICAgICAgICAgIGxldCBwYWNrYWdlR2lmdFR5cGUgPSB0aGlzLmluZm8ucGFja2FnZUdpZnRUeXBlCiAgICAgICAgICBsZXQgaGFzUmVjZWl2ZUNoYW5uZWxGcmVlR2lmdCA9IHRoaXMuaW5mby5oYXNSZWNlaXZlQ2hhbm5lbEZyZWVHaWZ0CiAgICAgICAgICBsZXQgcmVtYWluTnVtID0gdGhpcy5pbmZvLnJlbWFpbk51bQogICAgICAgICAgbGV0IGNoYW5uZWxUcmFjayA9IHRoaXMuaW5mby5jaGFubmVsVHJhY2sKICAgICAgICAgIGxldCBzZWxsUHJpY2UgPSB0aGlzLmluZm8uc2VsbFByaWNlCiAgICAgICAgICBsZXQgbm9WaXBQcmljZSA9IHRoaXMuaW5mby5ub1ZpcFByaWNlCiAgICAgICAgICBsZXQgc3RhdGUgPSByZXMuaW5mby5hY3RTdGF0ZQogICAgICAgICAgbGV0IGJ1eUxpbWl0ID0gcmVzLmluZm8uYnV5TGltaXQKCiAgICAgICAgICBpZiAoc3RhdGUgPT0gMSkgewogICAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+acquW8gOWniycsIHRydWUpCiAgICAgICAgICB9IGVsc2UgaWYgKHN0YXRlID09IDMpIHsKICAgICAgICAgICAgdGhpcy5oYW5kbGVyQnRuKCflt7LllK7nvYQnLCB0cnVlKQogICAgICAgICAgfSBlbHNlIGlmIChzdGF0ZSA9PSA0KSB7CiAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign5bey57uT5p2fJywgdHJ1ZSkKICAgICAgICAgIH0gZWxzZSBpZiAoc3RhdGUgPT0gNSkgewogICAgICAgICAgICAvLyAg5Lya5ZGYCiAgICAgICAgICAgIGlmKHZpcFVzZXIpewogICAgICAgICAgICAgIGlmIChzZWxsUHJpY2UgPiAwKXsKICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign5bey5ZSu572EJywgdHJ1ZSkKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVyQnRuKCfpooblj5bmrKHmlbDlt7LnlKjlrownLCB0cnVlKQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgaWYgKGJ1eUxpbWl0ID09IDEgJiYgbm9WaXBQcmljZSA+IDApIHsKICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign5bey5ZSu572EJywgdHJ1ZSkKICAgICAgICAgICAgICB9IGVsc2UgaWYgKGJ1eUxpbWl0ID09IDEgJiYgbm9WaXBQcmljZSA9PSAwKSB7CiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+mihuWPluasoeaVsOW3sueUqOWujCcsIHRydWUpCiAgICAgICAgICAgICAgfSBlbHNlIGlmIChidXlMaW1pdCA9PSAyKSB7CiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+W3suWUrue9hCcsIHRydWUpCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICAvLyDlpJbpg6jmuKDpgZPov5vlhaUKICAgICAgICAgIGlmIChzdGF0ZSA9PSAyKSB7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyAuLi4uLi4uLi4uLi4uLuWklumDqOa4oOmBk+ekvOWMheS4uuWUruWNluWeiy4uLi4uLi4uLi4uLi4uLi4uLi4uCiAgICAgICAgICAgIGlmIChjaGFubmVsVHJhY2sgPyBwYWNrYWdlR2lmdFR5cGUgPT0gMSA6IHJlc3RyaWN0U3RhdGUgPT0gMikgewogICAgICAgICAgICAgIGlmIChyZW1haW5OdW0gPiAwKSB7CiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+eri+WNs+i0reS5sCcpCiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIC8vICDkvJrlkZgKICAgICAgICAgICAgICAgIGlmICh2aXBVc2VyKSB7CiAgICAgICAgICAgICAgICAgIGlmIChzZWxsUHJpY2UgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVyQnRuKCflt7LllK7nvYQnLCB0cnVlKQogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign6aKG5Y+W5qyh5pWw5bey55So5a6MJywgdHJ1ZSkKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgaWYgKGJ1eUxpbWl0ID09IDEgJiYgbm9WaXBQcmljZSA+IDApIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+W3suWUrue9hCcsIHRydWUpCiAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYnV5TGltaXQgPT0gMSAmJiBub1ZpcFByaWNlID09IDApIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+mihuWPluasoeaVsOW3sueUqOWujCcsIHRydWUpCiAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYnV5TGltaXQgPT0gMikgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign5bey5ZSu572EJywgdHJ1ZSkKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgLy8g5LuF5Lya5ZGY5Y+v6LSt5Lmw5pe277yM6Z2e5Lya5ZGY5pi+56S6CiAgICAgICAgICAgICAgaWYgKGJ1eUxpbWl0ID09IDIgJiYgIXZpcFVzZXIpIHsKICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign5byA6YCa5bm26LSt5LmwJykKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIC8vIOS7heS8muWRmOWPr+i0reS5sO+8jOS8muWRmOS7t+S4ujDvvIzpnZ7kvJrlkZjop4bop5IKICAgICAgICAgICAgICBpZiAoYnV5TGltaXQgPT0gMiAmJiAhc2VsbFByaWNlICYmICF2aXBVc2VyKSB7CiAgICAgICAgICAgICAgICB0aGlzLm9wZW5fcmVjZWl2ZSA9IHRydWUKICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign5byA6YCa5bm26aKG5Y+WJykKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgLy8uLi4uLi4uLi4uLi4uLi4uLueri+WNs+mihuWPlueahOaMiemSruW8gOWniy4uLi4uLi4uLi4uLi4uLi4uLi4KICAgICAgICAgICAgICAvLyDku4XkvJrlkZjlj6/otK3kubDvvIzkvJrlkZjku7fkuLow77yM5Lya5ZGY6KeG6KeSCiAgICAgICAgICAgICAgaWYgKGJ1eUxpbWl0ID09IDIgJiYgIXNlbGxQcmljZSAmJiB2aXBVc2VyKSB7CiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJSZWNlaXZlQnRuKHN0YXRlKQogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgLy8g5omA5pyJ5Lq65Y+v6LSt5Lmw77yM5Lya5ZGY5Lu344CB6Z2e5Lya5ZGY5Lu36YO95Li6MO+8jOaJgOacieS6uuinhuinkgogICAgICAgICAgICAgIGlmIChidXlMaW1pdCA9PSAxICYmICFzZWxsUHJpY2UgJiYgIW5vVmlwUHJpY2UpIHsKICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlclJlY2VpdmVCdG4oc3RhdGUpCiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIAogICAgICAgICAgICAgIC8vIOaJgOacieS6uuWPr+i0reS5sO+8jOS8muWRmOS7t+OAgemdnuS8muWRmOS7t+mDveS4ujDvvIzmiYDmnInkurrop4bop5IKICAgICAgICAgICAgICBpZiAoYnV5TGltaXQgPT0gMSAmJiAhc2VsbFByaWNlICYmICFub1ZpcFByaWNlKSB7CiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJSZWNlaXZlQnRuKHN0YXRlKQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAKICAgICAgICAgICAgICAvLyDmiYDmnInkurrlj6/otK3kubDvvIzkvJrlkZjku7fjgIHpnZ7kvJrlkZjku7fpg73kuLow77yM5omA5pyJ5Lq66KeG6KeSCiAgICAgICAgICAgICAgaWYgKGJ1eUxpbWl0ID09IDEgJiYgIXNlbGxQcmljZSAmJiB2aXBVc2VyKSB7CiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJSZWNlaXZlQnRuKHN0YXRlKQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAvLy4uLi4uLi4uLi4uLi4uLi4u56uL5Y2z6aKG5Y+W55qE5oyJ6ZKu57uT5p2fLi4uLi4uLi4uLi4uLi4uLi4uLgoKICAgICAgICAgICAgfSBlbHNlIGlmIChjaGFubmVsVHJhY2sgPyBwYWNrYWdlR2lmdFR5cGUgPT0gMiA6IHJlc3RyaWN0U3RhdGUgPT0gMSkgewogICAgICAgICAgICAgIAogICAgICAgICAgICAgIC8vIC4uLi4uLi4uLi4uLi4u5aSW6YOo5rig6YGT56S85YyF5Li65YWN6LS56aKG5Y+W5Z6LLi4uLi4uLi4uLi4uLi4uLgogICAgICAgICAgICAgIGlmIChyZW1haW5OdW0gPiAwKSB7CiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+eri+WNs+mihuWPlicpCiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign5bey5ZSu572EJywgdHJ1ZSkKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKGhhc1JlY2VpdmVDaGFubmVsRnJlZUdpZnQgJiYgY2hhbm5lbFR5cGUgPT0gJ0NIQU5ORUxfQUNUSVZJVFlfTEFCRUxfU0hPVycpIHsKICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign6aKG5Y+W5qyh5pWw5bey55So5a6MJywgdHJ1ZSkKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCgogICAgICAgICAgICAvLy4uLi4uLi4uLi4uLi4uLi4uLi4u6aKG5Y+W5qyh5pWw5LiO6LSt5Lmw5qyh5pWw5piv5ZCm5bey55So5a6MLi4uLi4uLi4uLi4uLi4uLiAKICAgICAgICAgICAgbGV0IHRvdGFsTnVtID0gTnVtYmVyKHRoaXMucmVhbEluZm8udXNlckJ1eU51bSkgKyBOdW1iZXIodGhpcy5yZWFsSW5mby51c2VyRnJlZVJlY2VpdmVOdW0pIC8vIOW9k+WJjeeUqOaIt+eahOi0reS5sOaVsOmHj+WSjOmihuWPluaVsOmHj+aAu+WSjAogICAgICAgICAgICBsZXQgY29udGF0aW9uID0gKHJlcy5pbmZvLmJ1eUxpbWl0ID09IDEgJiYgIXJlcy5pbmZvLnNlbGxQcmljZSAmJiAhcmVzLmluZm8ubm9WaXBQcmljZSkgfHwgKHJlcy5pbmZvLmJ1eUxpbWl0ID09IDIgJiYgIXJlcy5pbmZvLnNlbGxQcmljZSkgLy8g5Yik5pat5bey6aKG5Y+W55qE54q25oCBCgogICAgICAgICAgICAvLyDliKTmlq3mmK/lkKbpmZDliLbotK3kubAKICAgICAgICAgICAgaWYgKHJlcy5pbmZvLmxpbWl0U3RhdGUpIHsKICAgICAgICAgICAgICBpZiAodG90YWxOdW0gPj0gcmVzLmluZm8ubGltaXRGcmVxdWVuY3kpIHsKCiAgICAgICAgICAgICAgICAvLyDnlKjmiLfmgLvmiJDlip/otK3kubDmlbDph4/lpKfkuo7pmZDliLbotK3kubDmlbDph48KICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign5bey6LSt5LmwJywgdHJ1ZSkKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKCh0b3RhbE51bSA+PSByZXMuaW5mby5saW1pdEZyZXF1ZW5jeSkgJiYgY29udGF0aW9uKSB7CgogICAgICAgICAgICAgICAgLy8g5b2T5YmN55So5oi35b2T5YmN5rS75Yqo5Lit5oC75YWN6LS56aKG5Y+W5pWw6YeP5aSn5LqO6ZmQ5Yi26aKG5Y+W5pWw6YePCiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+mihuWPluasoeaVsOW3sueUqOWujCcsIHRydWUpCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9IAogICAgICAgICAgLy8g5Yik5pat5Li65YWR5o2i5Lit5b+D6L+b5YWlCiAgICAgICAgICBpZiAodGhpcy5oYXNFeGNoYW5nZSAhPSAnJykgeyAKICAgICAgICAgICAgbGV0IGV4Y2hhbmdlX2RhdGEgPSB0aGlzLmV4Y2hhbmdlX2RhdGEgLy8g5YWR5o2i5Lit5b+D5rS75Yqo5pWw5o2uCgogICAgICAgICAgICBpZiAoZXhjaGFuZ2VfZGF0YS5oYXNFeGNoYW5nZSkgewogICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign5bey5YWR5o2iJywgdHJ1ZSkKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBpZiAoZXhjaGFuZ2VfZGF0YS5yZW1haW5OdW0gPiAwKSB7CiAgICAgICAgICAgICAgICBpZiAoZXhjaGFuZ2VfZGF0YS5zdGF0ZSAhPSAyKSB7CiAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign5bey57uT5p2fJywgdHJ1ZSkKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIGlmIChleGNoYW5nZV9kYXRhLmNvbmRpdGlvbikgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+eri+WNs+WFkeaNoicsIGZhbHNlKQogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign56uL5Y2z5YWR5o2iJywgdHJ1ZSkKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+W3suWFkeWujCcsIHRydWUpCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgLy8gLi4uLi4uLi4uLi4uLi4uLi7kvJjljJbmlrDlop4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uCiAgICAgICAgICAvLyDliKTmlq3ku47pmZDotK3ov5vlhaUKICAgICAgICAgIGlmICh0aGlzLmluZm8uY2hpbGRFbnVtS2V5ID09ICdBQ1RfR0lGVF9QQUNLQUdFX1BVUkNIQVNFX0xJTUlUJykgewogICAgICAgICAgICAvLyDliKTmlq3mjInpkq7nmoTlsZXnpLoKICAgICAgICAgICAgLy8gMS7mtLvliqjmnKrlvIDlp4sg5pyq6K6+572u5o+Q6YaSIC0tLS0tIOaPkOmGkuaIkS/pooTnuqbmj5DphpIgCiAgICAgICAgICAgIC8vIDIu5rS75Yqo5pyq5byA5aeLIOW3suiuvue9ruaPkOmGkiAtLS0tLSDlt7LpooTnuqYKICAgICAgICAgICAgLy8gMy7mtLvliqjov5vooYzkuK0gLS0tLS0g56uL5Y2z5oqi6LStCiAgICAgICAgICAgIC8vIDQu5rS75Yqo6L+b6KGM5LitIOi0reS5sOasoeaVsOi+vuWIsOS4iumZkC0tLS0tIOW3sui0reS5sAogICAgICAgICAgICAvLyA1Lua0u+WKqOi/m+ihjOS4rSDlupPlrZjkuLowIC0tLS0tIOW3suaKouWujAogICAgICAgICAgICAvLyA2Lua0u+WKqOacquWPkeW4gyDml6Dms5XotK3kubDjgIHorr7nva7mj5DphpIgLS0tLS0g6Iul54K55Ye777yM5YiZdG9hc3Tmj5DnpLrigJzlvZPliY3mtLvliqgv5ZCI6L6R5pyq5Y+R5biD4oCdCiAgICAgICAgICAgIC8vIDcu5rS75Yqo5bey57uT5p2fIC0tLS0tICDlt7LmiqLlrowKICAgICAgICAgICAgaWYgKCF0aGlzLmluZm8ucmVtYWluTnVtKSB7CiAgICAgICAgICAgICAgdGhpcy5oYW5kbGVyQnRuKCflt7LmiqLlrownLCB0cnVlKQogICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKHJlcy5pbmZvLmFjdFN0YXRlID09IDExICB8fCByZXMuaW5mby5hY3RTdGF0ZSA9PSAzKSB7CiAgICAgICAgICAgICAgdGhpcy5oYW5kbGVyQnRuKCflt7LmiqLlrownLCB0cnVlKQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIC8vIGlmIChyZXMuaW5mby5saW1pdEFjdFN0YXRlID09IDgpIHsKICAgICAgICAgICAgICAvLyAgIHRoaXMuaGFuZGxlckJ0bign6aKE57qm5o+Q6YaSJywgZmFsc2UpCiAgICAgICAgICAgICAgLy8gfSBlbHNlIGlmIChyZXMuaW5mby5saW1pdEFjdFN0YXRlID09IDkpIHsKICAgICAgICAgICAgICAvLyAgIHRoaXMuaGFuZGxlckJ0bign5bey6aKE57qmJywgZmFsc2UpCiAgICAgICAgICAgICAgLy8gfSAKICAgICAgICAgICAgICBpZiAocmVzLmluZm8ubGltaXRBY3RTdGF0ZSA9PSA4IHx8IHJlcy5pbmZvLmxpbWl0QWN0U3RhdGUgPT0gOSkgewogICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVyQnRuKCfmnKrlvIDlp4snLCB0cnVlKQogICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzLmluZm8ubGltaXRBY3RTdGF0ZSA9PSAxKSB7CiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+eri+WNs+aKoui0rScsIGZhbHNlKQogICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzLmluZm8ubGltaXRBY3RTdGF0ZSA9PSAxMCkgewogICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVyQnRuKCflt7LotK3kubAnLCB0cnVlKQogICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzLmluZm8ubGltaXRBY3RTdGF0ZSA9PSAzKSB7CiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+W3suaKouWujCcsIHRydWUpCiAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXMuaW5mby5saW1pdEFjdFN0YXRlID09IDIpIHsKICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign5bey5oqi5a6MJywgdHJ1ZSkKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLnNob3dCdG5UeHQgPSB0cnVlCiAgICAgICAgCiAgICAgICAgICAvLyDlpoLmnpzpnIDopoHmmL7npLrlgJLorqHml7YKICAgICAgICAgIGlmICh0aGlzLnNob3dUaW1lICYmIHRoaXMuaW5mby5jaGlsZEVudW1LZXkgIT0gJ0FDVF9HSUZUX1BBQ0tBR0VfUFVSQ0hBU0VfTElNSVQnKSB7CiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy50aW1lcikKICAgICAgICAgICAgdmFyIHJlbWFpblRpbWUgPSByZXMuaW5mby5yZW1haW5UaW1lCgogICAgICAgICAgICB0aGlzLnRpbWVyID0gc2V0SW50ZXJ2YWwoKCkgPT4gewogICAgICAgICAgICAgIGlmIChyZW1haW5UaW1lID49IDEwMDApIHsKICAgICAgICAgICAgICAgIHJlbWFpblRpbWUgLT0gMTAwMAogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMudGltZXIpCiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHRoaXMucmVtYWluVGltZSA9IHJlbWFpblRpbWUgfHwgMAogICAgICAgICAgICB9LCAxMDAwKQogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMuZ2V0Q2FzaE51bSgpIC8vIOiOt+WPlua0u+WKqOe6ouWMheW9k+WJjeS6q+eUqOacgOWkp+e6ouWMhQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmJhY2tfdG8ocmVzKQogICAgICAgIH0KICAgICAgfSkuZmluYWxseSgoKSA9PiB7CiAgICAgICAgdGhpcy4kVG9hc3QuY2xlYXIoKQogICAgICB9KQogICAgfSwKCiAgICAvLyDpooblj5bnpLzljIXmjqXlj6PosIPnlKgKICAgIC8vIHJlY2VpdmVUeXBlIOiOt+WPluaWueW8j++8jDHkvJrlkZjpooblj5bvvIwy5Lya5ZGY6LSt5Lmw77yMM+a4oOmBk+i0reS5sAogICAgcmVjZWl2ZUdpZnQocmVjZWl2ZVR5cGU9MSkgewogICAgICBsZXQgY29uZGl0aW9uSW5mbyA9IHRoaXMuY29uZGl0aW9uSW5mbwogICAgICBsZXQgdHJhY3ZlbFVzZXJMaXN0ID0gdGhpcy50cmFjdmVsVXNlckxpc3QKICAgICAgaWYgKGNvbmRpdGlvbkluZm8uaXNDb25kaXRpb24gJiYgdHJhY3ZlbFVzZXJMaXN0Lmxlbmd0aCA9PSAwKSB7CiAgICAgICAgLy8g5Yik5pat5piv5ZCm6ZyA5rGC5aGr5YaZ5L+h5oGvCiAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goewogICAgICAgICAgbmFtZTogJ3RyYXZlbEluZm9ybWF0aW9uJywKICAgICAgICAgIHF1ZXJ5OiB7CiAgICAgICAgICAgIGFjdFNuOiB0aGlzLm9wdGlvbnMuYWN0U24KICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIHJldHVybgogICAgICB9CiAgICAgIGxldCBhY3REZWFsID0gb3JkZXJQYXkuYWN0RGVhbCh7CiAgICAgICAgY2l0eUlkOiB0aGlzLmxvY2F0aW9uQ2l0eS5jaXR5SWQsCiAgICAgICAgYWN0U246IHRoaXMuYWN0U24sCiAgICAgICAgZGVhbE51bTogMSwKICAgICAgICBjaGFubmVsVHlwZTogdGhpcy5jaGFubmVsVHlwZSwKICAgICAgICByZWFsRmVlOiAwLAogICAgICAgIHJlY2VpdmVUeXBlLAogICAgICAgIG9wZW5WaXA6IGZhbHNlLCAvL+aYr+WQpuW8gOmAmuaciOWNoeS8muWRmOW5tui0reS5sAogICAgICAgIGFjdEZlZTogMCwgLy/mtLvliqjmlK/ku5jotLnnlKgKICAgICAgICB2aXBGZWU6IDAsCiAgICAgICAgdmlwQ2FyZElkOiAnJywKICAgICAgICBidXlUeXBlOiAwLAogICAgICAgIHFyQ29kZTogdGhpcy5xckNvZGUsCiAgICAgICAgY29tcElkOiB0aGlzLmNvbXBJZCwgLy8g5ZCI6L6RSWQKICAgICAgICBjaG9vc2VEYXRlOiB0aGlzLnNlbERhdGUuc3RhcnRUaW1lID8gdXRpbHMuZm9ybWF0VGltZSh0aGlzLnNlbERhdGUuc3RhcnRUaW1lIHx8IDAsICdZWVlZTU1ERCcpIDogMCwgLy8g6Ieq5oiR5ri46YCJ5oup5pe26Ze0CiAgICAgICAgdHJhY3ZlbFVzZXJMaXN0OiBKU09OLnN0cmluZ2lmeSh0aGlzLnRyYWN2ZWxVc2VyTGlzdCkKICAgICAgfSkKICAgICAgaWYgKGFjdERlYWwpIHsKICAgICAgICBhY3REZWFsLnRoZW4ocmVzID0+IHsKICAgICAgICAgIGlmIChyZXMuc3RhdGUpIHsKICAgICAgICAgICAgLy8g5pS55Y+Y5YWo5bGA6IO95ZCm5YWN6LS56aKG5Y+W56S85YyF55qE54q25oCBCiAgICAgICAgICAgIHRoaXMuU0VUX1VQREFURUdJRlQodHJ1ZSkKICAgICAgICAgICAgLy8g5riF6Zmk55So5oi35aGr5YaZ5L+h5oGvCiAgICAgICAgICAgIHRoaXMuJHNhdmUucmVtb3ZlKCdzZXNzaW9uJywgJ3RyYXZlbEluZm9ybWF0aW9uJykKICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goe25hbWU6ICdnaWZ0QmFnU3VjY2VzcycsIHF1ZXJ5OiB7IHRyYWRlSWQ6IHJlcy5pbmZvLnRyYWRlSWQsIGFjdE5hbWU6IHRoaXMuaW5mby5hY3ROYW1lLCByZWNlaXZlOiAxLCBhY3RTbjogdGhpcy5hY3RTbn19KQoKICAgICAgICAgICAgLy8g6Lez6L2s6aKG5Y+W5oiQ5Yqf6aG1CiAgICAgICAgICAgIC8vIHd4Lm5hdmlnYXRlVG8oewogICAgICAgICAgICAvLyAgIHVybDogYC9wYWdlcy9hY3Rpdml0eS9naWZ0X2JhZ19kZXRhaWwvc3VjY2Vzcy9zdWNjZXNzP3RyYWRlSWQ9JHtyZXMuaW5mby50cmFkZUlkfSZhY3ROYW1lPSR7dGhpcy5pbmZvLmFjdE5hbWV9JnJlY2VpdmU9MSZhY3RTbj0ke3RoaXMuYWN0U259YCwKICAgICAgICAgICAgLy8gICBzdWNjZXNzOiAocmVzdWx0KT0+ewogICAgICAgICAgICAvLyAgICAgdGhpcy5zZXREYXRhKHsKICAgICAgICAgICAgLy8gICAgICAgaXNDYW5DbGljazogZmFsc2UgCiAgICAgICAgICAgIC8vICAgICB9KQogICAgICAgICAgICAvLyAgIH0KICAgICAgICAgICAgLy8gfSk7CiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgfQogICAgfSwKCiAgICAvLyDliKTmlq3mmK/lkKbmnInmnKrmlK/ku5jnmoTorqLljZUKICAgIC8vIHJlY2VpdmVUeXBlIOiOt+WPluaWueW8j++8jDHkvJrlkZjpooblj5bvvIwy5Lya5ZGY6LSt5Lmw77yMM+a4oOmBk+i0reS5sAogICAgb3JkZXJVbnBheShyZWNlaXZlVHlwZSkgewogICAgICB0aGlzLiRzYXZlLnNldCgnc2Vzc2lvbicsICdvcmRlckluZm8nLCB0aGlzLmluZm8pCiAgICAgIGNvbnNvbGUubG9nKCd0aGlzLmluZm8nLCB0aGlzLmluZm8pCiAgICAgIGlmICh0aGlzLmlzQ2FuQ2xpY2syKSByZXR1cm4gCiAgICAgIHRoaXMuaXNDYW5DbGljazIgPSB0cnVlIAogICAgICB0aGlzLiRhcGkub3JkZXJfdW5wYXkoewogICAgICAgIGFjdFNuOiB0aGlzLmFjdFNuCiAgICAgIH0pLnRoZW4ocmVzID0+IHsKICAgICAgICBpZiAocmVzLnN0YXRlKSB7CiAgICAgICAgICBpZiAocmVzLmluZm8uZXhpc3RzVW5QYXkpIHsKICAgICAgICAgICAgLy8g5aaC5p6c5a2Y5Zyo5pyq5pSv5LuY55qE6K6i5Y2V77yM6Lez6L2s5Yiw6K6i5Y2V5YiX6KGo6aG1CiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgICBuYW1lOiAnb3JkZXJMaXN0JwogICAgICAgICAgICB9KQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5qdW1wU3VibWl0KHJlY2VpdmVUeXBlKQogICAgICAgICAgICB0aGlzLmlzQ2FuQ2xpY2syID0gZmFsc2UKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pLmNhdGNoKCgpID0+IHsKICAgICAgICB0aGlzLmlzQ2FuQ2xpY2syID0gZmFsc2UgCiAgICAgIH0pCiAgICB9LAoKICAgIC8vIOi3s+i9rOi0reS5sOmhtemdogogICAganVtcFN1Ym1pdChyZWNlaXZlVHlwZSkgewogICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgbmFtZTogJ3N1Ym1pdE9yZGVyJywKICAgICAgICBxdWVyeTogewogICAgICAgICAgcXJDb2RlOiB0aGlzLm9wdGlvbnMucXJDb2RlIHx8ICcnLAogICAgICAgICAgY29tcElkOiB0aGlzLm9wdGlvbnMuY29tcElkIHx8ICcnLAogICAgICAgICAgYWN0U246IHRoaXMub3B0aW9ucy5hY3RTbiwKICAgICAgICAgIGNoYW5uZWxUeXBlOiB0aGlzLm9wdGlvbnMuY2hhbm5lbFR5cGUsCiAgICAgICAgICByZWNlaXZlVHlwZTogcmVjZWl2ZVR5cGUsCiAgICAgICAgfQogICAgICB9KQogICAgICAKICAgIH0sCgogICAgLy8g6Z2e5Lya5ZGY5byA6YCa5bm26aKG5Y+WCiAgICBvcGVuUmVjZWl2ZSgpIHsKICAgICAgdGhpcy4kc2V0KHRoaXMuaW5mbywgJ3NlbGxQcmljZScsIDApCiAgICAgIHRoaXMuJHNldCh0aGlzLmluZm8sICdub1ZpcFByaWNlJywgMCkKICAgICAgdGhpcy4kc2F2ZS5zZXQoJ3Nlc3Npb24nLCAnb3JkZXJJbmZvJywgdGhpcy5pbmZvKQogICAgICAvLyDpnZ7kvJrlkZjlvIDpgJrlubbpooblj5YKICAgICAgbGV0IHJlY2VpdmVUeXBlID0gdGhpcy5jaGFubmVsVHlwZSA9PSAnQ0hBTk5FTF9BQ1RJVklUWV9MQUJFTF9TSE9XJyA/IDQgOiAxCiAgICAgIHRoaXMuanVtcFN1Ym1pdChyZWNlaXZlVHlwZSkKICAgIH0sCgogICAgaGFuZGxlckxpbWl0RXZlbnQoKSB7CiAgICAgIGlmKCB0aGlzLmluZm8ubGltaXRBY3RTdGF0ZSA9PSAxMiApIHsKICAgICAgICB0aGlzLiRUb2FzdCgn5b2T5YmN5ZCI6L6R6Z2e6L+b6KGM5Lit54q25oCBJykKICAgICAgfSBlbHNlIHsKICAgICAgICBpZih0aGlzLmJ0blRleHQgPT0gJ+eri+WNs+aKoui0rScpIHsKICAgICAgICAgIHRoaXMuJHNhdmUuc2V0KCdzZXNzaW9uJywgJ29yZGVySW5mbycsIHRoaXMuaW5mbykKICAgICAgICAgIHRoaXMuanVtcFN1Ym1pdCgyKQogICAgICAgIH0KICAgICAgfQogICAgfSwKCiAgICAvKioKICAgICog6aKG5Y+W5oiW6ICF5oqi6LSt56S85YyFCiAgICAgICAgcmVzdHJpY3RTdGF0ZSAg5piv5ZCm5Y+v6LSt5Lmw77yaMeWQpiAy5pivCiAgICAgICAgcmVjZWl2ZVR5cGU6IOWklumDqOa4oOmBk3sKICAgICAgICAgIOi0reS5sO+8miAzCiAgICAgICAgICDlhY3otLnpooY6ICAxCiAgICAgICAgfQogICAgKi8KICAgIGdldEdpZnQoKSB7CiAgICAgIHZhciB2aXBVc2VyID0gdGhpcy52aXBDYXJkSW5mby52aXBVc2VyCiAgICAgIHZhciBpc25ld1VzZXIgPSB0aGlzLnJlYWxJbmZvLm5ld1VzZXIKICAgICAgbGV0IHBhY2thZ2VHaWZ0VHlwZSA9IHRoaXMuaW5mby5wYWNrYWdlR2lmdFR5cGUgLy8gMeWUruWNliAy5YWN6LS56aKGCiAgICAgIGxldCBmcmVlUmVjZWl2ZVR5cGUgPSB0aGlzLmluZm8uZnJlZVJlY2VpdmVUeXBlIC8vIDHmiYDmnInkurrlj6/pooblj5YgMuS7hemZkOaWsOeUqOaItyAz5LuF6ZmQ5Lya5ZGYIDTku4XpmZDpnZ7kvJrlkZgKICAgICAgbGV0IHJlc3RyaWN0U3RhdGUgPSB0aGlzLmluZm8ucmVzdHJpY3RTdGF0ZQogICAgICBsZXQgY2hhbm5lbFRyYWNrID0gdGhpcy5pbmZvLmNoYW5uZWxUcmFjayAvLyDpgJrov4fov5nkuKrlrZfmrrXvvIzliKTmlq3nlKhwYWNrYWdlR2lmdFR5cGXov5jmmK9yZXN0cmljdFN0YXRl5a2X5q61CiAgICAgIHZhciBqdW1wU2F0ZSA9IGZhbHNlIC8vIOeUqOadpeWIpOaWreaYr+WQpuaPkOekuuS7hemZkOafkOeUqOaIt+mihuWPlgogICAgICBpZiAoZnJlZVJlY2VpdmVUeXBlID09IDEpIHsKICAgICAgICAvLyDmiYDmnInkurrlj6/pooblj5YKICAgICAgICBqdW1wU2F0ZSA9IHRydWUKICAgICAgfSBlbHNlIGlmIChmcmVlUmVjZWl2ZVR5cGUgPT0gMiAmJiBpc25ld1VzZXIpIHsKICAgICAgICAvLyDliKTmlq3nlKjmiLfmmK/lkKbkuLrmlrDnlKjmiLcKICAgICAgICBqdW1wU2F0ZSA9IHRydWUKICAgICAgfSBlbHNlIGlmIChmcmVlUmVjZWl2ZVR5cGUgPT0gMyAmJiB2aXBVc2VyKSB7CiAgICAgICAgLy8g5Yik5pat5piv5ZCm5LuF5Lya5ZGY6aKG5Y+WCiAgICAgICAganVtcFNhdGUgPSB0cnVlCiAgICAgIH0gZWxzZSBpZiAoZnJlZVJlY2VpdmVUeXBlID09IDQgJiYgIXZpcFVzZXIpIHsKICAgICAgICAvLyDliKTmlq3mmK/lkKbku4XpnZ7kvJrlkZjpooblj5YKICAgICAgICBqdW1wU2F0ZSA9IHRydWUKICAgICAgfQoKICAgICAgLy8g5aaC5p6c5piv5byA6YCa5bm26aKG5Y+WCiAgICAgIGlmICh0aGlzLm9wZW5fcmVjZWl2ZSkgewogICAgICAgIHRoaXMuJHNldCh0aGlzLmluZm8sICdzZWxsUHJpY2UnLCAwKQogICAgICAgIHRoaXMuJHNldCh0aGlzLmluZm8sICdub1ZpcFByaWNlJywgMCkKICAgICAgfQoKICAgICAgdGhpcy4kc2F2ZS5zZXQoJ3Nlc3Npb24nLCAnb3JkZXJJbmZvJywgdGhpcy5pbmZvKQogICAgICBpZiAodGhpcy5oYXNFeGNoYW5nZSAhPSAnJykgewogICAgICAgIC8vIOWIpOaWreWFkeWlluS4reW/g+i/m+WFpSDnq4vljbPlhZHmjaIKICAgICAgICBsZXQgY29uZGl0aW9uSW5mbyA9IHRoaXMuY29uZGl0aW9uSW5mbwogICAgICAgIGxldCB0cmFjdmVsVXNlckxpc3QgPSB0aGlzLnRyYWN2ZWxVc2VyTGlzdAogICAgICAgIGlmIChjb25kaXRpb25JbmZvLmlzQ29uZGl0aW9uICYmIHRyYWN2ZWxVc2VyTGlzdC5sZW5ndGggPT0gMCkgewogICAgICAgICAgLy8g5Yik5pat5piv5ZCm6ZyA5rGC5aGr5YaZ5L+h5oGvCiAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgICAgIG5hbWU6ICd0cmF2ZWxJbmZvcm1hdGlvbicsCiAgICAgICAgICAgIHF1ZXJ5OiB7CiAgICAgICAgICAgICAgYWN0U246IHRoaXMub3B0aW9ucy5hY3RTbgogICAgICAgICAgICB9CiAgICAgICAgICB9KQogICAgICAgICAgcmV0dXJuCiAgICAgICAgfQogICAgICAgIGlmICghdGhpcy5idG5EaXNhYmxlZCkgdGhpcy5leGNoYW5nZSgpCiAgICAgIH0gZWxzZSBpZiAodGhpcy5pbmZvLmNoaWxkRW51bUtleSA9PSAnQUNUX0dJRlRfUEFDS0FHRV9QVVJDSEFTRV9MSU1JVCcpIHsKICAgICAgICB0aGlzLmhhbmRsZXJMaW1pdEV2ZW50KCkKICAgICAgfSBlbHNlIGlmICh0aGlzLmluZm8uYWN0U3RhdGUgPT0gMikgewogICAgICAgIC8vIOWIpOaWreaYr+WQpuaYr+S7juWklumDqOa4oOmBk+i/m+WFpe+8jOWklumDqOa4oOmBk+i/m+WFpeaXtu+8jOWmguaenOmFjee9rueUqOaIt+WPr+i0reS5sO+8jOmdnuS8muWRmOS5n+WPr+i0reS5sOekvOWMhQogICAgICAgIGxldCBidXlMaW1pdCA9IHRoaXMuaW5mby5idXlMaW1pdAogICAgICAgIGxldCBzZWxsUHJpY2UgPSB0aGlzLmluZm8uc2VsbFByaWNlCiAgICAgICAgbGV0IG5vVmlwUHJpY2UgPSB0aGlzLmluZm8ubm9WaXBQcmljZQogICAgICAgIGxldCBidXlTdGF0ZSA9IGZhbHNlOwogICAgICAgIC8vICDmiYDmnInkurogICDkvJogMCAgIOmdniAwCiAgICAgICAgaWYgKGJ1eUxpbWl0ID09IDEgJiYgbm9WaXBQcmljZSA9PSAwICYmIHNlbGxQcmljZSA9PSAwKXsKICAgICAgICAgIGJ1eVN0YXRlID0gZmFsc2U7CiAgICAgICAgLy8gIOS8muWRmOi6q+S7vQogICAgICAgIH0gZWxzZSBpZiAodmlwVXNlciAmJiBzZWxsUHJpY2UgPiAwKXsKICAgICAgICAgIGJ1eVN0YXRlID0gdHJ1ZQogICAgICAgIH0gZWxzZSBpZiAoIXZpcFVzZXIpewogICAgICAgICAgYnV5U3RhdGUgPSBidXlMaW1pdCA9PSAyID8gdHJ1ZSA6IG5vVmlwUHJpY2UgPiAwIAogICAgICAgIH0KCiAgICAgICAgaWYgKGNoYW5uZWxUcmFjayA/IHBhY2thZ2VHaWZ0VHlwZSA9PSAxIDogcmVzdHJpY3RTdGF0ZSA9PSAyKSB7CgogICAgICAgICAgaWYoYnV5U3RhdGUpewogICAgICAgICAgICAvLyDotK3kubDnpLzljIUKCiAgICAgICAgICAgIC8vIOWmguaenOaYr+WklumDqOa4oOmBk+W5tuS4lOaYr+mihuWPlueKtuaAge+8jHJlY2VpdmVUeXBl5Li6NO+8jOi0reS5sOeKtuaAgXJlY2VpdmVUeXBl5Li6MgogICAgICAgICAgICBsZXQgcmVjZWl2ZVR5cGUgPSB0aGlzLmNoYW5uZWxUeXBlID09ICdDSEFOTkVMX0FDVElWSVRZX0xBQkVMX1NIT1cnICYmIHRoaXMub3Blbl9yZWNlaXZlID8gNCA6IDIKICAgICAgICAgICAgaWYgKGJ1eUxpbWl0ID09IDIgJiYgc2VsbFByaWNlID09IDApIHsKICAgICAgICAgICAgICByZWNlaXZlVHlwZSA9IDEKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLm9yZGVyVW5wYXkocmVjZWl2ZVR5cGUpICAgIAogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8g5L2/55So5a2X5q61cmVzdHJpY3RTdGF0ZeWIpOaWrQogICAgICAgICAgICB0aGlzLnJlY2VpdmVHaWZ0KDQpCiAgICAgICAgICB9CgogICAgICAgIH0gZWxzZSBpZiAoY2hhbm5lbFRyYWNrID8gcGFja2FnZUdpZnRUeXBlID09IDIgOiByZXN0cmljdFN0YXRlID09IDEpIHsKICAgICAgICAgIC8vIOWFjei0uemihgogICAgICAgICAgaWYgKGNoYW5uZWxUcmFjaykgewoKICAgICAgICAgICAgLy8g5L2/55So5a2X5q61cGFja2FnZUdpZnRUeXBl5Yik5patCiAgICAgICAgICAgIGlmIChmcmVlUmVjZWl2ZVR5cGUgIT0gMSAmJiAhanVtcFNhdGUpIHsKICAgICAgICAgICAgICB0aGlzLiRUb2FzdChg5LuF6ZmQJHt0aGlzLnJlY2VpdmVPYmpbZnJlZVJlY2VpdmVUeXBlXX3pooblj5ZgKQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRoaXMucmVjZWl2ZUdpZnQoNCkKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKCiAgICAgICAgICAgIC8vIOS9v+eUqOWtl+autXJlc3RyaWN0U3RhdGXliKTmlq0KICAgICAgICAgICAgdGhpcy5yZWNlaXZlR2lmdCg0KQogICAgICAgICAgfQogICAgICAgICAgCiAgICAgICAgfQogICAgICB9CiAgICB9LAoKICAgIC8vIOWFkeaNogogICAgZXhjaGFuZ2UgKCkgewogICAgICBsZXQgaXRlbSA9IHRoaXMuZXhjaGFuZ2VfZGF0YQogICAgICB0aGlzLiRkaWFsb2cuY29uZmlybSh7CiAgICAgICAgdGl0bGU6IGDmmK/lkKbnoa7orqTlhZHmjaIke2l0ZW0uYWN0TmFtZSB8fCAnJ30/YCwKICAgICAgICBtZXNzYWdlOiflhZHmjaLlkI7kuI3lj6/mm7TmlLnkuJTljp/mnInmva7ljaHlsIbkvJrmuIXnqbonLAogICAgICB9KS50aGVuKCgpPT57CiAgICAgICAgdGhpcy5wcmljZUV4Y2hhbmdlKGl0ZW0pCiAgICAgIH0pLmNhdGNoKCgpID0+IHsKICAgICAgICAgICAgLy8gb24gY2FuY2VsCiAgICAgIH0pOwogICAgfSwKCiAgICAvLyDlvIDlp4vlhZHmjaIKICAgIHByaWNlRXhjaGFuZ2UgKGl0ZW0pIHsKICAgICAgaWYgKHRoaXMuY2FuQ2xpY2spIHJldHVybgogICAgICB0aGlzLmNhbkNsaWNrID0gdHJ1ZQogICAgICB0aGlzLiRhcGkucHJpY2VfZXhjaGFuZ2UoewogICAgICAgIGFjdFNuOiBpdGVtLmFjdFNuLAogICAgICAgIGF3YXJkSWQ6IGl0ZW0uYXdhcmRJZCwKICAgICAgICBjaXR5SWQ6IHRoaXMubG9jYXRpb25DaXR5LmNpdHlJZCwKICAgICAgICBjaG9vc2VEYXRlOiB0aGlzLnNlbERhdGUuc3RhcnRUaW1lID8gdXRpbHMuZm9ybWF0VGltZSh0aGlzLnNlbERhdGUuc3RhcnRUaW1lIHx8IDAsICdZWVlZTU1ERCcpIDogMCwgLy8g6Ieq5oiR5ri46YCJ5oup5pe26Ze0CiAgICAgICAgdHJhY3ZlbFVzZXJMaXN0OiBKU09OLnN0cmluZ2lmeSh0aGlzLnRyYWN2ZWxVc2VyTGlzdCkKICAgICAgfSkudGhlbihyZXMgPT4gewogICAgICAgIGlmIChyZXMuc3RhdGUpIHsKICAgICAgICAgIHRoaXMubWFzayA9IHRydWUKICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign5bey5YWR5o2iJywgdHJ1ZSkKICAgICAgICAgIC8vIOa4hemZpOeUqOaIt+Whq+WGmeS/oeaBrwogICAgICAgICAgdGhpcy4kc2F2ZS5yZW1vdmUoJ3Nlc3Npb24nLCAndHJhdmVsSW5mb3JtYXRpb24nKQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLiRUb2FzdChyZXMubWVzc2FnZSkKICAgICAgICB9CiAgICAgIH0pLmZpbmFsbHkoKCk9PnsKICAgICAgICBzZXRUaW1lb3V0KCgpPT57CiAgICAgICAgICB0aGlzLmNhbkNsaWNrID0gZmFsc2UKICAgICAgICB9LCAzMDApCiAgICAgIH0pCiAgICB9LAoKICAgIGdvQ2FyZCgpIHsKICAgICAgdGhpcy4kcm91dGVyLnB1c2goewogICAgICAgIG5hbWU6ICdjb3Vwb25MaXN0JwogICAgICB9KQogICAgfSwKCiAgICBjbG9zZSgpIHsKICAgICAgdGhpcy5tYXNrID0gZmFsc2UKICAgIH0sCgogICAgLy8g6I635Y+W5Lya5ZGY5Y2h5pyA5L2O5Lu35qC8CiAgICB2aXBQcmljZSgpIHsKICAgICAgdGhpcy4kYXBpLmxvd19wcmljZSh7fSkudGhlbihyZXMgPT4gewogICAgICAgIGlmIChyZXMuc3RhdGUpIHsKICAgICAgICAgIHRoaXMubG93UHJpY2UgPSByZXMuaW5mby5sb3dQcmljZQogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICAKICAgIHNob3dPcmRlclRpcCgpIHsKICAgICAgdGhpcy4kZGlhbG9nLmFsZXJ0KHsKICAgICAgICB0aXRsZTogJ+aPkOekuicsCiAgICAgICAgbWVzc2FnZTogJ+iuouWNlei2heaXtuW3suWPlua2iO+8jOivt+mHjeaWsOS4i+WNlScsCiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnoa7lrponLAogICAgICAgIGNvbmZpcm1CdXR0b25Db2xvcjogJyNEOTA2MzQnCiAgICAgIH0pCiAgICB9LAogICAgCiAgICB0b0pvaW4oKSB7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICBuYW1lOidqb2luVmlwJywKICAgICAgICBxdWVyeTogewogICAgICAgICAgY2hhbm5lbFR5cGU6IHRoaXMuY2hhbm5lbFR5cGUKICAgICAgICB9CiAgICAgIH0pCiAgICB9LAoKICAgIC8vIOWFs+mXree6ouWMheWIl+ihqAogICAgY29sc2VjYXNoTWFzaygpIHsKICAgICAgdGhpcy5jYXNoTWFzayA9ICF0aGlzLmNhc2hNYXNrCiAgICB9LAoKICAgIC8vIOiOt+WPlua0u+WKqOe6ouWMheW9k+WJjeS6q+eUqOacgOWkp+e6ouWMhQogICAgZ2V0Q2FzaE51bSgpIHsKICAgICAgbGV0IHZpcF9jaGVjayA9ICghdGhpcy52aXBVc2VyICYmIHRoaXMuaW5mby5idXlMaW1pdCA9PSAyKSA/IHRydWUgOiBmYWxzZQogICAgICBsZXQgcHJpY2UgPSAodGhpcy5pbmZvLmJ1eUxpbWl0ID09IDIgfHwgdGhpcy52aXBVc2VyKSA/IHRoaXMuaW5mby5zZWxsUHJpY2UgOiB0aGlzLmluZm8ubm9WaXBQcmljZQogICAgICB0aGlzLiRhcGkuY2FzaF9yZWRfbGlzdCh7CiAgICAgICAgYWN0U246IHRoaXMuYWN0U24sCiAgICAgICAgY2l0eUlkOiB0aGlzLmxvY2F0aW9uQ2l0eS5jaXR5SWQsCiAgICAgICAgb3BlblZpcDogdmlwX2NoZWNrLCAvLyDmmK/lkKbli77pgInkvJrlkZjljaEKICAgICAgICB2aXBGZWU6IHZpcF9jaGVjayA/IHRoaXMubG93UHJpY2UgOiAwLCAvLyDkvJrlkZjljaHph5Hpop0KICAgICAgICBhY3RGZWU6IHByaWNlLCAvLyDmtLvliqjph5Hpop0KICAgICAgICBjYXJkSWQ6ICIiLCAvLyDnibnljZbljaHliLhpZCB8fCDnpLzljIXkvKDnqboKICAgICAgfSkudGhlbihyZXMgPT4gewogICAgICAgIGlmIChyZXMuc3RhdGUpIHsKICAgICAgICAgIGxldCByZWRMaXN0ID0gcmVzLmluZm8uY2FzaFJlZExpc3QgfHwgW10KICAgICAgICAgIGxldCBjb25zdW1lckNvdXBvbkxpc3QgPSByZXMuaW5mby5jb25zdW1lckNvdXBvbkxpc3QgfHwgW10KICAgICAgICAgIGxldCB1c2FibGVMaXN0ID0gcmVkTGlzdC5maWx0ZXIoKGl0ZW0pID0+IGl0ZW0uY3VycmVudEFibGVVc2UpIC8vIOi/h+a7pOWPr+eUqOe6ouWMhQogICAgICAgICAgbGV0IHNvcnRVc2FibGVMaXN0ID0gdXNhYmxlTGlzdC5zb3J0KGZ1bmN0aW9uKGEsIGIpIHsgLy8g6ZmN5bqP5o6S5bqPCiAgICAgICAgICAgIHJldHVybiBiLm1vbmV5IC0gYS5tb25leQogICAgICAgICAgfSkKICAgICAgICAgIHRoaXMuc2VsQ2FzaHJlZCA9IHNvcnRVc2FibGVMaXN0WzBdIHx8IHt9IC8vIOmAieS4reacgOWkp+e6ouWMhQogICAgICAgICAgaWYgKGNvbnN1bWVyQ291cG9uTGlzdC5sZW5ndGgpIHsKICAgICAgICAgICAgdGhpcy5zZWxDb25zdW1lciA9IGNvbnN1bWVyQ291cG9uTGlzdFswXSB8fCB7fSAvLyDpgInkuK3mtojotLnliLgKICAgICAgICAgIH0gIAogICAgICAgIH0KICAgICAgfSkuZmluYWxseSgoKT0+IHsKICAgICAgfSkKICAgIH0sCgogICAgaGFzQ2FjaFJlZExpc3QgKHsgZGV0YWlsIH0pIHsKICAgICAgaWYgKGRldGFpbCAmJiBkZXRhaWwubGVuZ3RoID4gMCkgewogICAgICAgIC8vIOmHjeaWsOivt+axgue6ouWMheaOpeWPowogICAgICAgIHRoaXMuc2VsZWN0Q29tcG9uZW50KCcjYWN0aXZlQ2FzaCcpLmdldENhc2hMaXN0KCkKICAgICAgICB0aGlzLmdldENhc2hOdW0oKQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuc2hvd1BhZ2VNb2RlbCA9IHRydWUKICAgICAgfQogICAgfSwKICAgIC8qKgogICAgICog6aKG5Y+W5oiW6ICF5oqi6LSt56S85YyFCiAgICAgICAgcmVzdHJpY3RTdGF0ZSAg5piv5ZCm5Y+v6LSt5Lmw77yaMeWQpiAy5pivCiAgICAgICAgcmVjZWl2ZVR5cGU6IOWklumDqOa4oOmBk3sKICAgICAgICAgIOi0reS5sO+8miAzCiAgICAgICAgICDlhY3otLnpooY6ICAxCiAgICAgICAgfQogICAgKi8KICAgIGdldEdpZnQoKSB7CiAgICAgIHZhciB2aXBVc2VyID10aGlzLnZpcENhcmRJbmZvLnZpcFVzZXIKICAgICAgdmFyIGlzbmV3VXNlciA9IHRoaXMucmVhbEluZm8ubmV3VXNlcgogICAgICBsZXQgcGFja2FnZUdpZnRUeXBlID0gdGhpcy5pbmZvLnBhY2thZ2VHaWZ0VHlwZSAvLyAx5ZSu5Y2WIDLlhY3otLnpooYKICAgICAgbGV0IGZyZWVSZWNlaXZlVHlwZSA9IHRoaXMuaW5mby5mcmVlUmVjZWl2ZVR5cGUgLy8gMeaJgOacieS6uuWPr+mihuWPliAy5LuF6ZmQ5paw55So5oi3IDPku4XpmZDkvJrlkZggNOS7hemZkOmdnuS8muWRmAogICAgICBsZXQgcmVzdHJpY3RTdGF0ZSA9IHRoaXMuaW5mby5yZXN0cmljdFN0YXRlCiAgICAgIGxldCBjaGFubmVsVHJhY2sgPSB0aGlzLmluZm8uY2hhbm5lbFRyYWNrIC8vIOmAmui/h+i/meS4quWtl+aute+8jOWIpOaWreeUqHBhY2thZ2VHaWZ0VHlwZei/mOaYr3Jlc3RyaWN0U3RhdGXlrZfmrrUKICAgICAgdmFyIGp1bXBTYXRlID0gZmFsc2UgLy8g55So5p2l5Yik5pat5piv5ZCm5o+Q56S65LuF6ZmQ5p+Q55So5oi36aKG5Y+WCiAgICAgIGlmIChmcmVlUmVjZWl2ZVR5cGUgPT0gMSkgewogICAgICAgIC8vIOaJgOacieS6uuWPr+mihuWPlgogICAgICAgIGp1bXBTYXRlID0gdHJ1ZQogICAgICB9IGVsc2UgaWYgKGZyZWVSZWNlaXZlVHlwZSA9PSAyICYmIGlzbmV3VXNlcikgewogICAgICAgIC8vIOWIpOaWreeUqOaIt+aYr+WQpuS4uuaWsOeUqOaItwogICAgICAgIGp1bXBTYXRlID0gdHJ1ZQogICAgICB9IGVsc2UgaWYgKGZyZWVSZWNlaXZlVHlwZSA9PSAzICYmIHZpcFVzZXIpIHsKICAgICAgICAvLyDliKTmlq3mmK/lkKbku4XkvJrlkZjpooblj5YKICAgICAgICBqdW1wU2F0ZSA9IHRydWUKICAgICAgfSBlbHNlIGlmIChmcmVlUmVjZWl2ZVR5cGUgPT0gNCAmJiAhdmlwVXNlcikgewogICAgICAgIC8vIOWIpOaWreaYr+WQpuS7hemdnuS8muWRmOmihuWPlgogICAgICAgIGp1bXBTYXRlID0gdHJ1ZQogICAgICB9CgogICAgICAvLyDlpoLmnpzmmK/lvIDpgJrlubbpooblj5YKICAgICAgaWYgKHRoaXMub3Blbl9yZWNlaXZlKSB7CiAgICAgICAgdGhpcy4kc2V0KHRoaXMuaW5mbywgJ3NlbGxQcmljZScsIDApCiAgICAgICAgdGhpcy4kc2V0KHRoaXMuaW5mbywgJ25vVmlwUHJpY2UnLCAwKQogICAgICB9CgogICAgICB0aGlzLiRzYXZlLnNldCgnc2Vzc2lvbicsICdvcmRlckluZm8nLCB0aGlzLmluZm8pCiAgICAgIGlmICh0aGlzLmhhc0V4Y2hhbmdlICE9ICcnKSB7CiAgICAgICAgLy8g5Yik5pat5YWR5aWW5Lit5b+D6L+b5YWlIOeri+WNs+WFkeaNogogICAgICAgIGxldCBjb25kaXRpb25JbmZvID0gdGhpcy5jb25kaXRpb25JbmZvCiAgICAgICAgbGV0IHRyYWN2ZWxVc2VyTGlzdCA9IHRoaXMudHJhY3ZlbFVzZXJMaXN0CiAgICAgICAgaWYgKGNvbmRpdGlvbkluZm8uaXNDb25kaXRpb24gJiYgdHJhY3ZlbFVzZXJMaXN0Lmxlbmd0aCA9PSAwKSB7CiAgICAgICAgICAvLyDliKTmlq3mmK/lkKbpnIDmsYLloavlhpnkv6Hmga8KICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgbmFtZTogJ3RyYXZlbEluZm9ybWF0aW9uJywKICAgICAgICAgICAgcXVlcnk6IHsKICAgICAgICAgICAgICBhY3RTbjogdGhpcy5vcHRpb25zLmFjdFNuCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pCiAgICAgICAgICByZXR1cm4KICAgICAgICB9CiAgICAgICAgaWYgKCF0aGlzLmJ0bkRpc2FibGVkKSB0aGlzLmV4Y2hhbmdlKCkKICAgICAgfSBlbHNlIGlmICh0aGlzLmluZm8uY2hpbGRFbnVtS2V5ID09ICdBQ1RfR0lGVF9QQUNLQUdFX1BVUkNIQVNFX0xJTUlUJykgewogICAgICAgIHRoaXMuaGFuZGxlckxpbWl0RXZlbnQoKQogICAgICB9IGVsc2UgaWYgKHRoaXMuaW5mby5hY3RTdGF0ZSA9PSAyKSB7CiAgICAgICAgLy8g5Yik5pat5piv5ZCm5piv5LuO5aSW6YOo5rig6YGT6L+b5YWl77yM5aSW6YOo5rig6YGT6L+b5YWl5pe277yM5aaC5p6c6YWN572u55So5oi35Y+v6LSt5Lmw77yM6Z2e5Lya5ZGY5Lmf5Y+v6LSt5Lmw56S85YyFCiAgICAgICAgbGV0IGJ1eUxpbWl0ID0gdGhpcy5pbmZvLmJ1eUxpbWl0CiAgICAgICAgbGV0IHNlbGxQcmljZSA9IHRoaXMuaW5mby5zZWxsUHJpY2UKICAgICAgICBsZXQgbm9WaXBQcmljZSA9IHRoaXMuaW5mby5ub1ZpcFByaWNlCiAgICAgICAgbGV0IGJ1eVN0YXRlID0gZmFsc2U7CiAgICAgICAgLy8gIOaJgOacieS6uiAgIOS8miAwICAg6Z2eIDAKICAgICAgICBpZiAoYnV5TGltaXQgPT0gMSAmJiBub1ZpcFByaWNlID09IDAgJiYgc2VsbFByaWNlID09IDApewogICAgICAgICAgYnV5U3RhdGUgPSBmYWxzZTsKICAgICAgICAvLyAg5Lya5ZGY6Lqr5Lu9CiAgICAgICAgfSBlbHNlIGlmICh2aXBVc2VyICYmIHNlbGxQcmljZSA+IDApewogICAgICAgICAgYnV5U3RhdGUgPSB0cnVlCiAgICAgICAgfSBlbHNlIGlmICghdmlwVXNlcil7CiAgICAgICAgICBidXlTdGF0ZSA9IGJ1eUxpbWl0ID09IDIgPyB0cnVlIDogbm9WaXBQcmljZSA+IDAgCiAgICAgICAgfQogICAgICAgIGlmIChjaGFubmVsVHJhY2sgPyBwYWNrYWdlR2lmdFR5cGUgPT0gMSA6IHJlc3RyaWN0U3RhdGUgPT0gMikgewogICAgICAgICAgaWYoYnV5U3RhdGUpewogICAgICAgICAgICAvLyDotK3kubDnpLzljIUKICAgICAgICAgICAgLy8g5aaC5p6c5piv5aSW6YOo5rig6YGT5bm25LiU5piv6aKG5Y+W54q25oCB77yMcmVjZWl2ZVR5cGXkuLo077yM6LSt5Lmw54q25oCBcmVjZWl2ZVR5cGXkuLoyCiAgICAgICAgICAgIGxldCByZWNlaXZlVHlwZSA9IHRoaXMuY2hhbm5lbFR5cGUgPT0gJ0NIQU5ORUxfQUNUSVZJVFlfTEFCRUxfU0hPVycgJiYgdGhpcy5vcGVuX3JlY2VpdmUgPyA0IDogMgogICAgICAgICAgICBpZiAoYnV5TGltaXQgPT0gMiAmJiBzZWxsUHJpY2UgPT0gMCkgewogICAgICAgICAgICAgIHJlY2VpdmVUeXBlID0gMQogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMub3JkZXJVbnBheShyZWNlaXZlVHlwZSkgICAgCiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyDkvb/nlKjlrZfmrrVyZXN0cmljdFN0YXRl5Yik5patCiAgICAgICAgICAgIHRoaXMucmVjZWl2ZUdpZnQoNCkKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKGNoYW5uZWxUcmFjayA/IHBhY2thZ2VHaWZ0VHlwZSA9PSAyIDogcmVzdHJpY3RTdGF0ZSA9PSAxKSB7CiAgICAgICAgICAvLyDlhY3otLnpooYKICAgICAgICAgIGlmIChjaGFubmVsVHJhY2spIHsKICAgICAgICAgICAgLy8g5L2/55So5a2X5q61cGFja2FnZUdpZnRUeXBl5Yik5patCiAgICAgICAgICAgIGlmIChmcmVlUmVjZWl2ZVR5cGUgIT0gMSAmJiAhanVtcFNhdGUpIHsKICAgICAgICAgICAgICB0aGlzLiRUb2FzdChg5LuF6ZmQJHt0aGlzLnJlY2VpdmVPYmpbZnJlZVJlY2VpdmVUeXBlXX3pooblj5ZgKQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRoaXMucmVjZWl2ZUdpZnQoNCkKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8g5L2/55So5a2X5q61cmVzdHJpY3RTdGF0ZeWIpOaWrQogICAgICAgICAgICB0aGlzLnJlY2VpdmVHaWZ0KDQpCiAgICAgICAgICB9CiAgICAgICAgICAKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgfSwKICBhc3luYyBjcmVhdGVkKCkgewogICAgdGhpcy5vcHRpb25zID0gdGhpcy4kcm91dGUucXVlcnkKICAgIHRoaXMuYWN0U24gPSAgdGhpcy5vcHRpb25zLmFjdFNuCiAgICB0aGlzLnFyQ29kZSA9ICB0aGlzLm9wdGlvbnMucXJDb2RlIHx8ICcnCiAgICB0aGlzLmNoYW5uZWxUeXBlID0gIHRoaXMub3B0aW9ucy5jaGFubmVsVHlwZSB8fCAnJwogICAgdGhpcy5jb21wSWQgPSAgdGhpcy5vcHRpb25zLmNvbXBJZCB8fCAnJwogICAgdGhpcy5oYXNFeGNoYW5nZSA9ICB0aGlzLm9wdGlvbnMuaGFzRXhjaGFuZ2UgfHwgJycKICAgIGF3YWl0IHRoaXMuZ2V0UmVhbFRpbWVJbmZvKCkKICAgIGlmICh0aGlzLm9wdGlvbnMucG9wdXApIHsKICAgICAgdGhpcy5zaG93T3JkZXJUaXAoKQogICAgfQogICAgaWYgKHRoaXMuaGFzRXhjaGFuZ2UgIT0gIiIpIHsgLy8g5Yik5pat5Li65YWR5o2i5Lit5b+D6L+b5YWlCiAgICAgIHRoaXMuZXhjaGFuZ2VfZGF0YSA9IHRoaXMuJHNhdmUuZ2V0KCdzZXNzaW9uJywgJ2V4Y2hhbmdlX2RhdGEnKS8vIOWFkeaNouS4reW/g+a0u+WKqOaVsOaNrgogICAgfQogICAgdGhpcy5nZXRSZWNlaXZlQ29uZGl0aW9uKCkgLy8g5piv5ZCm6ZyA6KaB5aGr5YaZ55So5oi35L+h5oGv5Y+K5YW25p2h5Lu2CiAgICB0aGlzLnZpcFByaWNlKCkKICAgIGF3YWl0IHRoaXMuZ2V0R2lmdEluZm8oKQogICAgYXdhaXQgdGhpcy5nZXRBY3REZXRhaWwodHJ1ZSkKICB9Cn0K"},null]}