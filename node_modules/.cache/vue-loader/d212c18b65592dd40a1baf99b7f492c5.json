{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\src\\views\\active\\giftBag.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\src\\views\\active\\giftBag.vue","mtime":1596627053467},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcEdldHRlcnMsIG1hcEFjdGlvbnMsIG1hcE11dGF0aW9ucyB9IGZyb20gInZ1ZXgiOwppbXBvcnQgc2Vja2lsbE1peGluIGZyb20gJ0AvbWl4aW5zL3NlY2tpbGxNaXhpbicgCmltcG9ydCBhY3RpdmVIZWFkZXIgZnJvbSAnQGNvbXBvbmVudHMvYWN0aXZlL2FjdGl2ZUhlYWRlcicKaW1wb3J0IGFjdGl2ZUNhc2ggZnJvbSAnQGNvbXBvbmVudHMvYWN0aXZlL2FjdGl2ZUNhc2gnCmltcG9ydCBhY3RpdmVHaWZ0IGZyb20gJ0Bjb21wb25lbnRzL2FjdGl2ZS9hY3RpdmVHaWZ0JwppbXBvcnQgYWN0aXZlR2lmdFJlYXNvbiBmcm9tICdAY29tcG9uZW50cy9hY3RpdmUvYWN0aXZlR2lmdFJlYXNvbicKaW1wb3J0IGFjdGl2ZUdyYXBoaWMgZnJvbSAnQGNvbXBvbmVudHMvYWN0aXZlL2FjdGl2ZUdyYXBoaWMnCmltcG9ydCBhY3RpdmVGb290ZXIgZnJvbSAnQGNvbXBvbmVudHMvYWN0aXZlL2FjdGl2ZUZvb3RlcicKaW1wb3J0IGFjdGl2ZVV0aWxzIGZyb20gJ0AvZmlsdGVycy9hY3RpdmUuanMnCmltcG9ydCBvcmRlclBheSBmcm9tICJAL3V0aWxzL3BheSIKaW1wb3J0IHV0aWxzIGZyb20gIkAvdXRpbHMvdXRpbHMiCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnZ2lmdEJhZycsCiAgbWl4aW5zOiBbc2Vja2lsbE1peGluXSwKICBjb21wdXRlZDogewogIH0sCiAgY29tcG9uZW50czogewogICAgYWN0aXZlSGVhZGVyLAogICAgYWN0aXZlQ2FzaCwKICAgIGFjdGl2ZUdpZnQsCiAgICBhY3RpdmVHaWZ0UmVhc29uLAogICAgYWN0aXZlR3JhcGhpYywKICAgIGFjdGl2ZUZvb3RlcgogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHJlYWR5OiBmYWxzZSwKICAgICAgdGltZXI6IG51bGwsCiAgICAgIGxpbWl0VGltZXI6IG51bGwsCiAgICAgIHNob3dQb3A6IGZhbHNlLAogICAgICBidG5UZXh0OiAn56uL5Y2z5oqi6LStJywKICAgICAgaGVhZGxpbmU6ICcnLAogICAgICBzaG93VGltZTogdHJ1ZSwKICAgICAgcmVtYWluVGltZTogMCwKICAgICAgY2hhbm5lbFR5cGU6ICcnLAogICAgICBvcHRpb25zOiB0aGlzLiRyb3V0ZS5xdWVyeSB8fCB7fSwKICAgICAgYnRuRGlzYWJsZWQ6IGZhbHNlLCAvLyDmjInpkq7mmK/lkKbkuI3lj6/nlKgKICAgICAgYnRuRm9udFNpemU6ICdmdDM0JywKICAgICAgc2VsQ2FzaHJlZDoge30sCiAgICAgIHNlbENvbnN1bWVyOiB7fSwKICAgICAgY29uZGl0aW9uSW5mbzoge30sCiAgICAgIHRyYWN2ZWxVc2VyTGlzdDogW10sCiAgICAgIHNlbERhdGU6IHsKICAgICAgICBzdGFydFRpbWU6ICcnCiAgICAgIH0sCiAgICAgIGluZm86IHt9LAogICAgICByZWNlaXZlT2JqOiB7CiAgICAgICAgMjogJ+aWsOeUqOaItycsCiAgICAgICAgMzogJ+S8muWRmCcsCiAgICAgICAgNDogJ+mdnuS8muWRmCcKICAgICAgfSwKICAgICAgZG93blRpbWU6IHsKICAgICAgICBob3VyOiAnMDAnLAogICAgICAgIG1pbnV0ZTogJzAwJywKICAgICAgICBzZWNvbmQ6ICcwMCcKICAgICAgfSwKICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICAuLi5tYXBHZXR0ZXJzKFsibG9jYXRpb25JbmZvIiwgInd4VXNlciIsICJsb2NhdGlvbkNpdHkiLCAidmlwQ2FyZEluZm8iLCAidXBkYXRlR2lmdCJdKQogIH0sCiAgbWV0aG9kczogewogICAgLi4ubWFwTXV0YXRpb25zKCdhY3RpdmUnLCBbCiAgICAgICdTRVRfVVBEQVRFR0lGVCcKICAgIF0pLAogIC8vIOiuvue9ruaPkOmGkgogICAgcmVtaW5kU2V0KGUpIHsKCiAgICB9LAoKICAgIGhhbmRsZXJMaW1pdChyZXMsIGZsYWcpewogICAgICBpZiAocmVzLmluZm8ubGltaXRBY3RTdGF0ZSA9PSA4IHx8IHJlcy5pbmZvLmxpbWl0QWN0U3RhdGUgPT0gOSkgewogICAgICAgIHJlcy5pbmZvLnRpbWVTdGF0ZSA9IDEKICAgICAgICB0aGlzLmhlYWRsaW5lID0gYWN0aXZlVXRpbHMuZ2V0RGF5TmFtZShyZXMuaW5mby5saW1pdFN0YXJ0VGltZSkKICAgICAgfSBlbHNlIGlmIChyZXMuaW5mby5saW1pdEFjdFN0YXRlID09IDEgfHwgcmVzLmluZm8ubGltaXRBY3RTdGF0ZSA9PSAzIHx8IHJlcy5pbmZvLmxpbWl0QWN0U3RhdGUgPT0gMTApIHsKICAgICAgICByZXMuaW5mby50aW1lU3RhdGUgPSAyCiAgICAgIH0gZWxzZSBpZiAocmVzLmluZm8ubGltaXRBY3RTdGF0ZSA9PSAyKSB7CiAgICAgICAgcmVzLmluZm8udGltZVN0YXRlID0gMwogICAgICB9IGVsc2UgewogICAgICAgIC8vIDHmnKrlvIDlp4sgMui/m+ihjOS4rSAz5bey57uT5p2fCiAgICAgICAgbGV0IGN1cnJlbnRUaW1lID0gK25ldyBEYXRlKCkKICAgICAgICBpZigocmVzLmluZm8ubGltaXRFbmRUaW1lPGN1cnJlbnRUaW1lKSAmJiAocmVzLmluZm8ubGltaXRTdGFydFRpbWU8Y3VycmVudFRpbWUpKSB7CiAgICAgICAgICByZXMuaW5mby50aW1lU3RhdGUgPSAzCiAgICAgICAgfSBlbHNlIGlmICgocmVzLmluZm8ubGltaXRFbmRUaW1lPmN1cnJlbnRUaW1lKSAmJiAocmVzLmluZm8ubGltaXRTdGFydFRpbWU8Y3VycmVudFRpbWUpKXsKICAgICAgICAgIHJlcy5pbmZvLnRpbWVTdGF0ZSA9IDIKICAgICAgICB9IGVsc2UgaWYgKHJlcy5pbmZvLmxpbWl0U3RhcnRUaW1lPmN1cnJlbnRUaW1lKSB7CiAgICAgICAgICByZXMuaW5mby50aW1lU3RhdGUgPSAxCiAgICAgICAgICB0aGlzLmhlYWRsaW5lID0gYWN0aXZlVXRpbHMuZ2V0RGF5TmFtZShyZXMuaW5mby5saW1pdFN0YXJ0VGltZSkKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYocmVzLmluZm8udGltZVN0YXRlICE9IDMpIHsKICAgICAgICBjbGVhckludGVydmFsKHRoaXMubGltaXRUaW1lcikKICAgICAgICB0aGlzLmxpbWl0VGltZXIgPSBzZXRJbnRlcnZhbCgoKSA9PiB7CiAgICAgICAgICBsZXQgbm93VGltZSA9ICtuZXcgRGF0ZSgpCiAgICAgICAgICB2YXIgY3V0VGltZSA9IDAKICAgICAgICAgIGlmKHJlcy5pbmZvLnRpbWVTdGF0ZSA9PSAxKSB7CiAgICAgICAgICAgIGN1dFRpbWUgPSByZXMuaW5mby5saW1pdFN0YXJ0VGltZSAtIG5vd1RpbWUKICAgICAgICAgIH0gZWxzZSB7IAogICAgICAgICAgICBjdXRUaW1lID0gcmVzLmluZm8ubGltaXRFbmRUaW1lIC0gbm93VGltZQogICAgICAgICAgfQogICAgICAgICAgdGhpcy5kb3duVGltZSA9IHV0aWxzLmNvdW50RG93bjMoY3V0VGltZSkKICAgICAgICAgIGlmKGN1dFRpbWUgPD0gMCAmJiAocmVzLmluZm8ubGltaXRBY3RTdGF0ZSAhPSAxMikpewogICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMubGltaXRUaW1lcikKICAgICAgICAgICAgdGhpcy5nZXRBY3REZXRhaWwoKQogICAgICAgICAgfQogICAgICAgIH0sIDEwMDApCiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5kb3duVGltZSA9IHsKICAgICAgICAgIGhvdXI6ICcwMCcsCiAgICAgICAgICBtaW51dGU6ICcwMCcsCiAgICAgICAgICBzZWNvbmQ6ICcwMCcKICAgICAgICB9CiAgICAgIH0KICAgICAgY29uc29sZS5sb2coJ3Jlcy4uLi4uLi4uLi4uJywgcmVzLmluZm8sIHRoaXMuZG93blRpbWUpCgogICAgICBpZihmbGFnKSB7CiAgICAgICAgLy8g5bey5oqi5a6M5rS75Yqo5by556qXCiAgICAgICAgaWYocmVzLmluZm8ubGltaXRBY3RTdGF0ZSA9PSAzIHx8IHJlcy5pbmZvLmxpbWl0QWN0U3RhdGUgPT0gMiB8fCAhdGhpcy5pbmZvLnJlbWFpbk51bSkgewogICAgICAgICAgdGhpcy5nZXRFbmRBY3RpdmUoKQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIC8vIOOAguOAguOAguOAguOAguOAguOAguOAguOAguOAguOAguOAguOAguOAguOAguOAguOAguOAguOAguOAguOAguS8mOWMlue7k+adn+OAguOAguOAguOAguOAguOAguOAguOAguOAguOAguOAguOAguOAguOAggoKICAgIGNsb3NlUG9wKCkgewogICAgICB0aGlzLnNob3dQb3AgPSBmYWxzZQogICAgfSwKCiAgICAvLyDnpLzljIXnibnmnInkv6Hmga8KICAgIGdldEdpZnRJbmZvKCkgewogICAgICByZXR1cm4gdGhpcy4kYXBpLmFjdF9naWZ0X2luZm8oewogICAgICAgIGNoYW5uZWxUeXBlOiB0aGlzLmNoYW5uZWxUeXBlLAogICAgICAgIHFyQ29kZTogdGhpcy5xckNvZGUsCiAgICAgICAgYWN0U246IHRoaXMuYWN0U24sCiAgICAgICAgbGF0OiB0aGlzLmxvY2F0aW9uSW5mby5sYXRpdHVkZSwKICAgICAgICBsbmc6IHRoaXMubG9jYXRpb25JbmZvLmxvbmdpdHVkZQogICAgICB9KS50aGVuKHJlcyA9PiB7CiAgICAgICAgaWYgKHJlcy5zdGF0ZSkgewogICAgICAgICAgbGV0IGNhcmRTdW0gPSAwCiAgICAgICAgICByZXMuaW5mby5jYXJkTGlzdC5mb3JFYWNoKChpdGVtKSA9PiB7CiAgICAgICAgICAgIGNhcmRTdW0gKz0gaXRlbS5jYXJkTnVtCiAgICAgICAgICB9KQogICAgICAgICAgdGhpcy5pbmZvID0gT2JqZWN0LmFzc2lnbih7IGNhcmRTdW0gfSwgdGhpcy5pbmZvLCByZXMuaW5mbykKICAgICAgICAgIGlmIChyZXMuaW5mby5yZW1haW5OdW0gPT0gMCkgewogICAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+W3suWUrue9hCcsIHRydWUpCiAgICAgICAgICB9CiAgICAgICAgICAKICAgICAgICB9CiAgICAgIH0pCiAgICB9LAoKICAgIGhhbmRsZXJCdG4odGV4dCwgZGlzYWJsZWQ9ZmFsc2UsIGZvbnRTaXplPSdmdDM0JykgewogICAgICB0aGlzLmJ0blRleHQgPSB0ZXh0CiAgICAgIHRoaXMuYnRuRm9udFNpemUgPSBmb250U2l6ZQogICAgICB0aGlzLmJ0bkRpc2FibGVkID0gZGlzYWJsZWQKICAgICAgaWYgKGRpc2FibGVkKSB7CiAgICAgICAgdGhpcy5zaG93VGltZSA9IGZhbHNlCiAgICAgIH0KICAgIH0sCgogICAgLy8g5Yik5pat55So5oi36LSt5Lmw5L+h5oGvCiAgICBnZXRSZWFsVGltZUluZm8obGltaXRGcmVxdWVuY3kpIHsKICAgICAgcmV0dXJuIHRoaXMuJGFwaS5yZWFsVGltZV9pbmZvKHsKICAgICAgICBhY3RTbjogdGhpcy5hY3RTbgogICAgICB9KS50aGVuKHJlcyA9PiB7CiAgICAgICAgaWYgKHJlcy5zdGF0ZSkgewogICAgICAgICAgdGhpcy5yZWFsSW5mbyA9IHJlcy5pbmZvCiAgICAgICAgfQogICAgICB9KQogICAgfSwKICAgIGdldFJlY2VpdmVDb25kaXRpb24gKCkgewogICAgICByZXR1cm4gdGhpcy4kYXBpLnJlY2VpdmVfY29uZGl0aW9uKHsKICAgICAgICBhY3RTbjogdGhpcy5hY3RTbgogICAgICB9KS50aGVuKHJlcz0+IHsKICAgICAgICBpZiAocmVzLnN0YXRlKSB7CiAgICAgICAgICB0aGlzLmNvbmRpdGlvbkluZm8gPSByZXMuaW5mbwogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICAvLyDlpITnkIbnq4vljbPpooblj5bnmoTmjInpkq4KICAgIGhhbmRsZXJSZWNlaXZlQnRuKCkgewogICAgICBsZXQgaGFzUmVjZWl2ZUNoYW5uZWxGcmVlR2lmdCA9IHRoaXMuaW5mby5oYXNSZWNlaXZlQ2hhbm5lbEZyZWVHaWZ0CiAgICAgIGxldCBjaGFubmVsVHlwZSA9IHRoaXMuY2hhbm5lbFR5cGUKICAgICAgdGhpcy5oYW5kbGVyQnRuKCfnq4vljbPpooblj5YnKQogICAgICBpZiAoaGFzUmVjZWl2ZUNoYW5uZWxGcmVlR2lmdCAmJiBjaGFubmVsVHlwZSA9PSAnQ0hBTk5FTF9BQ1RJVklUWV9MQUJFTF9TSE9XJykgdGhpcy5oYW5kbGVyQnRuKCfpooblj5bmrKHmlbDlt7LnlKjlrownLCB0cnVlKQogICAgfSwKCiAgICAvLyDpgJrnlKjmtLvliqjor6bmg4UKICAgIGdldEFjdERldGFpbChmbGFnKSB7CiAgICAgIHRoaXMuJFRvYXN0LmxvYWRpbmcoewogICAgICAgIG1lc3NhZ2U6ICfliqDovb3kuK0uLi4nLAogICAgICAgIGZvcmJpZENsaWNrOiB0cnVlLAogICAgICAgIGR1cmF0aW9uOiAwCiAgICAgIH0pCiAgICAgIHJldHVybiB0aGlzLiRhcGkuYWN0X2RldGFpbCh7CiAgICAgICAgY2hhbm5lbFR5cGU6IHRoaXMuY2hhbm5lbFR5cGUsCiAgICAgICAgcXJDb2RlOiB0aGlzLnFyQ29kZSwKICAgICAgICBhY3RTbjogdGhpcy5hY3RTbgogICAgICB9KS50aGVuKGFzeW5jIHJlcyA9PiB7CiAgICAgICAgaWYgKHJlcy5zdGF0ZSkgewogICAgICAgICAgdGhpcy5lbnVtS2V5ID0gcmVzLmluZm8uY2hpbGRFbnVtS2V5CiAgICAgICAgICB0aGlzLnNob3dTaGFyZSA9IHRydWUKCiAgICAgICAgICAvLyDlpITnkIbpmZDml7bnmoTlgJLorqHml7bnrYnpl67popggCiAgICAgICAgICBpZiAoIHJlcy5pbmZvLmNoaWxkRW51bUtleSA9PSAnQUNUX0dJRlRfUEFDS0FHRV9QVVJDSEFTRV9MSU1JVCcpIHsKICAgICAgICAgICAgdGhpcy5oYW5kbGVyTGltaXQocmVzLCBmbGFnKQogICAgICAgICAgfQogICAgICAgICAgcmVzLmluZm8uY2hhbm5lbFR5cGUgPSB0aGlzLmNoYW5uZWxUeXBlIHx8ICcnCiAgICAgICAgICB0aGlzLmluZm8gPSBPYmplY3QuYXNzaWduKHt9LCB0aGlzLmluZm8sIHJlcy5pbmZvKQogICAgICAgICAgdGhpcy5yZW1haW5UaW1lID0gcmVzLmluZm8ucmVtYWluVGltZQogICAgICAgICAgdGhpcy5zaG93VGltZSA9IHJlcy5pbmZvLnNob3dUaW1lCiAgICAgICAgICB0aGlzLnJlYWR5ID0gdHJ1ZQoKICAgICAgICAgIGNvbnNvbGUubG9nKCdpbmZvLi4uLi4uLi4uLicsIHRoaXMuaW5mbykKCiAgICAgICAgICAvLyDmjInpkq7mloflrZcKICAgICAgICAgIGxldCB2aXBVc2VyID0gdGhpcy52aXBDYXJkSW5mby52aXBVc2VyCiAgICAgICAgICB0aGlzLnZpcFVzZXIgPSB0aGlzLnZpcENhcmRJbmZvLnZpcFVzZXIKICAgICAgICAgIGxldCBjaGFubmVsVHlwZSA9IHRoaXMuY2hhbm5lbFR5cGUKICAgICAgICAgIGxldCByZXN0cmljdFN0YXRlID0gdGhpcy5pbmZvLnJlc3RyaWN0U3RhdGUKICAgICAgICAgIGxldCBwYWNrYWdlR2lmdFR5cGUgPSB0aGlzLmluZm8ucGFja2FnZUdpZnRUeXBlCiAgICAgICAgICBsZXQgaGFzUmVjZWl2ZUNoYW5uZWxGcmVlR2lmdCA9IHRoaXMuaW5mby5oYXNSZWNlaXZlQ2hhbm5lbEZyZWVHaWZ0CiAgICAgICAgICBsZXQgcmVtYWluTnVtID0gdGhpcy5pbmZvLnJlbWFpbk51bQogICAgICAgICAgbGV0IGNoYW5uZWxUcmFjayA9IHRoaXMuaW5mby5jaGFubmVsVHJhY2sKICAgICAgICAgIGxldCBzZWxsUHJpY2UgPSB0aGlzLmluZm8uc2VsbFByaWNlCiAgICAgICAgICBsZXQgbm9WaXBQcmljZSA9IHRoaXMuaW5mby5ub1ZpcFByaWNlCiAgICAgICAgICBsZXQgc3RhdGUgPSByZXMuaW5mby5hY3RTdGF0ZQogICAgICAgICAgbGV0IGJ1eUxpbWl0ID0gcmVzLmluZm8uYnV5TGltaXQKCiAgICAgICAgICBpZiAoc3RhdGUgPT0gMSkgewogICAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+acquW8gOWniycsIHRydWUpCiAgICAgICAgICB9IGVsc2UgaWYgKHN0YXRlID09IDMpIHsKICAgICAgICAgICAgdGhpcy5oYW5kbGVyQnRuKCflt7LllK7nvYQnLCB0cnVlKQogICAgICAgICAgfSBlbHNlIGlmIChzdGF0ZSA9PSA0KSB7CiAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign5bey57uT5p2fJywgdHJ1ZSkKICAgICAgICAgIH0gZWxzZSBpZiAoc3RhdGUgPT0gNSkgewogICAgICAgICAgICAvLyAg5Lya5ZGYCiAgICAgICAgICAgIGlmKHZpcFVzZXIpewogICAgICAgICAgICAgIGlmIChzZWxsUHJpY2UgPiAwKXsKICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign5bey5ZSu572EJywgdHJ1ZSkKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVyQnRuKCfpooblj5bmrKHmlbDlt7LnlKjlrownLCB0cnVlKQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgaWYgKGJ1eUxpbWl0ID09IDEgJiYgbm9WaXBQcmljZSA+IDApIHsKICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign5bey5ZSu572EJywgdHJ1ZSkKICAgICAgICAgICAgICB9IGVsc2UgaWYgKGJ1eUxpbWl0ID09IDEgJiYgbm9WaXBQcmljZSA9PSAwKSB7CiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+mihuWPluasoeaVsOW3sueUqOWujCcsIHRydWUpCiAgICAgICAgICAgICAgfSBlbHNlIGlmIChidXlMaW1pdCA9PSAyKSB7CiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+W3suWUrue9hCcsIHRydWUpCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICAvLyDlpJbpg6jmuKDpgZPov5vlhaUKICAgICAgICAgIGlmIChzdGF0ZSA9PSAyKSB7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyAuLi4uLi4uLi4uLi4uLuWklumDqOa4oOmBk+ekvOWMheS4uuWUruWNluWeiy4uLi4uLi4uLi4uLi4uLi4uLi4uCiAgICAgICAgICAgIGlmIChjaGFubmVsVHJhY2sgPyBwYWNrYWdlR2lmdFR5cGUgPT0gMSA6IHJlc3RyaWN0U3RhdGUgPT0gMikgewogICAgICAgICAgICAgIGlmIChyZW1haW5OdW0gPiAwKSB7CiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+eri+WNs+i0reS5sCcpCiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIC8vICDkvJrlkZgKICAgICAgICAgICAgICAgIGlmICh2aXBVc2VyKSB7CiAgICAgICAgICAgICAgICAgIGlmIChzZWxsUHJpY2UgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVyQnRuKCflt7LllK7nvYQnLCB0cnVlKQogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign6aKG5Y+W5qyh5pWw5bey55So5a6MJywgdHJ1ZSkKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgaWYgKGJ1eUxpbWl0ID09IDEgJiYgbm9WaXBQcmljZSA+IDApIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+W3suWUrue9hCcsIHRydWUpCiAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYnV5TGltaXQgPT0gMSAmJiBub1ZpcFByaWNlID09IDApIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+mihuWPluasoeaVsOW3sueUqOWujCcsIHRydWUpCiAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYnV5TGltaXQgPT0gMikgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign5bey5ZSu572EJywgdHJ1ZSkKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgLy8g5LuF5Lya5ZGY5Y+v6LSt5Lmw5pe277yM6Z2e5Lya5ZGY5pi+56S6CiAgICAgICAgICAgICAgaWYgKGJ1eUxpbWl0ID09IDIgJiYgIXZpcFVzZXIpIHsKICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign5byA6YCa5bm26LSt5LmwJykKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIC8vIOS7heS8muWRmOWPr+i0reS5sO+8jOS8muWRmOS7t+S4ujDvvIzpnZ7kvJrlkZjop4bop5IKICAgICAgICAgICAgICBpZiAoYnV5TGltaXQgPT0gMiAmJiAhc2VsbFByaWNlICYmICF2aXBVc2VyKSB7CiAgICAgICAgICAgICAgICB0aGlzLm9wZW5fcmVjZWl2ZSA9IHRydWUKICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign5byA6YCa5bm26aKG5Y+WJykKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgLy8uLi4uLi4uLi4uLi4uLi4uLueri+WNs+mihuWPlueahOaMiemSruW8gOWniy4uLi4uLi4uLi4uLi4uLi4uLi4KICAgICAgICAgICAgICAvLyDku4XkvJrlkZjlj6/otK3kubDvvIzkvJrlkZjku7fkuLow77yM5Lya5ZGY6KeG6KeSCiAgICAgICAgICAgICAgaWYgKGJ1eUxpbWl0ID09IDIgJiYgIXNlbGxQcmljZSAmJiB2aXBVc2VyKSB7CiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJSZWNlaXZlQnRuKHN0YXRlKQogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgLy8g5omA5pyJ5Lq65Y+v6LSt5Lmw77yM5Lya5ZGY5Lu344CB6Z2e5Lya5ZGY5Lu36YO95Li6MO+8jOaJgOacieS6uuinhuinkgogICAgICAgICAgICAgIGlmIChidXlMaW1pdCA9PSAxICYmICFzZWxsUHJpY2UgJiYgIW5vVmlwUHJpY2UpIHsKICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlclJlY2VpdmVCdG4oc3RhdGUpCiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIAogICAgICAgICAgICAgIC8vIOaJgOacieS6uuWPr+i0reS5sO+8jOS8muWRmOS7t+OAgemdnuS8muWRmOS7t+mDveS4ujDvvIzmiYDmnInkurrop4bop5IKICAgICAgICAgICAgICBpZiAoYnV5TGltaXQgPT0gMSAmJiAhc2VsbFByaWNlICYmICFub1ZpcFByaWNlKSB7CiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJSZWNlaXZlQnRuKHN0YXRlKQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAKICAgICAgICAgICAgICAvLyDmiYDmnInkurrlj6/otK3kubDvvIzkvJrlkZjku7fjgIHpnZ7kvJrlkZjku7fpg73kuLow77yM5omA5pyJ5Lq66KeG6KeSCiAgICAgICAgICAgICAgaWYgKGJ1eUxpbWl0ID09IDEgJiYgIXNlbGxQcmljZSAmJiB2aXBVc2VyKSB7CiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJSZWNlaXZlQnRuKHN0YXRlKQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAvLy4uLi4uLi4uLi4uLi4uLi4u56uL5Y2z6aKG5Y+W55qE5oyJ6ZKu57uT5p2fLi4uLi4uLi4uLi4uLi4uLi4uLgoKICAgICAgICAgICAgfSBlbHNlIGlmIChjaGFubmVsVHJhY2sgPyBwYWNrYWdlR2lmdFR5cGUgPT0gMiA6IHJlc3RyaWN0U3RhdGUgPT0gMSkgewogICAgICAgICAgICAgIAogICAgICAgICAgICAgIC8vIC4uLi4uLi4uLi4uLi4u5aSW6YOo5rig6YGT56S85YyF5Li65YWN6LS56aKG5Y+W5Z6LLi4uLi4uLi4uLi4uLi4uLgogICAgICAgICAgICAgIGlmIChyZW1haW5OdW0gPiAwKSB7CiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+eri+WNs+mihuWPlicpCiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign5bey5ZSu572EJywgdHJ1ZSkKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKGhhc1JlY2VpdmVDaGFubmVsRnJlZUdpZnQgJiYgY2hhbm5lbFR5cGUgPT0gJ0NIQU5ORUxfQUNUSVZJVFlfTEFCRUxfU0hPVycpIHsKICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign6aKG5Y+W5qyh5pWw5bey55So5a6MJywgdHJ1ZSkKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCgogICAgICAgICAgICAvLy4uLi4uLi4uLi4uLi4uLi4uLi4u6aKG5Y+W5qyh5pWw5LiO6LSt5Lmw5qyh5pWw5piv5ZCm5bey55So5a6MLi4uLi4uLi4uLi4uLi4uLiAKICAgICAgICAgICAgbGV0IHRvdGFsTnVtID0gTnVtYmVyKHRoaXMucmVhbEluZm8udXNlckJ1eU51bSkgKyBOdW1iZXIodGhpcy5yZWFsSW5mby51c2VyRnJlZVJlY2VpdmVOdW0pIC8vIOW9k+WJjeeUqOaIt+eahOi0reS5sOaVsOmHj+WSjOmihuWPluaVsOmHj+aAu+WSjAogICAgICAgICAgICBsZXQgY29udGF0aW9uID0gKHJlcy5pbmZvLmJ1eUxpbWl0ID09IDEgJiYgIXJlcy5pbmZvLnNlbGxQcmljZSAmJiAhcmVzLmluZm8ubm9WaXBQcmljZSkgfHwgKHJlcy5pbmZvLmJ1eUxpbWl0ID09IDIgJiYgIXJlcy5pbmZvLnNlbGxQcmljZSkgLy8g5Yik5pat5bey6aKG5Y+W55qE54q25oCBCgogICAgICAgICAgICAvLyDliKTmlq3mmK/lkKbpmZDliLbotK3kubAKICAgICAgICAgICAgaWYgKHJlcy5pbmZvLmxpbWl0U3RhdGUpIHsKICAgICAgICAgICAgICBpZiAodG90YWxOdW0gPj0gcmVzLmluZm8ubGltaXRGcmVxdWVuY3kpIHsKCiAgICAgICAgICAgICAgICAvLyDnlKjmiLfmgLvmiJDlip/otK3kubDmlbDph4/lpKfkuo7pmZDliLbotK3kubDmlbDph48KICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign5bey6LSt5LmwJywgdHJ1ZSkKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKCh0b3RhbE51bSA+PSByZXMuaW5mby5saW1pdEZyZXF1ZW5jeSkgJiYgY29udGF0aW9uKSB7CgogICAgICAgICAgICAgICAgLy8g5b2T5YmN55So5oi35b2T5YmN5rS75Yqo5Lit5oC75YWN6LS56aKG5Y+W5pWw6YeP5aSn5LqO6ZmQ5Yi26aKG5Y+W5pWw6YePCiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+mihuWPluasoeaVsOW3sueUqOWujCcsIHRydWUpCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9IAogICAgICAgICAgLy8g5Yik5pat5Li65YWR5o2i5Lit5b+D6L+b5YWlCiAgICAgICAgICBpZiAodGhpcy5oYXNFeGNoYW5nZSAhPSAnJykgeyAKICAgICAgICAgICAgbGV0IGV4Y2hhbmdlX2RhdGEgPSB0aGlzLmV4Y2hhbmdlX2RhdGEgLy8g5YWR5o2i5Lit5b+D5rS75Yqo5pWw5o2uCgogICAgICAgICAgICBpZiAoZXhjaGFuZ2VfZGF0YS5oYXNFeGNoYW5nZSkgewogICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign5bey5YWR5o2iJywgdHJ1ZSkKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBpZiAoZXhjaGFuZ2VfZGF0YS5yZW1haW5OdW0gPiAwKSB7CiAgICAgICAgICAgICAgICBpZiAoZXhjaGFuZ2VfZGF0YS5zdGF0ZSAhPSAyKSB7CiAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign5bey57uT5p2fJywgdHJ1ZSkKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIGlmIChleGNoYW5nZV9kYXRhLmNvbmRpdGlvbikgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+eri+WNs+WFkeaNoicsIGZhbHNlKQogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign56uL5Y2z5YWR5o2iJywgdHJ1ZSkKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+W3suWFkeWujCcsIHRydWUpCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgLy8gLi4uLi4uLi4uLi4uLi4uLi7kvJjljJbmlrDlop4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uCiAgICAgICAgICAvLyDliKTmlq3ku47pmZDotK3ov5vlhaUKICAgICAgICAgIGlmICh0aGlzLmluZm8uY2hpbGRFbnVtS2V5ID09ICdBQ1RfR0lGVF9QQUNLQUdFX1BVUkNIQVNFX0xJTUlUJykgewogICAgICAgICAgICAvLyDliKTmlq3mjInpkq7nmoTlsZXnpLoKICAgICAgICAgICAgLy8gMS7mtLvliqjmnKrlvIDlp4sg5pyq6K6+572u5o+Q6YaSIC0tLS0tIOaPkOmGkuaIkS/pooTnuqbmj5DphpIgCiAgICAgICAgICAgIC8vIDIu5rS75Yqo5pyq5byA5aeLIOW3suiuvue9ruaPkOmGkiAtLS0tLSDlt7LpooTnuqYKICAgICAgICAgICAgLy8gMy7mtLvliqjov5vooYzkuK0gLS0tLS0g56uL5Y2z5oqi6LStCiAgICAgICAgICAgIC8vIDQu5rS75Yqo6L+b6KGM5LitIOi0reS5sOasoeaVsOi+vuWIsOS4iumZkC0tLS0tIOW3sui0reS5sAogICAgICAgICAgICAvLyA1Lua0u+WKqOi/m+ihjOS4rSDlupPlrZjkuLowIC0tLS0tIOW3suaKouWujAogICAgICAgICAgICAvLyA2Lua0u+WKqOacquWPkeW4gyDml6Dms5XotK3kubDjgIHorr7nva7mj5DphpIgLS0tLS0g6Iul54K55Ye777yM5YiZdG9hc3Tmj5DnpLrigJzlvZPliY3mtLvliqgv5ZCI6L6R5pyq5Y+R5biD4oCdCiAgICAgICAgICAgIC8vIDcu5rS75Yqo5bey57uT5p2fIC0tLS0tICDlt7LmiqLlrowKICAgICAgICAgICAgaWYgKCF0aGlzLmluZm8ucmVtYWluTnVtKSB7CiAgICAgICAgICAgICAgdGhpcy5oYW5kbGVyQnRuKCflt7LmiqLlrownLCB0cnVlKQogICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKHJlcy5pbmZvLmFjdFN0YXRlID09IDExICB8fCByZXMuaW5mby5hY3RTdGF0ZSA9PSAzKSB7CiAgICAgICAgICAgICAgdGhpcy5oYW5kbGVyQnRuKCflt7LmiqLlrownLCB0cnVlKQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIC8vIGlmIChyZXMuaW5mby5saW1pdEFjdFN0YXRlID09IDgpIHsKICAgICAgICAgICAgICAvLyAgIHRoaXMuaGFuZGxlckJ0bign6aKE57qm5o+Q6YaSJywgZmFsc2UpCiAgICAgICAgICAgICAgLy8gfSBlbHNlIGlmIChyZXMuaW5mby5saW1pdEFjdFN0YXRlID09IDkpIHsKICAgICAgICAgICAgICAvLyAgIHRoaXMuaGFuZGxlckJ0bign5bey6aKE57qmJywgZmFsc2UpCiAgICAgICAgICAgICAgLy8gfSAKICAgICAgICAgICAgICBpZiAocmVzLmluZm8ubGltaXRBY3RTdGF0ZSA9PSA4IHx8IHJlcy5pbmZvLmxpbWl0QWN0U3RhdGUgPT0gOSkgewogICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVyQnRuKCfmnKrlvIDlp4snLCB0cnVlKQogICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzLmluZm8ubGltaXRBY3RTdGF0ZSA9PSAxKSB7CiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+eri+WNs+aKoui0rScsIGZhbHNlKQogICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzLmluZm8ubGltaXRBY3RTdGF0ZSA9PSAxMCkgewogICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVyQnRuKCflt7LotK3kubAnLCB0cnVlKQogICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzLmluZm8ubGltaXRBY3RTdGF0ZSA9PSAzKSB7CiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+W3suaKouWujCcsIHRydWUpCiAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXMuaW5mby5saW1pdEFjdFN0YXRlID09IDIpIHsKICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign5bey5oqi5a6MJywgdHJ1ZSkKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLnNob3dCdG5UeHQgPSB0cnVlCiAgICAgICAgCiAgICAgICAgICAvLyDlpoLmnpzpnIDopoHmmL7npLrlgJLorqHml7YKICAgICAgICAgIGlmICh0aGlzLnNob3dUaW1lICYmIHRoaXMuaW5mby5jaGlsZEVudW1LZXkgIT0gJ0FDVF9HSUZUX1BBQ0tBR0VfUFVSQ0hBU0VfTElNSVQnKSB7CiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy50aW1lcikKICAgICAgICAgICAgdmFyIHJlbWFpblRpbWUgPSByZXMuaW5mby5yZW1haW5UaW1lCgogICAgICAgICAgICB0aGlzLnRpbWVyID0gc2V0SW50ZXJ2YWwoKCkgPT4gewogICAgICAgICAgICAgIGlmIChyZW1haW5UaW1lID49IDEwMDApIHsKICAgICAgICAgICAgICAgIHJlbWFpblRpbWUgLT0gMTAwMAogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMudGltZXIpCiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHRoaXMucmVtYWluVGltZSA9IHJlbWFpblRpbWUgfHwgMAogICAgICAgICAgICB9LCAxMDAwKQogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMuZ2V0Q2FzaE51bSgpIC8vIOiOt+WPlua0u+WKqOe6ouWMheW9k+WJjeS6q+eUqOacgOWkp+e6ouWMhQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmJhY2tfdG8ocmVzKQogICAgICAgIH0KICAgICAgfSkuZmluYWxseSgoKSA9PiB7CiAgICAgICAgdGhpcy4kVG9hc3QuY2xlYXIoKQogICAgICB9KQogICAgfSwKCiAgICAvLyDpooblj5bnpLzljIXmjqXlj6PosIPnlKgKICAgIC8vIHJlY2VpdmVUeXBlIOiOt+WPluaWueW8j++8jDHkvJrlkZjpooblj5bvvIwy5Lya5ZGY6LSt5Lmw77yMM+a4oOmBk+i0reS5sAogICAgcmVjZWl2ZUdpZnQocmVjZWl2ZVR5cGU9MSkgewogICAgICBsZXQgY29uZGl0aW9uSW5mbyA9IHRoaXMuY29uZGl0aW9uSW5mbwogICAgICBsZXQgdHJhY3ZlbFVzZXJMaXN0ID0gdGhpcy50cmFjdmVsVXNlckxpc3QKICAgICAgaWYgKGNvbmRpdGlvbkluZm8uaXNDb25kaXRpb24gJiYgdHJhY3ZlbFVzZXJMaXN0Lmxlbmd0aCA9PSAwKSB7CiAgICAgICAgLy8g5Yik5pat5piv5ZCm6ZyA5rGC5aGr5YaZ5L+h5oGvCiAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goewogICAgICAgICAgbmFtZTogJ3RyYXZlbEluZm9ybWF0aW9uJywKICAgICAgICAgIHF1ZXJ5OiB7CiAgICAgICAgICAgIGFjdFNuOiB0aGlzLm9wdGlvbnMuYWN0U24KICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIHJldHVybgogICAgICB9CiAgICAgIGxldCBhY3REZWFsID0gb3JkZXJQYXkuYWN0RGVhbCh7CiAgICAgICAgY2l0eUlkOiB0aGlzLmxvY2F0aW9uQ2l0eS5jaXR5SWQsCiAgICAgICAgYWN0U246IHRoaXMuYWN0U24sCiAgICAgICAgZGVhbE51bTogMSwKICAgICAgICBjaGFubmVsVHlwZTogdGhpcy5jaGFubmVsVHlwZSwKICAgICAgICByZWFsRmVlOiAwLAogICAgICAgIHJlY2VpdmVUeXBlLAogICAgICAgIG9wZW5WaXA6IGZhbHNlLCAvL+aYr+WQpuW8gOmAmuaciOWNoeS8muWRmOW5tui0reS5sAogICAgICAgIGFjdEZlZTogMCwgLy/mtLvliqjmlK/ku5jotLnnlKgKICAgICAgICB2aXBGZWU6IDAsCiAgICAgICAgdmlwQ2FyZElkOiAnJywKICAgICAgICBidXlUeXBlOiAwLAogICAgICAgIHFyQ29kZTogdGhpcy5xckNvZGUsCiAgICAgICAgY29tcElkOiB0aGlzLmNvbXBJZCwgLy8g5ZCI6L6RSWQKICAgICAgICBjaG9vc2VEYXRlOiB0aGlzLnNlbERhdGUuc3RhcnRUaW1lID8gdXRpbHMuZm9ybWF0VGltZSh0aGlzLnNlbERhdGUuc3RhcnRUaW1lIHx8IDAsICdZWVlZTU1ERCcpIDogMCwgLy8g6Ieq5oiR5ri46YCJ5oup5pe26Ze0CiAgICAgICAgdHJhY3ZlbFVzZXJMaXN0OiBKU09OLnN0cmluZ2lmeSh0aGlzLnRyYWN2ZWxVc2VyTGlzdCkKICAgICAgfSkKICAgICAgaWYgKGFjdERlYWwpIHsKICAgICAgICBhY3REZWFsLnRoZW4ocmVzID0+IHsKICAgICAgICAgIGlmIChyZXMuc3RhdGUpIHsKICAgICAgICAgICAgLy8g5pS55Y+Y5YWo5bGA6IO95ZCm5YWN6LS56aKG5Y+W56S85YyF55qE54q25oCBCiAgICAgICAgICAgIHRoaXMuU0VUX1VQREFURUdJRlQodHJ1ZSkKICAgICAgICAgICAgLy8g5riF6Zmk55So5oi35aGr5YaZ5L+h5oGvCiAgICAgICAgICAgIHRoaXMuJHNhdmUucmVtb3ZlKCdzZXNzaW9uJywgJ3RyYXZlbEluZm9ybWF0aW9uJykKICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goe25hbWU6ICdnaWZ0QmFnU3VjY2VzcycsIHF1ZXJ5OiB7IHRyYWRlSWQ6IHJlcy5pbmZvLnRyYWRlSWQsIGFjdE5hbWU6IHRoaXMuaW5mby5hY3ROYW1lLCByZWNlaXZlOiAxLCBhY3RTbjogdGhpcy5hY3RTbn19KQoKICAgICAgICAgICAgLy8g6Lez6L2s6aKG5Y+W5oiQ5Yqf6aG1CiAgICAgICAgICAgIC8vIHd4Lm5hdmlnYXRlVG8oewogICAgICAgICAgICAvLyAgIHVybDogYC9wYWdlcy9hY3Rpdml0eS9naWZ0X2JhZ19kZXRhaWwvc3VjY2Vzcy9zdWNjZXNzP3RyYWRlSWQ9JHtyZXMuaW5mby50cmFkZUlkfSZhY3ROYW1lPSR7dGhpcy5pbmZvLmFjdE5hbWV9JnJlY2VpdmU9MSZhY3RTbj0ke3RoaXMuYWN0U259YCwKICAgICAgICAgICAgLy8gICBzdWNjZXNzOiAocmVzdWx0KT0+ewogICAgICAgICAgICAvLyAgICAgdGhpcy5zZXREYXRhKHsKICAgICAgICAgICAgLy8gICAgICAgaXNDYW5DbGljazogZmFsc2UgCiAgICAgICAgICAgIC8vICAgICB9KQogICAgICAgICAgICAvLyAgIH0KICAgICAgICAgICAgLy8gfSk7CiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgfQogICAgfSwKCiAgICAvLyDliKTmlq3mmK/lkKbmnInmnKrmlK/ku5jnmoTorqLljZUKICAgIC8vIHJlY2VpdmVUeXBlIOiOt+WPluaWueW8j++8jDHkvJrlkZjpooblj5bvvIwy5Lya5ZGY6LSt5Lmw77yMM+a4oOmBk+i0reS5sAogICAgb3JkZXJVbnBheShyZWNlaXZlVHlwZSkgewogICAgICB0aGlzLiRzYXZlLnNldCgnc2Vzc2lvbicsICdvcmRlckluZm8nLCB0aGlzLmluZm8pCiAgICAgIGNvbnNvbGUubG9nKCd0aGlzLmluZm8nLCB0aGlzLmluZm8pCiAgICAgIGlmICh0aGlzLmlzQ2FuQ2xpY2syKSByZXR1cm4gCiAgICAgIHRoaXMuaXNDYW5DbGljazIgPSB0cnVlIAogICAgICB0aGlzLiRhcGkub3JkZXJfdW5wYXkoewogICAgICAgIGFjdFNuOiB0aGlzLmFjdFNuCiAgICAgIH0pLnRoZW4ocmVzID0+IHsKICAgICAgICBpZiAocmVzLnN0YXRlKSB7CiAgICAgICAgICBpZiAocmVzLmluZm8uZXhpc3RzVW5QYXkpIHsKICAgICAgICAgICAgLy8g5aaC5p6c5a2Y5Zyo5pyq5pSv5LuY55qE6K6i5Y2V77yM6Lez6L2s5Yiw6K6i5Y2V5YiX6KGo6aG1CiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgICBuYW1lOiAnb3JkZXJMaXN0JwogICAgICAgICAgICB9KQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5qdW1wU3VibWl0KHJlY2VpdmVUeXBlKQogICAgICAgICAgICB0aGlzLmlzQ2FuQ2xpY2syID0gZmFsc2UKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pLmNhdGNoKCgpID0+IHsKICAgICAgICB0aGlzLmlzQ2FuQ2xpY2syID0gZmFsc2UgCiAgICAgIH0pCiAgICB9LAoKICAgIC8vIOi3s+i9rOi0reS5sOmhtemdogogICAganVtcFN1Ym1pdChyZWNlaXZlVHlwZSkgewogICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgbmFtZTogJ3N1Ym1pdE9yZGVyJywKICAgICAgICBxdWVyeTogewogICAgICAgICAgcXJDb2RlOiB0aGlzLm9wdGlvbnMucXJDb2RlIHx8ICcnLAogICAgICAgICAgY29tcElkOiB0aGlzLm9wdGlvbnMuY29tcElkIHx8ICcnLAogICAgICAgICAgYWN0U246IHRoaXMub3B0aW9ucy5hY3RTbiwKICAgICAgICAgIGNoYW5uZWxUeXBlOiB0aGlzLm9wdGlvbnMuY2hhbm5lbFR5cGUsCiAgICAgICAgICByZWNlaXZlVHlwZTogcmVjZWl2ZVR5cGUsCiAgICAgICAgfQogICAgICB9KQogICAgICAKICAgIH0sCgogICAgLy8g6Z2e5Lya5ZGY5byA6YCa5bm26aKG5Y+WCiAgICBvcGVuUmVjZWl2ZSgpIHsKICAgICAgdGhpcy4kc2V0KHRoaXMuaW5mbywgJ3NlbGxQcmljZScsIDApCiAgICAgIHRoaXMuJHNldCh0aGlzLmluZm8sICdub1ZpcFByaWNlJywgMCkKICAgICAgdGhpcy4kc2F2ZS5zZXQoJ3Nlc3Npb24nLCAnb3JkZXJJbmZvJywgdGhpcy5pbmZvKQogICAgICAvLyDpnZ7kvJrlkZjlvIDpgJrlubbpooblj5YKICAgICAgbGV0IHJlY2VpdmVUeXBlID0gdGhpcy5jaGFubmVsVHlwZSA9PSAnQ0hBTk5FTF9BQ1RJVklUWV9MQUJFTF9TSE9XJyA/IDQgOiAxCiAgICAgIHRoaXMuanVtcFN1Ym1pdChyZWNlaXZlVHlwZSkKICAgIH0sCgogICAgaGFuZGxlckxpbWl0RXZlbnQoKSB7CiAgICAgIGlmKCB0aGlzLmluZm8ubGltaXRBY3RTdGF0ZSA9PSAxMiApIHsKICAgICAgICB0aGlzLiRUb2FzdCgn5b2T5YmN5ZCI6L6R6Z2e6L+b6KGM5Lit54q25oCBJykKICAgICAgfSBlbHNlIHsKICAgICAgICBpZih0aGlzLmJ0blRleHQgPT0gJ+eri+WNs+aKoui0rScpIHsKICAgICAgICAgIHRoaXMuJHNhdmUuc2V0KCdzZXNzaW9uJywgJ29yZGVySW5mbycsIHRoaXMuaW5mbykKICAgICAgICAgIHRoaXMuanVtcFN1Ym1pdCgyKQogICAgICAgIH0KICAgICAgfQogICAgfSwKCiAgICAvKioKICAgICog6aKG5Y+W5oiW6ICF5oqi6LSt56S85YyFCiAgICAgICAgcmVzdHJpY3RTdGF0ZSAg5piv5ZCm5Y+v6LSt5Lmw77yaMeWQpiAy5pivCiAgICAgICAgcmVjZWl2ZVR5cGU6IOWklumDqOa4oOmBk3sKICAgICAgICAgIOi0reS5sO+8miAzCiAgICAgICAgICDlhY3otLnpooY6ICAxCiAgICAgICAgfQogICAgKi8KICAgIGdldEdpZnQoKSB7CiAgICAgIHZhciB2aXBVc2VyID0gdGhpcy52aXBDYXJkSW5mby52aXBVc2VyCiAgICAgIHZhciBpc25ld1VzZXIgPSB0aGlzLnJlYWxJbmZvLm5ld1VzZXIKICAgICAgbGV0IHBhY2thZ2VHaWZ0VHlwZSA9IHRoaXMuaW5mby5wYWNrYWdlR2lmdFR5cGUgLy8gMeWUruWNliAy5YWN6LS56aKGCiAgICAgIGxldCBmcmVlUmVjZWl2ZVR5cGUgPSB0aGlzLmluZm8uZnJlZVJlY2VpdmVUeXBlIC8vIDHmiYDmnInkurrlj6/pooblj5YgMuS7hemZkOaWsOeUqOaItyAz5LuF6ZmQ5Lya5ZGYIDTku4XpmZDpnZ7kvJrlkZgKICAgICAgbGV0IHJlc3RyaWN0U3RhdGUgPSB0aGlzLmluZm8ucmVzdHJpY3RTdGF0ZQogICAgICBsZXQgY2hhbm5lbFRyYWNrID0gdGhpcy5pbmZvLmNoYW5uZWxUcmFjayAvLyDpgJrov4fov5nkuKrlrZfmrrXvvIzliKTmlq3nlKhwYWNrYWdlR2lmdFR5cGXov5jmmK9yZXN0cmljdFN0YXRl5a2X5q61CiAgICAgIHZhciBqdW1wU2F0ZSA9IGZhbHNlIC8vIOeUqOadpeWIpOaWreaYr+WQpuaPkOekuuS7hemZkOafkOeUqOaIt+mihuWPlgogICAgICBpZiAoZnJlZVJlY2VpdmVUeXBlID09IDEpIHsKICAgICAgICAvLyDmiYDmnInkurrlj6/pooblj5YKICAgICAgICBqdW1wU2F0ZSA9IHRydWUKICAgICAgfSBlbHNlIGlmIChmcmVlUmVjZWl2ZVR5cGUgPT0gMiAmJiBpc25ld1VzZXIpIHsKICAgICAgICAvLyDliKTmlq3nlKjmiLfmmK/lkKbkuLrmlrDnlKjmiLcKICAgICAgICBqdW1wU2F0ZSA9IHRydWUKICAgICAgfSBlbHNlIGlmIChmcmVlUmVjZWl2ZVR5cGUgPT0gMyAmJiB2aXBVc2VyKSB7CiAgICAgICAgLy8g5Yik5pat5piv5ZCm5LuF5Lya5ZGY6aKG5Y+WCiAgICAgICAganVtcFNhdGUgPSB0cnVlCiAgICAgIH0gZWxzZSBpZiAoZnJlZVJlY2VpdmVUeXBlID09IDQgJiYgIXZpcFVzZXIpIHsKICAgICAgICAvLyDliKTmlq3mmK/lkKbku4XpnZ7kvJrlkZjpooblj5YKICAgICAgICBqdW1wU2F0ZSA9IHRydWUKICAgICAgfQoKICAgICAgLy8g5aaC5p6c5piv5byA6YCa5bm26aKG5Y+WCiAgICAgIGlmICh0aGlzLm9wZW5fcmVjZWl2ZSkgewogICAgICAgIHRoaXMuJHNldCh0aGlzLmluZm8sICdzZWxsUHJpY2UnLCAwKQogICAgICAgIHRoaXMuJHNldCh0aGlzLmluZm8sICdub1ZpcFByaWNlJywgMCkKICAgICAgfQoKICAgICAgdGhpcy4kc2F2ZS5zZXQoJ3Nlc3Npb24nLCAnb3JkZXJJbmZvJywgdGhpcy5pbmZvKQogICAgICBpZiAodGhpcy5oYXNFeGNoYW5nZSAhPSAnJykgewogICAgICAgIC8vIOWIpOaWreWFkeWlluS4reW/g+i/m+WFpSDnq4vljbPlhZHmjaIKICAgICAgICBsZXQgY29uZGl0aW9uSW5mbyA9IHRoaXMuY29uZGl0aW9uSW5mbwogICAgICAgIGxldCB0cmFjdmVsVXNlckxpc3QgPSB0aGlzLnRyYWN2ZWxVc2VyTGlzdAogICAgICAgIGlmIChjb25kaXRpb25JbmZvLmlzQ29uZGl0aW9uICYmIHRyYWN2ZWxVc2VyTGlzdC5sZW5ndGggPT0gMCkgewogICAgICAgICAgLy8g5Yik5pat5piv5ZCm6ZyA5rGC5aGr5YaZ5L+h5oGvCiAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgICAgIG5hbWU6ICd0cmF2ZWxJbmZvcm1hdGlvbicsCiAgICAgICAgICAgIHF1ZXJ5OiB7CiAgICAgICAgICAgICAgYWN0U246IHRoaXMub3B0aW9ucy5hY3RTbgogICAgICAgICAgICB9CiAgICAgICAgICB9KQogICAgICAgICAgcmV0dXJuCiAgICAgICAgfQogICAgICAgIGlmICghdGhpcy5idG5EaXNhYmxlZCkgdGhpcy5leGNoYW5nZSgpCiAgICAgIH0gZWxzZSBpZiAodGhpcy5pbmZvLmNoaWxkRW51bUtleSA9PSAnQUNUX0dJRlRfUEFDS0FHRV9QVVJDSEFTRV9MSU1JVCcpIHsKICAgICAgICB0aGlzLmhhbmRsZXJMaW1pdEV2ZW50KCkKICAgICAgfSBlbHNlIGlmICh0aGlzLmluZm8uYWN0U3RhdGUgPT0gMikgewogICAgICAgIC8vIOWIpOaWreaYr+WQpuaYr+S7juWklumDqOa4oOmBk+i/m+WFpe+8jOWklumDqOa4oOmBk+i/m+WFpeaXtu+8jOWmguaenOmFjee9rueUqOaIt+WPr+i0reS5sO+8jOmdnuS8muWRmOS5n+WPr+i0reS5sOekvOWMhQogICAgICAgIGxldCBidXlMaW1pdCA9IHRoaXMuaW5mby5idXlMaW1pdAogICAgICAgIGxldCBzZWxsUHJpY2UgPSB0aGlzLmluZm8uc2VsbFByaWNlCiAgICAgICAgbGV0IG5vVmlwUHJpY2UgPSB0aGlzLmluZm8ubm9WaXBQcmljZQogICAgICAgIGxldCBidXlTdGF0ZSA9IGZhbHNlOwogICAgICAgIC8vICDmiYDmnInkurogICDkvJogMCAgIOmdniAwCiAgICAgICAgaWYgKGJ1eUxpbWl0ID09IDEgJiYgbm9WaXBQcmljZSA9PSAwICYmIHNlbGxQcmljZSA9PSAwKXsKICAgICAgICAgIGJ1eVN0YXRlID0gZmFsc2U7CiAgICAgICAgLy8gIOS8muWRmOi6q+S7vQogICAgICAgIH0gZWxzZSBpZiAodmlwVXNlciAmJiBzZWxsUHJpY2UgPiAwKXsKICAgICAgICAgIGJ1eVN0YXRlID0gdHJ1ZQogICAgICAgIH0gZWxzZSBpZiAoIXZpcFVzZXIpewogICAgICAgICAgYnV5U3RhdGUgPSBidXlMaW1pdCA9PSAyID8gdHJ1ZSA6IG5vVmlwUHJpY2UgPiAwIAogICAgICAgIH0KCiAgICAgICAgaWYgKGNoYW5uZWxUcmFjayA/IHBhY2thZ2VHaWZ0VHlwZSA9PSAxIDogcmVzdHJpY3RTdGF0ZSA9PSAyKSB7CgogICAgICAgICAgaWYoYnV5U3RhdGUpewogICAgICAgICAgICAvLyDotK3kubDnpLzljIUKCiAgICAgICAgICAgIC8vIOWmguaenOaYr+WklumDqOa4oOmBk+W5tuS4lOaYr+mihuWPlueKtuaAge+8jHJlY2VpdmVUeXBl5Li6NO+8jOi0reS5sOeKtuaAgXJlY2VpdmVUeXBl5Li6MgogICAgICAgICAgICBsZXQgcmVjZWl2ZVR5cGUgPSB0aGlzLmNoYW5uZWxUeXBlID09ICdDSEFOTkVMX0FDVElWSVRZX0xBQkVMX1NIT1cnICYmIHRoaXMub3Blbl9yZWNlaXZlID8gNCA6IDIKICAgICAgICAgICAgaWYgKGJ1eUxpbWl0ID09IDIgJiYgc2VsbFByaWNlID09IDApIHsKICAgICAgICAgICAgICByZWNlaXZlVHlwZSA9IDEKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLm9yZGVyVW5wYXkocmVjZWl2ZVR5cGUpICAgIAogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8g5L2/55So5a2X5q61cmVzdHJpY3RTdGF0ZeWIpOaWrQogICAgICAgICAgICB0aGlzLnJlY2VpdmVHaWZ0KDQpCiAgICAgICAgICB9CgogICAgICAgIH0gZWxzZSBpZiAoY2hhbm5lbFRyYWNrID8gcGFja2FnZUdpZnRUeXBlID09IDIgOiByZXN0cmljdFN0YXRlID09IDEpIHsKICAgICAgICAgIC8vIOWFjei0uemihgogICAgICAgICAgaWYgKGNoYW5uZWxUcmFjaykgewoKICAgICAgICAgICAgLy8g5L2/55So5a2X5q61cGFja2FnZUdpZnRUeXBl5Yik5patCiAgICAgICAgICAgIGlmIChmcmVlUmVjZWl2ZVR5cGUgIT0gMSAmJiAhanVtcFNhdGUpIHsKICAgICAgICAgICAgICB0aGlzLiRUb2FzdChg5LuF6ZmQJHt0aGlzLnJlY2VpdmVPYmpbZnJlZVJlY2VpdmVUeXBlXX3pooblj5ZgKQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRoaXMucmVjZWl2ZUdpZnQoNCkKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKCiAgICAgICAgICAgIC8vIOS9v+eUqOWtl+autXJlc3RyaWN0U3RhdGXliKTmlq0KICAgICAgICAgICAgdGhpcy5yZWNlaXZlR2lmdCg0KQogICAgICAgICAgfQogICAgICAgICAgCiAgICAgICAgfQogICAgICB9CiAgICB9LAoKICAgIC8vIOWFkeaNogogICAgZXhjaGFuZ2UgKCkgewogICAgICBsZXQgaXRlbSA9IHRoaXMuZXhjaGFuZ2VfZGF0YQogICAgICB0aGlzLiRkaWFsb2cuY29uZmlybSh7CiAgICAgICAgdGl0bGU6IGDmmK/lkKbnoa7orqTlhZHmjaIke2l0ZW0uYWN0TmFtZSB8fCAnJ30/YCwKICAgICAgICBtZXNzYWdlOiflhZHmjaLlkI7kuI3lj6/mm7TmlLnkuJTljp/mnInmva7ljaHlsIbkvJrmuIXnqbonLAogICAgICB9KS50aGVuKCgpPT57CiAgICAgICAgdGhpcy5wcmljZUV4Y2hhbmdlKGl0ZW0pCiAgICAgIH0pLmNhdGNoKCgpID0+IHsKICAgICAgICAgICAgLy8gb24gY2FuY2VsCiAgICAgIH0pOwogICAgfSwKCiAgICAvLyDlvIDlp4vlhZHmjaIKICAgIHByaWNlRXhjaGFuZ2UgKGl0ZW0pIHsKICAgICAgaWYgKHRoaXMuY2FuQ2xpY2spIHJldHVybgogICAgICB0aGlzLmNhbkNsaWNrID0gdHJ1ZQogICAgICB0aGlzLiRhcGkucHJpY2VfZXhjaGFuZ2UoewogICAgICAgIGFjdFNuOiBpdGVtLmFjdFNuLAogICAgICAgIGF3YXJkSWQ6IGl0ZW0uYXdhcmRJZCwKICAgICAgICBjaXR5SWQ6IHRoaXMubG9jYXRpb25DaXR5LmNpdHlJZCwKICAgICAgICBjaG9vc2VEYXRlOiB0aGlzLnNlbERhdGUuc3RhcnRUaW1lID8gdXRpbHMuZm9ybWF0VGltZSh0aGlzLnNlbERhdGUuc3RhcnRUaW1lIHx8IDAsICdZWVlZTU1ERCcpIDogMCwgLy8g6Ieq5oiR5ri46YCJ5oup5pe26Ze0CiAgICAgICAgdHJhY3ZlbFVzZXJMaXN0OiBKU09OLnN0cmluZ2lmeSh0aGlzLnRyYWN2ZWxVc2VyTGlzdCkKICAgICAgfSkudGhlbihyZXMgPT4gewogICAgICAgIGlmIChyZXMuc3RhdGUpIHsKICAgICAgICAgIHRoaXMubWFzayA9IHRydWUKICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign5bey5YWR5o2iJywgdHJ1ZSkKICAgICAgICAgIC8vIOa4hemZpOeUqOaIt+Whq+WGmeS/oeaBrwogICAgICAgICAgdGhpcy4kc2F2ZS5yZW1vdmUoJ3Nlc3Npb24nLCAndHJhdmVsSW5mb3JtYXRpb24nKQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLiRUb2FzdChyZXMubWVzc2FnZSkKICAgICAgICB9CiAgICAgIH0pLmZpbmFsbHkoKCk9PnsKICAgICAgICBzZXRUaW1lb3V0KCgpPT57CiAgICAgICAgICB0aGlzLmNhbkNsaWNrID0gZmFsc2UKICAgICAgICB9LCAzMDApCiAgICAgIH0pCiAgICB9LAoKICAgIGdvQ2FyZCgpIHsKICAgICAgdGhpcy4kcm91dGVyLnB1c2goewogICAgICAgIG5hbWU6ICdjb3Vwb25MaXN0JwogICAgICB9KQogICAgfSwKCiAgICBjbG9zZSgpIHsKICAgICAgdGhpcy5tYXNrID0gZmFsc2UKICAgIH0sCgogICAgLy8g6I635Y+W5Lya5ZGY5Y2h5pyA5L2O5Lu35qC8CiAgICB2aXBQcmljZSgpIHsKICAgICAgdGhpcy4kYXBpLmxvd19wcmljZSh7fSkudGhlbihyZXMgPT4gewogICAgICAgIGlmIChyZXMuc3RhdGUpIHsKICAgICAgICAgIHRoaXMubG93UHJpY2UgPSByZXMuaW5mby5sb3dQcmljZQogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICAKICAgIHNob3dPcmRlclRpcCgpIHsKICAgICAgdGhpcy4kZGlhbG9nLmFsZXJ0KHsKICAgICAgICB0aXRsZTogJ+aPkOekuicsCiAgICAgICAgbWVzc2FnZTogJ+iuouWNlei2heaXtuW3suWPlua2iO+8jOivt+mHjeaWsOS4i+WNlScsCiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnoa7lrponLAogICAgICAgIGNvbmZpcm1CdXR0b25Db2xvcjogJyNEOTA2MzQnCiAgICAgIH0pCiAgICB9LAogICAgCiAgICB0b0pvaW4oKSB7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICBuYW1lOidqb2luVmlwJywKICAgICAgICBxdWVyeTogewogICAgICAgICAgY2hhbm5lbFR5cGU6IHRoaXMuY2hhbm5lbFR5cGUKICAgICAgICB9CiAgICAgIH0pCiAgICB9LAoKICAgIC8vIOWFs+mXree6ouWMheWIl+ihqAogICAgY29sc2VjYXNoTWFzaygpIHsKICAgICAgdGhpcy5jYXNoTWFzayA9ICF0aGlzLmNhc2hNYXNrCiAgICB9LAoKICAgIC8vIOiOt+WPlua0u+WKqOe6ouWMheW9k+WJjeS6q+eUqOacgOWkp+e6ouWMhQogICAgZ2V0Q2FzaE51bSgpIHsKICAgICAgbGV0IHZpcF9jaGVjayA9ICghdGhpcy52aXBVc2VyICYmIHRoaXMuaW5mby5idXlMaW1pdCA9PSAyKSA/IHRydWUgOiBmYWxzZQogICAgICBsZXQgcHJpY2UgPSAodGhpcy5pbmZvLmJ1eUxpbWl0ID09IDIgfHwgdGhpcy52aXBVc2VyKSA/IHRoaXMuaW5mby5zZWxsUHJpY2UgOiB0aGlzLmluZm8ubm9WaXBQcmljZQogICAgICB0aGlzLiRhcGkuY2FzaF9yZWRfbGlzdCh7CiAgICAgICAgYWN0U246IHRoaXMuYWN0U24sCiAgICAgICAgY2l0eUlkOiB0aGlzLmxvY2F0aW9uQ2l0eS5jaXR5SWQsCiAgICAgICAgb3BlblZpcDogdmlwX2NoZWNrLCAvLyDmmK/lkKbli77pgInkvJrlkZjljaEKICAgICAgICB2aXBGZWU6IHZpcF9jaGVjayA/IHRoaXMubG93UHJpY2UgOiAwLCAvLyDkvJrlkZjljaHph5Hpop0KICAgICAgICBhY3RGZWU6IHByaWNlLCAvLyDmtLvliqjph5Hpop0KICAgICAgICBjYXJkSWQ6ICIiLCAvLyDnibnljZbljaHliLhpZCB8fCDnpLzljIXkvKDnqboKICAgICAgfSkudGhlbihyZXMgPT4gewogICAgICAgIGlmIChyZXMuc3RhdGUpIHsKICAgICAgICAgIGxldCByZWRMaXN0ID0gcmVzLmluZm8uY2FzaFJlZExpc3QgfHwgW10KICAgICAgICAgIGxldCBjb25zdW1lckNvdXBvbkxpc3QgPSByZXMuaW5mby5jb25zdW1lckNvdXBvbkxpc3QgfHwgW10KICAgICAgICAgIGxldCB1c2FibGVMaXN0ID0gcmVkTGlzdC5maWx0ZXIoKGl0ZW0pID0+IGl0ZW0uY3VycmVudEFibGVVc2UpIC8vIOi/h+a7pOWPr+eUqOe6ouWMhQogICAgICAgICAgbGV0IHNvcnRVc2FibGVMaXN0ID0gdXNhYmxlTGlzdC5zb3J0KGZ1bmN0aW9uKGEsIGIpIHsgLy8g6ZmN5bqP5o6S5bqPCiAgICAgICAgICAgIHJldHVybiBiLm1vbmV5IC0gYS5tb25leQogICAgICAgICAgfSkKICAgICAgICAgIHRoaXMuc2VsQ2FzaHJlZCA9IHNvcnRVc2FibGVMaXN0WzBdIHx8IHt9IC8vIOmAieS4reacgOWkp+e6ouWMhQogICAgICAgICAgaWYgKGNvbnN1bWVyQ291cG9uTGlzdC5sZW5ndGgpIHsKICAgICAgICAgICAgdGhpcy5zZWxDb25zdW1lciA9IGNvbnN1bWVyQ291cG9uTGlzdFswXSB8fCB7fSAvLyDpgInkuK3mtojotLnliLgKICAgICAgICAgIH0gIAogICAgICAgIH0KICAgICAgfSkuZmluYWxseSgoKT0+IHsKICAgICAgfSkKICAgIH0sCgogICAgaGFzQ2FjaFJlZExpc3QgKHsgZGV0YWlsIH0pIHsKICAgICAgaWYgKGRldGFpbCAmJiBkZXRhaWwubGVuZ3RoID4gMCkgewogICAgICAgIC8vIOmHjeaWsOivt+axgue6ouWMheaOpeWPowogICAgICAgIHRoaXMuc2VsZWN0Q29tcG9uZW50KCcjYWN0aXZlQ2FzaCcpLmdldENhc2hMaXN0KCkKICAgICAgICB0aGlzLmdldENhc2hOdW0oKQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuc2hvd1BhZ2VNb2RlbCA9IHRydWUKICAgICAgfQogICAgfSwKICAgIC8qKgogICAgICog6aKG5Y+W5oiW6ICF5oqi6LSt56S85YyFCiAgICAgICAgcmVzdHJpY3RTdGF0ZSAg5piv5ZCm5Y+v6LSt5Lmw77yaMeWQpiAy5pivCiAgICAgICAgcmVjZWl2ZVR5cGU6IOWklumDqOa4oOmBk3sKICAgICAgICAgIOi0reS5sO+8miAzCiAgICAgICAgICDlhY3otLnpooY6ICAxCiAgICAgICAgfQogICAgKi8KICAgIGdldEdpZnQoKSB7CiAgICAgIHZhciB2aXBVc2VyID10aGlzLnZpcENhcmRJbmZvLnZpcFVzZXIKICAgICAgdmFyIGlzbmV3VXNlciA9IHRoaXMucmVhbEluZm8ubmV3VXNlcgogICAgICBsZXQgcGFja2FnZUdpZnRUeXBlID0gdGhpcy5pbmZvLnBhY2thZ2VHaWZ0VHlwZSAvLyAx5ZSu5Y2WIDLlhY3otLnpooYKICAgICAgbGV0IGZyZWVSZWNlaXZlVHlwZSA9IHRoaXMuaW5mby5mcmVlUmVjZWl2ZVR5cGUgLy8gMeaJgOacieS6uuWPr+mihuWPliAy5LuF6ZmQ5paw55So5oi3IDPku4XpmZDkvJrlkZggNOS7hemZkOmdnuS8muWRmAogICAgICBsZXQgcmVzdHJpY3RTdGF0ZSA9IHRoaXMuaW5mby5yZXN0cmljdFN0YXRlCiAgICAgIGxldCBjaGFubmVsVHJhY2sgPSB0aGlzLmluZm8uY2hhbm5lbFRyYWNrIC8vIOmAmui/h+i/meS4quWtl+aute+8jOWIpOaWreeUqHBhY2thZ2VHaWZ0VHlwZei/mOaYr3Jlc3RyaWN0U3RhdGXlrZfmrrUKICAgICAgdmFyIGp1bXBTYXRlID0gZmFsc2UgLy8g55So5p2l5Yik5pat5piv5ZCm5o+Q56S65LuF6ZmQ5p+Q55So5oi36aKG5Y+WCiAgICAgIGlmIChmcmVlUmVjZWl2ZVR5cGUgPT0gMSkgewogICAgICAgIC8vIOaJgOacieS6uuWPr+mihuWPlgogICAgICAgIGp1bXBTYXRlID0gdHJ1ZQogICAgICB9IGVsc2UgaWYgKGZyZWVSZWNlaXZlVHlwZSA9PSAyICYmIGlzbmV3VXNlcikgewogICAgICAgIC8vIOWIpOaWreeUqOaIt+aYr+WQpuS4uuaWsOeUqOaItwogICAgICAgIGp1bXBTYXRlID0gdHJ1ZQogICAgICB9IGVsc2UgaWYgKGZyZWVSZWNlaXZlVHlwZSA9PSAzICYmIHZpcFVzZXIpIHsKICAgICAgICAvLyDliKTmlq3mmK/lkKbku4XkvJrlkZjpooblj5YKICAgICAgICBqdW1wU2F0ZSA9IHRydWUKICAgICAgfSBlbHNlIGlmIChmcmVlUmVjZWl2ZVR5cGUgPT0gNCAmJiAhdmlwVXNlcikgewogICAgICAgIC8vIOWIpOaWreaYr+WQpuS7hemdnuS8muWRmOmihuWPlgogICAgICAgIGp1bXBTYXRlID0gdHJ1ZQogICAgICB9CgogICAgICAvLyDlpoLmnpzmmK/lvIDpgJrlubbpooblj5YKICAgICAgaWYgKHRoaXMub3Blbl9yZWNlaXZlKSB7CiAgICAgICAgdGhpcy4kc2V0KHRoaXMuaW5mbywgJ3NlbGxQcmljZScsIDApCiAgICAgICAgdGhpcy4kc2V0KHRoaXMuaW5mbywgJ25vVmlwUHJpY2UnLCAwKQogICAgICB9CgogICAgICB0aGlzLiRzYXZlLnNldCgnc2Vzc2lvbicsICdvcmRlckluZm8nLCB0aGlzLmluZm8pCiAgICAgIGlmICh0aGlzLmhhc0V4Y2hhbmdlICE9ICcnKSB7CiAgICAgICAgLy8g5Yik5pat5YWR5aWW5Lit5b+D6L+b5YWlIOeri+WNs+WFkeaNogogICAgICAgIGxldCBjb25kaXRpb25JbmZvID0gdGhpcy5jb25kaXRpb25JbmZvCiAgICAgICAgbGV0IHRyYWN2ZWxVc2VyTGlzdCA9IHRoaXMudHJhY3ZlbFVzZXJMaXN0CiAgICAgICAgaWYgKGNvbmRpdGlvbkluZm8uaXNDb25kaXRpb24gJiYgdHJhY3ZlbFVzZXJMaXN0Lmxlbmd0aCA9PSAwKSB7CiAgICAgICAgICAvLyDliKTmlq3mmK/lkKbpnIDmsYLloavlhpnkv6Hmga8KICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgbmFtZTogJ3RyYXZlbEluZm9ybWF0aW9uJywKICAgICAgICAgICAgcXVlcnk6IHsKICAgICAgICAgICAgICBhY3RTbjogdGhpcy5vcHRpb25zLmFjdFNuCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pCiAgICAgICAgICByZXR1cm4KICAgICAgICB9CiAgICAgICAgaWYgKCF0aGlzLmJ0bkRpc2FibGVkKSB0aGlzLmV4Y2hhbmdlKCkKICAgICAgfSBlbHNlIGlmICh0aGlzLmluZm8uY2hpbGRFbnVtS2V5ID09ICdBQ1RfR0lGVF9QQUNLQUdFX1BVUkNIQVNFX0xJTUlUJykgewogICAgICAgIHRoaXMuaGFuZGxlckxpbWl0RXZlbnQoKQogICAgICB9IGVsc2UgaWYgKHRoaXMuaW5mby5hY3RTdGF0ZSA9PSAyKSB7CiAgICAgICAgLy8g5Yik5pat5piv5ZCm5piv5LuO5aSW6YOo5rig6YGT6L+b5YWl77yM5aSW6YOo5rig6YGT6L+b5YWl5pe277yM5aaC5p6c6YWN572u55So5oi35Y+v6LSt5Lmw77yM6Z2e5Lya5ZGY5Lmf5Y+v6LSt5Lmw56S85YyFCiAgICAgICAgbGV0IGJ1eUxpbWl0ID0gdGhpcy5pbmZvLmJ1eUxpbWl0CiAgICAgICAgbGV0IHNlbGxQcmljZSA9IHRoaXMuaW5mby5zZWxsUHJpY2UKICAgICAgICBsZXQgbm9WaXBQcmljZSA9IHRoaXMuaW5mby5ub1ZpcFByaWNlCiAgICAgICAgbGV0IGJ1eVN0YXRlID0gZmFsc2U7CiAgICAgICAgLy8gIOaJgOacieS6uiAgIOS8miAwICAg6Z2eIDAKICAgICAgICBpZiAoYnV5TGltaXQgPT0gMSAmJiBub1ZpcFByaWNlID09IDAgJiYgc2VsbFByaWNlID09IDApewogICAgICAgICAgYnV5U3RhdGUgPSBmYWxzZTsKICAgICAgICAvLyAg5Lya5ZGY6Lqr5Lu9CiAgICAgICAgfSBlbHNlIGlmICh2aXBVc2VyICYmIHNlbGxQcmljZSA+IDApewogICAgICAgICAgYnV5U3RhdGUgPSB0cnVlCiAgICAgICAgfSBlbHNlIGlmICghdmlwVXNlcil7CiAgICAgICAgICBidXlTdGF0ZSA9IGJ1eUxpbWl0ID09IDIgPyB0cnVlIDogbm9WaXBQcmljZSA+IDAgCiAgICAgICAgfQogICAgICAgIGlmIChjaGFubmVsVHJhY2sgPyBwYWNrYWdlR2lmdFR5cGUgPT0gMSA6IHJlc3RyaWN0U3RhdGUgPT0gMikgewogICAgICAgICAgaWYoYnV5U3RhdGUpewogICAgICAgICAgICAvLyDotK3kubDnpLzljIUKICAgICAgICAgICAgLy8g5aaC5p6c5piv5aSW6YOo5rig6YGT5bm25LiU5piv6aKG5Y+W54q25oCB77yMcmVjZWl2ZVR5cGXkuLo077yM6LSt5Lmw54q25oCBcmVjZWl2ZVR5cGXkuLoyCiAgICAgICAgICAgIGxldCByZWNlaXZlVHlwZSA9IHRoaXMuY2hhbm5lbFR5cGUgPT0gJ0NIQU5ORUxfQUNUSVZJVFlfTEFCRUxfU0hPVycgJiYgdGhpcy5vcGVuX3JlY2VpdmUgPyA0IDogMgogICAgICAgICAgICBpZiAoYnV5TGltaXQgPT0gMiAmJiBzZWxsUHJpY2UgPT0gMCkgewogICAgICAgICAgICAgIHJlY2VpdmVUeXBlID0gMQogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMub3JkZXJVbnBheShyZWNlaXZlVHlwZSkgICAgCiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyDkvb/nlKjlrZfmrrVyZXN0cmljdFN0YXRl5Yik5patCiAgICAgICAgICAgIHRoaXMucmVjZWl2ZUdpZnQoNCkKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKGNoYW5uZWxUcmFjayA/IHBhY2thZ2VHaWZ0VHlwZSA9PSAyIDogcmVzdHJpY3RTdGF0ZSA9PSAxKSB7CiAgICAgICAgICAvLyDlhY3otLnpooYKICAgICAgICAgIGlmIChjaGFubmVsVHJhY2spIHsKICAgICAgICAgICAgLy8g5L2/55So5a2X5q61cGFja2FnZUdpZnRUeXBl5Yik5patCiAgICAgICAgICAgIGlmIChmcmVlUmVjZWl2ZVR5cGUgIT0gMSAmJiAhanVtcFNhdGUpIHsKICAgICAgICAgICAgICB0aGlzLiRUb2FzdChg5LuF6ZmQJHt0aGlzLnJlY2VpdmVPYmpbZnJlZVJlY2VpdmVUeXBlXX3pooblj5ZgKQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRoaXMucmVjZWl2ZUdpZnQoNCkKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8g5L2/55So5a2X5q61cmVzdHJpY3RTdGF0ZeWIpOaWrQogICAgICAgICAgICB0aGlzLnJlY2VpdmVHaWZ0KDQpCiAgICAgICAgICB9CiAgICAgICAgICAKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgfSwKICBhc3luYyBjcmVhdGVkKCkgewogICAgdGhpcy5vcHRpb25zID0gdGhpcy4kcm91dGUucXVlcnkKICAgIHRoaXMuYWN0U24gPSAgdGhpcy5vcHRpb25zLmFjdFNuCiAgICB0aGlzLnFyQ29kZSA9ICB0aGlzLm9wdGlvbnMucXJDb2RlIHx8ICcnCiAgICB0aGlzLmNoYW5uZWxUeXBlID0gIHRoaXMub3B0aW9ucy5jaGFubmVsVHlwZSB8fCAnJwogICAgdGhpcy5jb21wSWQgPSAgdGhpcy5vcHRpb25zLmNvbXBJZCB8fCAnJwogICAgdGhpcy5oYXNFeGNoYW5nZSA9ICB0aGlzLm9wdGlvbnMuaGFzRXhjaGFuZ2UgfHwgJycKICAgIGF3YWl0IHRoaXMuZ2V0UmVhbFRpbWVJbmZvKCkKICAgIGlmICh0aGlzLm9wdGlvbnMucG9wdXApIHsKICAgICAgdGhpcy5zaG93T3JkZXJUaXAoKQogICAgfQogICAgaWYgKHRoaXMuaGFzRXhjaGFuZ2UgIT0gIiIpIHsgLy8g5Yik5pat5Li65YWR5o2i5Lit5b+D6L+b5YWlCiAgICAgIHRoaXMuZXhjaGFuZ2VfZGF0YSA9IHRoaXMuJHNhdmUuZ2V0KCdzZXNzaW9uJywgJ2V4Y2hhbmdlX2RhdGEnKS8vIOWFkeaNouS4reW/g+a0u+WKqOaVsOaNrgogICAgfQogICAgdGhpcy5nZXRSZWNlaXZlQ29uZGl0aW9uKCkgLy8g5piv5ZCm6ZyA6KaB5aGr5YaZ55So5oi35L+h5oGv5Y+K5YW25p2h5Lu2CiAgICB0aGlzLnZpcFByaWNlKCkKICAgIGF3YWl0IHRoaXMuZ2V0R2lmdEluZm8oKQogICAgYXdhaXQgdGhpcy5nZXRBY3REZXRhaWwodHJ1ZSkKICB9Cn0K"},{"version":3,"sources":["giftBag.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"giftBag.vue","sourceRoot":"src/views/active","sourcesContent":["<!--\r\n * @Description: 大礼包\r\n * @Version: 1.0\r\n * @Autor: cherry\r\n * @Date: 2020-07-20 15:49:14\r\n * @LastEditors: cherry\r\n * @LastEditTime: 2020-08-05 19:29:25\r\n--> \r\n<template>\r\n  <div>\r\n    <van-skeleton title :row=\"14\" :loading=\"!ready\">\r\n      <common-swiper :imgUrls=\"info.mediaList\" urlName=\"img\"></common-swiper>\r\n      <div class=\"act-container\">\r\n        <active-header  \r\n          :info.sync=\"info\" \r\n          :channelType=\"channelType\" \r\n          :selConsumer=\"selConsumer\" \r\n          :showTime=\"showTime\" \r\n          :remainTime=\"remainTime\" \r\n          :downTime.sync=\"downTime\"\r\n          :btnDisabled=\"btnDisabled\" \r\n          :hasExchange=\"options.hasExchange\">\r\n        </active-header>\r\n        <!-- 现金红包 && 使用规则 -->\r\n        <active-cash id=\"activeCash\" :info=\"info\" :options=\"options\" :actType=\"info.actType\" />\r\n        <!-- 推荐理由 -->\r\n        <active-gift-reason :info=\"info\"></active-gift-reason>\r\n        <!-- 礼包详情 -->\r\n        <active-gift :info=\"info\"></active-gift>\r\n        <!-- 活动须知 -->\r\n        <div class=\"active-panel\">\r\n          <div class='gift-title bold' id=\"rule\">活动须知</div>\r\n          <div class=''><span class=\"actRule\">{{info.actRule}}</span></div>\r\n        </div>\r\n        <!-- 礼包介绍 -->\r\n        <active-graphic :detail=\"info.actExplain\" title=\"礼包介绍\"></active-graphic>\r\n        \r\n      </div>\r\n      <!-- 兑换中心进入时 -->\r\n      <div class='active-footer footer1' v-if='options.hasExchange'>\r\n        <img v-if=\"!btnDisabled\" src='http://doyd.oss-cn-shenzhen.aliyuncs.com/vip_mini_apply/v1.0.0/btn_base_pay1.png'>\r\n        <img v-else src='http://doyd.oss-cn-shenzhen.aliyuncs.com/vip_mini_apply/v1.0.0/btn_unclickable_pay1.png'>\r\n        <div class='flex-v poa footer-text'>\r\n          <button class=\"ft34 tac\" :class=\"btnDisabled ? 'cB5' : 'c99' \"  id=\"STATIS_BUY\">{{btnText}}</button>\r\n        </div>\r\n      </div>\r\n      <!-- 正常活动进入 -->\r\n      <div class=\"footer pof\" v-else>\r\n        <active-footer :info=\"info\" :btnText=\"btnText\" :btnDisabled=\"btnDisabled\" :selCashred=\"selCashred\" :selConsumer=\"selConsumer\" @success=\"getGift\"></active-footer>\r\n      </div>\r\n\r\n      <!-- 非会员购买时提示 -->\r\n      <div class='mask flex-c flex-v cAE' v-if=\"showPop\">\r\n        <div class='flex-col flex-c flex-v por mask-box'>\r\n          <text class='pop-til ft36 bold poa'>温馨提示</text>\r\n          <div class='pop-cont ft30 poa tac'>您还不是潮级VIP，开通后本次消费可优惠买单</div>\r\n          <!-- 关闭按钮 -->\r\n          <img src='/images/p_close_icon.png' class='p_close_icon poa' @click='closePop'>\r\n          <img src='http://doyd.oss-cn-shenzhen.aliyuncs.com/vip_mini_apply/pop_buy.png' class='pop_buy'>\r\n          <div class='pop-btn por tac ft36 bold' @click=\"toJoin\">￥{{lowPrice | fixedNum}}去开通</div>\r\n        </div>\r\n      </div>\r\n    </van-skeleton>\r\n\r\n  </div>\r\n</template>\r\n<script>\r\n  import { mapGetters, mapActions, mapMutations } from \"vuex\";\r\n  import seckillMixin from '@/mixins/seckillMixin' \r\n  import activeHeader from '@components/active/activeHeader'\r\n  import activeCash from '@components/active/activeCash'\r\n  import activeGift from '@components/active/activeGift'\r\n  import activeGiftReason from '@components/active/activeGiftReason'\r\n  import activeGraphic from '@components/active/activeGraphic'\r\n  import activeFooter from '@components/active/activeFooter'\r\n  import activeUtils from '@/filters/active.js'\r\n  import orderPay from \"@/utils/pay\"\r\n  import utils from \"@/utils/utils\"\r\n  export default {\r\n    name: 'giftBag',\r\n    mixins: [seckillMixin],\r\n    computed: {\r\n    },\r\n    components: {\r\n      activeHeader,\r\n      activeCash,\r\n      activeGift,\r\n      activeGiftReason,\r\n      activeGraphic,\r\n      activeFooter\r\n    },\r\n    data() {\r\n      return {\r\n        ready: false,\r\n        timer: null,\r\n        limitTimer: null,\r\n        showPop: false,\r\n        btnText: '立即抢购',\r\n        headline: '',\r\n        showTime: true,\r\n        remainTime: 0,\r\n        channelType: '',\r\n        options: this.$route.query || {},\r\n        btnDisabled: false, // 按钮是否不可用\r\n        btnFontSize: 'ft34',\r\n        selCashred: {},\r\n        selConsumer: {},\r\n        conditionInfo: {},\r\n        tracvelUserList: [],\r\n        selDate: {\r\n          startTime: ''\r\n        },\r\n        info: {},\r\n        receiveObj: {\r\n          2: '新用户',\r\n          3: '会员',\r\n          4: '非会员'\r\n        },\r\n        downTime: {\r\n          hour: '00',\r\n          minute: '00',\r\n          second: '00'\r\n        },\r\n      }\r\n    },\r\n    computed: {\r\n      ...mapGetters([\"locationInfo\", \"wxUser\", \"locationCity\", \"vipCardInfo\", \"updateGift\"])\r\n    },\r\n    methods: {\r\n      ...mapMutations('active', [\r\n        'SET_UPDATEGIFT'\r\n      ]),\r\n    // 设置提醒\r\n      remindSet(e) {\r\n\r\n      },\r\n\r\n      handlerLimit(res, flag){\r\n        if (res.info.limitActState == 8 || res.info.limitActState == 9) {\r\n          res.info.timeState = 1\r\n          this.headline = activeUtils.getDayName(res.info.limitStartTime)\r\n        } else if (res.info.limitActState == 1 || res.info.limitActState == 3 || res.info.limitActState == 10) {\r\n          res.info.timeState = 2\r\n        } else if (res.info.limitActState == 2) {\r\n          res.info.timeState = 3\r\n        } else {\r\n          // 1未开始 2进行中 3已结束\r\n          let currentTime = +new Date()\r\n          if((res.info.limitEndTime<currentTime) && (res.info.limitStartTime<currentTime)) {\r\n            res.info.timeState = 3\r\n          } else if ((res.info.limitEndTime>currentTime) && (res.info.limitStartTime<currentTime)){\r\n            res.info.timeState = 2\r\n          } else if (res.info.limitStartTime>currentTime) {\r\n            res.info.timeState = 1\r\n            this.headline = activeUtils.getDayName(res.info.limitStartTime)\r\n          }\r\n        }\r\n        if(res.info.timeState != 3) {\r\n          clearInterval(this.limitTimer)\r\n          this.limitTimer = setInterval(() => {\r\n            let nowTime = +new Date()\r\n            var cutTime = 0\r\n            if(res.info.timeState == 1) {\r\n              cutTime = res.info.limitStartTime - nowTime\r\n            } else { \r\n              cutTime = res.info.limitEndTime - nowTime\r\n            }\r\n            this.downTime = utils.countDown3(cutTime)\r\n            if(cutTime <= 0 && (res.info.limitActState != 12)){\r\n              clearInterval(this.limitTimer)\r\n              this.getActDetail()\r\n            }\r\n          }, 1000)\r\n        } else {\r\n          this.downTime = {\r\n            hour: '00',\r\n            minute: '00',\r\n            second: '00'\r\n          }\r\n        }\r\n        console.log('res...........', res.info, this.downTime)\r\n\r\n        if(flag) {\r\n          // 已抢完活动弹窗\r\n          if(res.info.limitActState == 3 || res.info.limitActState == 2 || !this.info.remainNum) {\r\n            this.getEndActive()\r\n          }\r\n        }\r\n      },\r\n      // 。。。。。。。。。。。。。。。。。。。。。优化结束。。。。。。。。。。。。。。\r\n\r\n      closePop() {\r\n        this.showPop = false\r\n      },\r\n\r\n      // 礼包特有信息\r\n      getGiftInfo() {\r\n        return this.$api.act_gift_info({\r\n          channelType: this.channelType,\r\n          qrCode: this.qrCode,\r\n          actSn: this.actSn,\r\n          lat: this.locationInfo.latitude,\r\n          lng: this.locationInfo.longitude\r\n        }).then(res => {\r\n          if (res.state) {\r\n            let cardSum = 0\r\n            res.info.cardList.forEach((item) => {\r\n              cardSum += item.cardNum\r\n            })\r\n            this.info = Object.assign({ cardSum }, this.info, res.info)\r\n            if (res.info.remainNum == 0) {\r\n              this.handlerBtn('已售罄', true)\r\n            }\r\n            \r\n          }\r\n        })\r\n      },\r\n\r\n      handlerBtn(text, disabled=false, fontSize='ft34') {\r\n        this.btnText = text\r\n        this.btnFontSize = fontSize\r\n        this.btnDisabled = disabled\r\n        if (disabled) {\r\n          this.showTime = false\r\n        }\r\n      },\r\n\r\n      // 判断用户购买信息\r\n      getRealTimeInfo(limitFrequency) {\r\n        return this.$api.realTime_info({\r\n          actSn: this.actSn\r\n        }).then(res => {\r\n          if (res.state) {\r\n            this.realInfo = res.info\r\n          }\r\n        })\r\n      },\r\n      getReceiveCondition () {\r\n        return this.$api.receive_condition({\r\n          actSn: this.actSn\r\n        }).then(res=> {\r\n          if (res.state) {\r\n            this.conditionInfo = res.info\r\n          }\r\n        })\r\n      },\r\n      // 处理立即领取的按钮\r\n      handlerReceiveBtn() {\r\n        let hasReceiveChannelFreeGift = this.info.hasReceiveChannelFreeGift\r\n        let channelType = this.channelType\r\n        this.handlerBtn('立即领取')\r\n        if (hasReceiveChannelFreeGift && channelType == 'CHANNEL_ACTIVITY_LABEL_SHOW') this.handlerBtn('领取次数已用完', true)\r\n      },\r\n\r\n      // 通用活动详情\r\n      getActDetail(flag) {\r\n        this.$Toast.loading({\r\n          message: '加载中...',\r\n          forbidClick: true,\r\n          duration: 0\r\n        })\r\n        return this.$api.act_detail({\r\n          channelType: this.channelType,\r\n          qrCode: this.qrCode,\r\n          actSn: this.actSn\r\n        }).then(async res => {\r\n          if (res.state) {\r\n            this.enumKey = res.info.childEnumKey\r\n            this.showShare = true\r\n\r\n            // 处理限时的倒计时等问题 \r\n            if ( res.info.childEnumKey == 'ACT_GIFT_PACKAGE_PURCHASE_LIMIT') {\r\n              this.handlerLimit(res, flag)\r\n            }\r\n            res.info.channelType = this.channelType || ''\r\n            this.info = Object.assign({}, this.info, res.info)\r\n            this.remainTime = res.info.remainTime\r\n            this.showTime = res.info.showTime\r\n            this.ready = true\r\n\r\n            console.log('info..........', this.info)\r\n\r\n            // 按钮文字\r\n            let vipUser = this.vipCardInfo.vipUser\r\n            this.vipUser = this.vipCardInfo.vipUser\r\n            let channelType = this.channelType\r\n            let restrictState = this.info.restrictState\r\n            let packageGiftType = this.info.packageGiftType\r\n            let hasReceiveChannelFreeGift = this.info.hasReceiveChannelFreeGift\r\n            let remainNum = this.info.remainNum\r\n            let channelTrack = this.info.channelTrack\r\n            let sellPrice = this.info.sellPrice\r\n            let noVipPrice = this.info.noVipPrice\r\n            let state = res.info.actState\r\n            let buyLimit = res.info.buyLimit\r\n\r\n            if (state == 1) {\r\n              this.handlerBtn('未开始', true)\r\n            } else if (state == 3) {\r\n              this.handlerBtn('已售罄', true)\r\n            } else if (state == 4) {\r\n              this.handlerBtn('已结束', true)\r\n            } else if (state == 5) {\r\n              //  会员\r\n              if(vipUser){\r\n                if (sellPrice > 0){\r\n                  this.handlerBtn('已售罄', true)\r\n                } else {\r\n                  this.handlerBtn('领取次数已用完', true)\r\n                }\r\n              }else{\r\n                if (buyLimit == 1 && noVipPrice > 0) {\r\n                  this.handlerBtn('已售罄', true)\r\n                } else if (buyLimit == 1 && noVipPrice == 0) {\r\n                  this.handlerBtn('领取次数已用完', true)\r\n                } else if (buyLimit == 2) {\r\n                  this.handlerBtn('已售罄', true)\r\n                }\r\n              }\r\n            }\r\n            // 外部渠道进入\r\n            if (state == 2) {\r\n              \r\n              // ..............外部渠道礼包为售卖型....................\r\n              if (channelTrack ? packageGiftType == 1 : restrictState == 2) {\r\n                if (remainNum > 0) {\r\n                  this.handlerBtn('立即购买')\r\n                } else {\r\n                  //  会员\r\n                  if (vipUser) {\r\n                    if (sellPrice > 0) {\r\n                      this.handlerBtn('已售罄', true)\r\n                    } else {\r\n                      this.handlerBtn('领取次数已用完', true)\r\n                    }\r\n                  } else {\r\n                    if (buyLimit == 1 && noVipPrice > 0) {\r\n                      this.handlerBtn('已售罄', true)\r\n                    } else if (buyLimit == 1 && noVipPrice == 0) {\r\n                      this.handlerBtn('领取次数已用完', true)\r\n                    } else if (buyLimit == 2) {\r\n                      this.handlerBtn('已售罄', true)\r\n                    }\r\n                  }\r\n                }\r\n\r\n                // 仅会员可购买时，非会员显示\r\n                if (buyLimit == 2 && !vipUser) {\r\n                  this.handlerBtn('开通并购买')\r\n                }\r\n\r\n                // 仅会员可购买，会员价为0，非会员视角\r\n                if (buyLimit == 2 && !sellPrice && !vipUser) {\r\n                  this.open_receive = true\r\n                  this.handlerBtn('开通并领取')\r\n                  \r\n                }\r\n\r\n                //.................立即领取的按钮开始...................\r\n                // 仅会员可购买，会员价为0，会员视角\r\n                if (buyLimit == 2 && !sellPrice && vipUser) {\r\n                  this.handlerReceiveBtn(state)\r\n                }\r\n\r\n                // 所有人可购买，会员价、非会员价都为0，所有人视角\r\n                if (buyLimit == 1 && !sellPrice && !noVipPrice) {\r\n                  this.handlerReceiveBtn(state)\r\n                }\r\n                \r\n                // 所有人可购买，会员价、非会员价都为0，所有人视角\r\n                if (buyLimit == 1 && !sellPrice && !noVipPrice) {\r\n                  this.handlerReceiveBtn(state)\r\n                }\r\n                \r\n                // 所有人可购买，会员价、非会员价都为0，所有人视角\r\n                if (buyLimit == 1 && !sellPrice && vipUser) {\r\n                  this.handlerReceiveBtn(state)\r\n                }\r\n                //.................立即领取的按钮结束...................\r\n\r\n              } else if (channelTrack ? packageGiftType == 2 : restrictState == 1) {\r\n                \r\n                // ..............外部渠道礼包为免费领取型................\r\n                if (remainNum > 0) {\r\n                  this.handlerBtn('立即领取')\r\n                } else {\r\n                  this.handlerBtn('已售罄', true)\r\n                }\r\n                if (hasReceiveChannelFreeGift && channelType == 'CHANNEL_ACTIVITY_LABEL_SHOW') {\r\n                  this.handlerBtn('领取次数已用完', true)\r\n                }\r\n              }\r\n\r\n\r\n              //....................领取次数与购买次数是否已用完................ \r\n              let totalNum = Number(this.realInfo.userBuyNum) + Number(this.realInfo.userFreeReceiveNum) // 当前用户的购买数量和领取数量总和\r\n              let contation = (res.info.buyLimit == 1 && !res.info.sellPrice && !res.info.noVipPrice) || (res.info.buyLimit == 2 && !res.info.sellPrice) // 判断已领取的状态\r\n\r\n              // 判断是否限制购买\r\n              if (res.info.limitState) {\r\n                if (totalNum >= res.info.limitFrequency) {\r\n\r\n                  // 用户总成功购买数量大于限制购买数量\r\n                  this.handlerBtn('已购买', true)\r\n                }\r\n                if ((totalNum >= res.info.limitFrequency) && contation) {\r\n\r\n                  // 当前用户当前活动中总免费领取数量大于限制领取数量\r\n                  this.handlerBtn('领取次数已用完', true)\r\n                }\r\n              }\r\n            } \r\n            // 判断为兑换中心进入\r\n            if (this.hasExchange != '') { \r\n              let exchange_data = this.exchange_data // 兑换中心活动数据\r\n\r\n              if (exchange_data.hasExchange) {\r\n                this.handlerBtn('已兑换', true)\r\n              } else {\r\n                if (exchange_data.remainNum > 0) {\r\n                  if (exchange_data.state != 2) {\r\n                    this.handlerBtn('已结束', true)\r\n                  } else {\r\n                    if (exchange_data.condition) {                                                                   \r\n                      this.handlerBtn('立即兑换', false)\r\n                    } else {\r\n                      this.handlerBtn('立即兑换', true)\r\n                    }\r\n                  }\r\n                } else {\r\n                  this.handlerBtn('已兑完', true)\r\n                }\r\n              }\r\n            }\r\n\r\n            // .................优化新增............................\r\n            // 判断从限购进入\r\n            if (this.info.childEnumKey == 'ACT_GIFT_PACKAGE_PURCHASE_LIMIT') {\r\n              // 判断按钮的展示\r\n              // 1.活动未开始 未设置提醒 ----- 提醒我/预约提醒 \r\n              // 2.活动未开始 已设置提醒 ----- 已预约\r\n              // 3.活动进行中 ----- 立即抢购\r\n              // 4.活动进行中 购买次数达到上限----- 已购买\r\n              // 5.活动进行中 库存为0 ----- 已抢完\r\n              // 6.活动未发布 无法购买、设置提醒 ----- 若点击，则toast提示“当前活动/合辑未发布”\r\n              // 7.活动已结束 -----  已抢完\r\n              if (!this.info.remainNum) {\r\n                this.handlerBtn('已抢完', true)\r\n                return\r\n              }\r\n              if(res.info.actState == 11  || res.info.actState == 3) {\r\n                this.handlerBtn('已抢完', true)\r\n              } else {\r\n                // if (res.info.limitActState == 8) {\r\n                //   this.handlerBtn('预约提醒', false)\r\n                // } else if (res.info.limitActState == 9) {\r\n                //   this.handlerBtn('已预约', false)\r\n                // } \r\n                if (res.info.limitActState == 8 || res.info.limitActState == 9) {\r\n                  this.handlerBtn('未开始', true)\r\n                } else if (res.info.limitActState == 1) {\r\n                  this.handlerBtn('立即抢购', false)\r\n                } else if (res.info.limitActState == 10) {\r\n                  this.handlerBtn('已购买', true)\r\n                } else if (res.info.limitActState == 3) {\r\n                  this.handlerBtn('已抢完', true)\r\n                } else if (res.info.limitActState == 2) {\r\n                  this.handlerBtn('已抢完', true)\r\n                }\r\n              }\r\n            }\r\n\r\n            this.showBtnTxt = true\r\n          \r\n            // 如果需要显示倒计时\r\n            if (this.showTime && this.info.childEnumKey != 'ACT_GIFT_PACKAGE_PURCHASE_LIMIT') {\r\n              clearInterval(this.timer)\r\n              var remainTime = res.info.remainTime\r\n\r\n              this.timer = setInterval(() => {\r\n                if (remainTime >= 1000) {\r\n                  remainTime -= 1000\r\n                } else {\r\n                  clearInterval(this.timer)\r\n                }\r\n                this.remainTime = remainTime || 0\r\n              }, 1000)\r\n            }\r\n\r\n            this.getCashNum() // 获取活动红包当前享用最大红包\r\n          } else {\r\n            this.back_to(res)\r\n          }\r\n        }).finally(() => {\r\n          this.$Toast.clear()\r\n        })\r\n      },\r\n\r\n      // 领取礼包接口调用\r\n      // receiveType 获取方式，1会员领取，2会员购买，3渠道购买\r\n      receiveGift(receiveType=1) {\r\n        let conditionInfo = this.conditionInfo\r\n        let tracvelUserList = this.tracvelUserList\r\n        if (conditionInfo.isCondition && tracvelUserList.length == 0) {\r\n          // 判断是否需求填写信息\r\n          this.$router.push({\r\n            name: 'travelInformation',\r\n            query: {\r\n              actSn: this.options.actSn\r\n            }\r\n          })\r\n          return\r\n        }\r\n        let actDeal = orderPay.actDeal({\r\n          cityId: this.locationCity.cityId,\r\n          actSn: this.actSn,\r\n          dealNum: 1,\r\n          channelType: this.channelType,\r\n          realFee: 0,\r\n          receiveType,\r\n          openVip: false, //是否开通月卡会员并购买\r\n          actFee: 0, //活动支付费用\r\n          vipFee: 0,\r\n          vipCardId: '',\r\n          buyType: 0,\r\n          qrCode: this.qrCode,\r\n          compId: this.compId, // 合辑Id\r\n          chooseDate: this.selDate.startTime ? utils.formatTime(this.selDate.startTime || 0, 'YYYYMMDD') : 0, // 自我游选择时间\r\n          tracvelUserList: JSON.stringify(this.tracvelUserList)\r\n        })\r\n        if (actDeal) {\r\n          actDeal.then(res => {\r\n            if (res.state) {\r\n              // 改变全局能否免费领取礼包的状态\r\n              this.SET_UPDATEGIFT(true)\r\n              // 清除用户填写信息\r\n              this.$save.remove('session', 'travelInformation')\r\n              this.$router.push({name: 'giftBagSuccess', query: { tradeId: res.info.tradeId, actName: this.info.actName, receive: 1, actSn: this.actSn}})\r\n\r\n              // 跳转领取成功页\r\n              // wx.navigateTo({\r\n              //   url: `/pages/activity/gift_bag_detail/success/success?tradeId=${res.info.tradeId}&actName=${this.info.actName}&receive=1&actSn=${this.actSn}`,\r\n              //   success: (result)=>{\r\n              //     this.setData({\r\n              //       isCanClick: false \r\n              //     })\r\n              //   }\r\n              // });\r\n            }\r\n          })\r\n        }\r\n      },\r\n\r\n      // 判断是否有未支付的订单\r\n      // receiveType 获取方式，1会员领取，2会员购买，3渠道购买\r\n      orderUnpay(receiveType) {\r\n        this.$save.set('session', 'orderInfo', this.info)\r\n        console.log('this.info', this.info)\r\n        if (this.isCanClick2) return \r\n        this.isCanClick2 = true \r\n        this.$api.order_unpay({\r\n          actSn: this.actSn\r\n        }).then(res => {\r\n          if (res.state) {\r\n            if (res.info.existsUnPay) {\r\n              // 如果存在未支付的订单，跳转到订单列表页\r\n              this.$router.push({\r\n                name: 'orderList'\r\n              })\r\n            } else {\r\n              this.jumpSubmit(receiveType)\r\n              this.isCanClick2 = false\r\n            }\r\n          }\r\n        }).catch(() => {\r\n          this.isCanClick2 = false \r\n        })\r\n      },\r\n\r\n      // 跳转购买页面\r\n      jumpSubmit(receiveType) {\r\n        this.$router.push({\r\n          name: 'submitOrder',\r\n          query: {\r\n            qrCode: this.options.qrCode || '',\r\n            compId: this.options.compId || '',\r\n            actSn: this.options.actSn,\r\n            channelType: this.options.channelType,\r\n            receiveType: receiveType,\r\n          }\r\n        })\r\n        \r\n      },\r\n\r\n      // 非会员开通并领取\r\n      openReceive() {\r\n        this.$set(this.info, 'sellPrice', 0)\r\n        this.$set(this.info, 'noVipPrice', 0)\r\n        this.$save.set('session', 'orderInfo', this.info)\r\n        // 非会员开通并领取\r\n        let receiveType = this.channelType == 'CHANNEL_ACTIVITY_LABEL_SHOW' ? 4 : 1\r\n        this.jumpSubmit(receiveType)\r\n      },\r\n\r\n      handlerLimitEvent() {\r\n        if( this.info.limitActState == 12 ) {\r\n          this.$Toast('当前合辑非进行中状态')\r\n        } else {\r\n          if(this.btnText == '立即抢购') {\r\n            this.$save.set('session', 'orderInfo', this.info)\r\n            this.jumpSubmit(2)\r\n          }\r\n        }\r\n      },\r\n\r\n      /**\r\n      * 领取或者抢购礼包\r\n          restrictState  是否可购买：1否 2是\r\n          receiveType: 外部渠道{\r\n            购买： 3\r\n            免费领:  1\r\n          }\r\n      */\r\n      getGift() {\r\n        var vipUser = this.vipCardInfo.vipUser\r\n        var isnewUser = this.realInfo.newUser\r\n        let packageGiftType = this.info.packageGiftType // 1售卖 2免费领\r\n        let freeReceiveType = this.info.freeReceiveType // 1所有人可领取 2仅限新用户 3仅限会员 4仅限非会员\r\n        let restrictState = this.info.restrictState\r\n        let channelTrack = this.info.channelTrack // 通过这个字段，判断用packageGiftType还是restrictState字段\r\n        var jumpSate = false // 用来判断是否提示仅限某用户领取\r\n        if (freeReceiveType == 1) {\r\n          // 所有人可领取\r\n          jumpSate = true\r\n        } else if (freeReceiveType == 2 && isnewUser) {\r\n          // 判断用户是否为新用户\r\n          jumpSate = true\r\n        } else if (freeReceiveType == 3 && vipUser) {\r\n          // 判断是否仅会员领取\r\n          jumpSate = true\r\n        } else if (freeReceiveType == 4 && !vipUser) {\r\n          // 判断是否仅非会员领取\r\n          jumpSate = true\r\n        }\r\n\r\n        // 如果是开通并领取\r\n        if (this.open_receive) {\r\n          this.$set(this.info, 'sellPrice', 0)\r\n          this.$set(this.info, 'noVipPrice', 0)\r\n        }\r\n\r\n        this.$save.set('session', 'orderInfo', this.info)\r\n        if (this.hasExchange != '') {\r\n          // 判断兑奖中心进入 立即兑换\r\n          let conditionInfo = this.conditionInfo\r\n          let tracvelUserList = this.tracvelUserList\r\n          if (conditionInfo.isCondition && tracvelUserList.length == 0) {\r\n            // 判断是否需求填写信息\r\n            this.$router.push({\r\n              name: 'travelInformation',\r\n              query: {\r\n                actSn: this.options.actSn\r\n              }\r\n            })\r\n            return\r\n          }\r\n          if (!this.btnDisabled) this.exchange()\r\n        } else if (this.info.childEnumKey == 'ACT_GIFT_PACKAGE_PURCHASE_LIMIT') {\r\n          this.handlerLimitEvent()\r\n        } else if (this.info.actState == 2) {\r\n          // 判断是否是从外部渠道进入，外部渠道进入时，如果配置用户可购买，非会员也可购买礼包\r\n          let buyLimit = this.info.buyLimit\r\n          let sellPrice = this.info.sellPrice\r\n          let noVipPrice = this.info.noVipPrice\r\n          let buyState = false;\r\n          //  所有人   会 0   非 0\r\n          if (buyLimit == 1 && noVipPrice == 0 && sellPrice == 0){\r\n            buyState = false;\r\n          //  会员身份\r\n          } else if (vipUser && sellPrice > 0){\r\n            buyState = true\r\n          } else if (!vipUser){\r\n            buyState = buyLimit == 2 ? true : noVipPrice > 0 \r\n          }\r\n\r\n          if (channelTrack ? packageGiftType == 1 : restrictState == 2) {\r\n\r\n            if(buyState){\r\n              // 购买礼包\r\n\r\n              // 如果是外部渠道并且是领取状态，receiveType为4，购买状态receiveType为2\r\n              let receiveType = this.channelType == 'CHANNEL_ACTIVITY_LABEL_SHOW' && this.open_receive ? 4 : 2\r\n              if (buyLimit == 2 && sellPrice == 0) {\r\n                receiveType = 1\r\n              }\r\n              this.orderUnpay(receiveType)    \r\n            } else {\r\n              // 使用字段restrictState判断\r\n              this.receiveGift(4)\r\n            }\r\n\r\n          } else if (channelTrack ? packageGiftType == 2 : restrictState == 1) {\r\n            // 免费领\r\n            if (channelTrack) {\r\n\r\n              // 使用字段packageGiftType判断\r\n              if (freeReceiveType != 1 && !jumpSate) {\r\n                this.$Toast(`仅限${this.receiveObj[freeReceiveType]}领取`)\r\n              } else {\r\n                this.receiveGift(4)\r\n              }\r\n            } else {\r\n\r\n              // 使用字段restrictState判断\r\n              this.receiveGift(4)\r\n            }\r\n            \r\n          }\r\n        }\r\n      },\r\n\r\n      // 兑换\r\n      exchange () {\r\n        let item = this.exchange_data\r\n        this.$dialog.confirm({\r\n          title: `是否确认兑换${item.actName || ''}?`,\r\n          message:'兑换后不可更改且原有潮卡将会清空',\r\n        }).then(()=>{\r\n          this.priceExchange(item)\r\n        }).catch(() => {\r\n              // on cancel\r\n        });\r\n      },\r\n\r\n      // 开始兑换\r\n      priceExchange (item) {\r\n        if (this.canClick) return\r\n        this.canClick = true\r\n        this.$api.price_exchange({\r\n          actSn: item.actSn,\r\n          awardId: item.awardId,\r\n          cityId: this.locationCity.cityId,\r\n          chooseDate: this.selDate.startTime ? utils.formatTime(this.selDate.startTime || 0, 'YYYYMMDD') : 0, // 自我游选择时间\r\n          tracvelUserList: JSON.stringify(this.tracvelUserList)\r\n        }).then(res => {\r\n          if (res.state) {\r\n            this.mask = true\r\n            this.handlerBtn('已兑换', true)\r\n            // 清除用户填写信息\r\n            this.$save.remove('session', 'travelInformation')\r\n          } else {\r\n            this.$Toast(res.message)\r\n          }\r\n        }).finally(()=>{\r\n          setTimeout(()=>{\r\n            this.canClick = false\r\n          }, 300)\r\n        })\r\n      },\r\n\r\n      goCard() {\r\n        this.$router.push({\r\n          name: 'couponList'\r\n        })\r\n      },\r\n\r\n      close() {\r\n        this.mask = false\r\n      },\r\n\r\n      // 获取会员卡最低价格\r\n      vipPrice() {\r\n        this.$api.low_price({}).then(res => {\r\n          if (res.state) {\r\n            this.lowPrice = res.info.lowPrice\r\n          }\r\n        })\r\n      },\r\n      \r\n      showOrderTip() {\r\n        this.$dialog.alert({\r\n          title: '提示',\r\n          message: '订单超时已取消，请重新下单',\r\n          confirmButtonText: '确定',\r\n          confirmButtonColor: '#D90634'\r\n        })\r\n      },\r\n      \r\n      toJoin() {\r\n        this.$router.push({\r\n          name:'joinVip',\r\n          query: {\r\n            channelType: this.channelType\r\n          }\r\n        })\r\n      },\r\n\r\n      // 关闭红包列表\r\n      colsecashMask() {\r\n        this.cashMask = !this.cashMask\r\n      },\r\n\r\n      // 获取活动红包当前享用最大红包\r\n      getCashNum() {\r\n        let vip_check = (!this.vipUser && this.info.buyLimit == 2) ? true : false\r\n        let price = (this.info.buyLimit == 2 || this.vipUser) ? this.info.sellPrice : this.info.noVipPrice\r\n        this.$api.cash_red_list({\r\n          actSn: this.actSn,\r\n          cityId: this.locationCity.cityId,\r\n          openVip: vip_check, // 是否勾选会员卡\r\n          vipFee: vip_check ? this.lowPrice : 0, // 会员卡金额\r\n          actFee: price, // 活动金额\r\n          cardId: \"\", // 特卖卡券id || 礼包传空\r\n        }).then(res => {\r\n          if (res.state) {\r\n            let redList = res.info.cashRedList || []\r\n            let consumerCouponList = res.info.consumerCouponList || []\r\n            let usableList = redList.filter((item) => item.currentAbleUse) // 过滤可用红包\r\n            let sortUsableList = usableList.sort(function(a, b) { // 降序排序\r\n              return b.money - a.money\r\n            })\r\n            this.selCashred = sortUsableList[0] || {} // 选中最大红包\r\n            if (consumerCouponList.length) {\r\n              this.selConsumer = consumerCouponList[0] || {} // 选中消费券\r\n            }  \r\n          }\r\n        }).finally(()=> {\r\n        })\r\n      },\r\n\r\n      hasCachRedList ({ detail }) {\r\n        if (detail && detail.length > 0) {\r\n          // 重新请求红包接口\r\n          this.selectComponent('#activeCash').getCashList()\r\n          this.getCashNum()\r\n        } else {\r\n          this.showPageModel = true\r\n        }\r\n      },\r\n      /**\r\n       * 领取或者抢购礼包\r\n          restrictState  是否可购买：1否 2是\r\n          receiveType: 外部渠道{\r\n            购买： 3\r\n            免费领:  1\r\n          }\r\n      */\r\n      getGift() {\r\n        var vipUser =this.vipCardInfo.vipUser\r\n        var isnewUser = this.realInfo.newUser\r\n        let packageGiftType = this.info.packageGiftType // 1售卖 2免费领\r\n        let freeReceiveType = this.info.freeReceiveType // 1所有人可领取 2仅限新用户 3仅限会员 4仅限非会员\r\n        let restrictState = this.info.restrictState\r\n        let channelTrack = this.info.channelTrack // 通过这个字段，判断用packageGiftType还是restrictState字段\r\n        var jumpSate = false // 用来判断是否提示仅限某用户领取\r\n        if (freeReceiveType == 1) {\r\n          // 所有人可领取\r\n          jumpSate = true\r\n        } else if (freeReceiveType == 2 && isnewUser) {\r\n          // 判断用户是否为新用户\r\n          jumpSate = true\r\n        } else if (freeReceiveType == 3 && vipUser) {\r\n          // 判断是否仅会员领取\r\n          jumpSate = true\r\n        } else if (freeReceiveType == 4 && !vipUser) {\r\n          // 判断是否仅非会员领取\r\n          jumpSate = true\r\n        }\r\n\r\n        // 如果是开通并领取\r\n        if (this.open_receive) {\r\n          this.$set(this.info, 'sellPrice', 0)\r\n          this.$set(this.info, 'noVipPrice', 0)\r\n        }\r\n\r\n        this.$save.set('session', 'orderInfo', this.info)\r\n        if (this.hasExchange != '') {\r\n          // 判断兑奖中心进入 立即兑换\r\n          let conditionInfo = this.conditionInfo\r\n          let tracvelUserList = this.tracvelUserList\r\n          if (conditionInfo.isCondition && tracvelUserList.length == 0) {\r\n            // 判断是否需求填写信息\r\n            this.$router.push({\r\n              name: 'travelInformation',\r\n              query: {\r\n                actSn: this.options.actSn\r\n              }\r\n            })\r\n            return\r\n          }\r\n          if (!this.btnDisabled) this.exchange()\r\n        } else if (this.info.childEnumKey == 'ACT_GIFT_PACKAGE_PURCHASE_LIMIT') {\r\n          this.handlerLimitEvent()\r\n        } else if (this.info.actState == 2) {\r\n          // 判断是否是从外部渠道进入，外部渠道进入时，如果配置用户可购买，非会员也可购买礼包\r\n          let buyLimit = this.info.buyLimit\r\n          let sellPrice = this.info.sellPrice\r\n          let noVipPrice = this.info.noVipPrice\r\n          let buyState = false;\r\n          //  所有人   会 0   非 0\r\n          if (buyLimit == 1 && noVipPrice == 0 && sellPrice == 0){\r\n            buyState = false;\r\n          //  会员身份\r\n          } else if (vipUser && sellPrice > 0){\r\n            buyState = true\r\n          } else if (!vipUser){\r\n            buyState = buyLimit == 2 ? true : noVipPrice > 0 \r\n          }\r\n          if (channelTrack ? packageGiftType == 1 : restrictState == 2) {\r\n            if(buyState){\r\n              // 购买礼包\r\n              // 如果是外部渠道并且是领取状态，receiveType为4，购买状态receiveType为2\r\n              let receiveType = this.channelType == 'CHANNEL_ACTIVITY_LABEL_SHOW' && this.open_receive ? 4 : 2\r\n              if (buyLimit == 2 && sellPrice == 0) {\r\n                receiveType = 1\r\n              }\r\n              this.orderUnpay(receiveType)    \r\n            } else {\r\n              // 使用字段restrictState判断\r\n              this.receiveGift(4)\r\n            }\r\n          } else if (channelTrack ? packageGiftType == 2 : restrictState == 1) {\r\n            // 免费领\r\n            if (channelTrack) {\r\n              // 使用字段packageGiftType判断\r\n              if (freeReceiveType != 1 && !jumpSate) {\r\n                this.$Toast(`仅限${this.receiveObj[freeReceiveType]}领取`)\r\n              } else {\r\n                this.receiveGift(4)\r\n              }\r\n            } else {\r\n              // 使用字段restrictState判断\r\n              this.receiveGift(4)\r\n            }\r\n            \r\n          }\r\n        }\r\n      },\r\n    },\r\n    async created() {\r\n      this.options = this.$route.query\r\n      this.actSn =  this.options.actSn\r\n      this.qrCode =  this.options.qrCode || ''\r\n      this.channelType =  this.options.channelType || ''\r\n      this.compId =  this.options.compId || ''\r\n      this.hasExchange =  this.options.hasExchange || ''\r\n      await this.getRealTimeInfo()\r\n      if (this.options.popup) {\r\n        this.showOrderTip()\r\n      }\r\n      if (this.hasExchange != \"\") { // 判断为兑换中心进入\r\n        this.exchange_data = this.$save.get('session', 'exchange_data')// 兑换中心活动数据\r\n      }\r\n      this.getReceiveCondition() // 是否需要填写用户信息及其条件\r\n      this.vipPrice()\r\n      await this.getGiftInfo()\r\n      await this.getActDetail(true)\r\n    }\r\n  }\r\n</script>\r\n<style scoped lang='scss'>\r\n  .gift-title{\r\n    font-size: 32px;\r\n    color: #1A1919;\r\n    margin-bottom: 30px;\r\n    margin-right: 12px;\r\n  }\r\n</style>"]}]}