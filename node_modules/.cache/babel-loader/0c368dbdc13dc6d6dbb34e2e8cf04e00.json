{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\thread-loader\\dist\\cjs.js!C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\src\\views\\active\\giftBag.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\src\\views\\active\\giftBag.vue","mtime":1597889072568},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5udW1iZXIuY29uc3RydWN0b3IiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaCI7CmltcG9ydCBfZGVmaW5lUHJvcGVydHkgZnJvbSAiQzovVXNlcnMvQWRtaW5pc3RyYXRvci9EZXNrdG9wL3ZpcF9pbmxpbmVfaDUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2RlZmluZVByb3BlcnR5IjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiQzovVXNlcnMvQWRtaW5pc3RyYXRvci9EZXNrdG9wL3ZpcF9pbmxpbmVfaDUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgX29iamVjdFNwcmVhZCBmcm9tICJDOi9Vc2Vycy9BZG1pbmlzdHJhdG9yL0Rlc2t0b3AvdmlwX2lubGluZV9oNS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0U3ByZWFkMiI7Cgp2YXIgX25hbWUkbWl4aW5zJGNvbXB1dGVkOwoKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IHsgbWFwR2V0dGVycywgbWFwQWN0aW9ucywgbWFwTXV0YXRpb25zIH0gZnJvbSAidnVleCI7CmltcG9ydCBzZWNraWxsTWl4aW4gZnJvbSAnQC9taXhpbnMvc2Vja2lsbE1peGluJzsgLy8gaW1wb3J0IHNoYXJlTWl4aW4gZnJvbSAnQC9taXhpbnMvc2hhcmVNaXhpbicgCgppbXBvcnQgYWN0aXZlSGVhZGVyIGZyb20gJ0Bjb21wb25lbnRzL2FjdGl2ZS9hY3RpdmVIZWFkZXInOwppbXBvcnQgYWN0aXZlQ2FzaCBmcm9tICdAY29tcG9uZW50cy9hY3RpdmUvYWN0aXZlQ2FzaCc7CmltcG9ydCBhY3RpdmVHaWZ0IGZyb20gJ0Bjb21wb25lbnRzL2FjdGl2ZS9hY3RpdmVHaWZ0JzsKaW1wb3J0IGFjdGl2ZUdpZnRSZWFzb24gZnJvbSAnQGNvbXBvbmVudHMvYWN0aXZlL2FjdGl2ZUdpZnRSZWFzb24nOwppbXBvcnQgYWN0aXZlR3JhcGhpYyBmcm9tICdAY29tcG9uZW50cy9hY3RpdmUvYWN0aXZlR3JhcGhpYyc7CmltcG9ydCBhY3RpdmVGb290ZXIgZnJvbSAnQGNvbXBvbmVudHMvYWN0aXZlL2FjdGl2ZUZvb3Rlcic7CmltcG9ydCBhY3RpdmVVdGlscyBmcm9tICdAL2ZpbHRlcnMvYWN0aXZlLmpzJzsKaW1wb3J0IG9yZGVyUGF5IGZyb20gIkAvdXRpbHMvcGF5IjsKaW1wb3J0IHV0aWxzIGZyb20gIkAvdXRpbHMvdXRpbHMiOwpleHBvcnQgZGVmYXVsdCAoX25hbWUkbWl4aW5zJGNvbXB1dGVkID0gewogIG5hbWU6ICdnaWZ0QmFnJywKICAvLyBtaXhpbnM6IFtzZWNraWxsTWl4aW4sIHNoYXJlTWl4aW5dLAogIG1peGluczogW3NlY2tpbGxNaXhpbl0sCiAgY29tcHV0ZWQ6IHt9LAogIGNvbXBvbmVudHM6IHsKICAgIGFjdGl2ZUhlYWRlcjogYWN0aXZlSGVhZGVyLAogICAgYWN0aXZlQ2FzaDogYWN0aXZlQ2FzaCwKICAgIGFjdGl2ZUdpZnQ6IGFjdGl2ZUdpZnQsCiAgICBhY3RpdmVHaWZ0UmVhc29uOiBhY3RpdmVHaWZ0UmVhc29uLAogICAgYWN0aXZlR3JhcGhpYzogYWN0aXZlR3JhcGhpYywKICAgIGFjdGl2ZUZvb3RlcjogYWN0aXZlRm9vdGVyCiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgcmVhZHk6IGZhbHNlLAogICAgICB0aW1lcjogbnVsbCwKICAgICAgbGltaXRUaW1lcjogbnVsbCwKICAgICAgc2hvd1BvcDogZmFsc2UsCiAgICAgIGJ0blRleHQ6ICfnq4vljbPmiqLotK0nLAogICAgICBoZWFkbGluZTogJycsCiAgICAgIHNob3dUaW1lOiB0cnVlLAogICAgICByZW1haW5UaW1lOiAwLAogICAgICBjaGFubmVsVHlwZTogJycsCiAgICAgIG9wdGlvbnM6IHRoaXMuJHJvdXRlLnF1ZXJ5IHx8IHt9LAogICAgICBidG5EaXNhYmxlZDogZmFsc2UsCiAgICAgIC8vIOaMiemSruaYr+WQpuS4jeWPr+eUqAogICAgICBidG5Gb250U2l6ZTogJ2Z0MzQnLAogICAgICBzZWxDYXNocmVkOiB7fSwKICAgICAgc2VsQ29uc3VtZXI6IHt9LAogICAgICBjb25kaXRpb25JbmZvOiB7fSwKICAgICAgdHJhY3ZlbFVzZXJMaXN0OiBbXSwKICAgICAgc2VsRGF0ZTogewogICAgICAgIHN0YXJ0VGltZTogJycKICAgICAgfSwKICAgICAgaW5mbzoge30sCiAgICAgIHJlY2VpdmVPYmo6IHsKICAgICAgICAyOiAn5paw55So5oi3JywKICAgICAgICAzOiAn5Lya5ZGYJywKICAgICAgICA0OiAn6Z2e5Lya5ZGYJwogICAgICB9LAogICAgICBkb3duVGltZTogewogICAgICAgIGhvdXI6ICcwMCcsCiAgICAgICAgbWludXRlOiAnMDAnLAogICAgICAgIHNlY29uZDogJzAwJwogICAgICB9LAogICAgICBwVHlwZTogJ0FDVF9HSUZUX1BBQ0tBR0UnLAogICAgICBzaGFyZUNsb3NlOiB0cnVlLAogICAgICBzaGFyZUluZm9TZWxmOiB7fQogICAgfTsKICB9Cn0sIF9kZWZpbmVQcm9wZXJ0eShfbmFtZSRtaXhpbnMkY29tcHV0ZWQsICJjb21wdXRlZCIsIF9vYmplY3RTcHJlYWQoe30sIG1hcEdldHRlcnMoWyJsb2NhdGlvbkluZm8iLCAid3hVc2VyIiwgImxvY2F0aW9uQ2l0eSIsICJ2aXBDYXJkSW5mbyIsICJ1cGRhdGVHaWZ0Il0pKSksIF9kZWZpbmVQcm9wZXJ0eShfbmFtZSRtaXhpbnMkY29tcHV0ZWQsICJtZXRob2RzIiwgX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBtYXBNdXRhdGlvbnMoJ2FjdGl2ZScsIFsnU0VUX1VQREFURUdJRlQnXSkpLCB7fSwgX2RlZmluZVByb3BlcnR5KHsKICAvLyDorr7nva7mj5DphpIKICByZW1pbmRTZXQ6IGZ1bmN0aW9uIHJlbWluZFNldChlKSB7fSwKICBoYW5kbGVyTGltaXQ6IGZ1bmN0aW9uIGhhbmRsZXJMaW1pdChyZXMsIGZsYWcpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgaWYgKHJlcy5pbmZvLmxpbWl0QWN0U3RhdGUgPT0gOCB8fCByZXMuaW5mby5saW1pdEFjdFN0YXRlID09IDkpIHsKICAgICAgcmVzLmluZm8udGltZVN0YXRlID0gMTsKICAgICAgdGhpcy5oZWFkbGluZSA9IGFjdGl2ZVV0aWxzLmdldERheU5hbWUocmVzLmluZm8ubGltaXRTdGFydFRpbWUpOwogICAgfSBlbHNlIGlmIChyZXMuaW5mby5saW1pdEFjdFN0YXRlID09IDEgfHwgcmVzLmluZm8ubGltaXRBY3RTdGF0ZSA9PSAzIHx8IHJlcy5pbmZvLmxpbWl0QWN0U3RhdGUgPT0gMTApIHsKICAgICAgcmVzLmluZm8udGltZVN0YXRlID0gMjsKICAgIH0gZWxzZSBpZiAocmVzLmluZm8ubGltaXRBY3RTdGF0ZSA9PSAyKSB7CiAgICAgIHJlcy5pbmZvLnRpbWVTdGF0ZSA9IDM7CiAgICB9IGVsc2UgewogICAgICAvLyAx5pyq5byA5aeLIDLov5vooYzkuK0gM+W3sue7k+adnwogICAgICB2YXIgY3VycmVudFRpbWUgPSArbmV3IERhdGUoKTsKCiAgICAgIGlmIChyZXMuaW5mby5saW1pdEVuZFRpbWUgPCBjdXJyZW50VGltZSAmJiByZXMuaW5mby5saW1pdFN0YXJ0VGltZSA8IGN1cnJlbnRUaW1lKSB7CiAgICAgICAgcmVzLmluZm8udGltZVN0YXRlID0gMzsKICAgICAgfSBlbHNlIGlmIChyZXMuaW5mby5saW1pdEVuZFRpbWUgPiBjdXJyZW50VGltZSAmJiByZXMuaW5mby5saW1pdFN0YXJ0VGltZSA8IGN1cnJlbnRUaW1lKSB7CiAgICAgICAgcmVzLmluZm8udGltZVN0YXRlID0gMjsKICAgICAgfSBlbHNlIGlmIChyZXMuaW5mby5saW1pdFN0YXJ0VGltZSA+IGN1cnJlbnRUaW1lKSB7CiAgICAgICAgcmVzLmluZm8udGltZVN0YXRlID0gMTsKICAgICAgICB0aGlzLmhlYWRsaW5lID0gYWN0aXZlVXRpbHMuZ2V0RGF5TmFtZShyZXMuaW5mby5saW1pdFN0YXJ0VGltZSk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAocmVzLmluZm8udGltZVN0YXRlICE9IDMpIHsKICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmxpbWl0VGltZXIpOwogICAgICB0aGlzLmxpbWl0VGltZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIG5vd1RpbWUgPSArbmV3IERhdGUoKTsKICAgICAgICB2YXIgY3V0VGltZSA9IDA7CgogICAgICAgIGlmIChyZXMuaW5mby50aW1lU3RhdGUgPT0gMSkgewogICAgICAgICAgY3V0VGltZSA9IHJlcy5pbmZvLmxpbWl0U3RhcnRUaW1lIC0gbm93VGltZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY3V0VGltZSA9IHJlcy5pbmZvLmxpbWl0RW5kVGltZSAtIG5vd1RpbWU7CiAgICAgICAgfQoKICAgICAgICBfdGhpcy5kb3duVGltZSA9IHV0aWxzLmNvdW50RG93bjMoY3V0VGltZSk7CgogICAgICAgIGlmIChjdXRUaW1lIDw9IDAgJiYgcmVzLmluZm8ubGltaXRBY3RTdGF0ZSAhPSAxMikgewogICAgICAgICAgY2xlYXJJbnRlcnZhbChfdGhpcy5saW1pdFRpbWVyKTsKCiAgICAgICAgICBfdGhpcy5nZXRBY3REZXRhaWwoKTsKICAgICAgICB9CiAgICAgIH0sIDEwMDApOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5kb3duVGltZSA9IHsKICAgICAgICBob3VyOiAnMDAnLAogICAgICAgIG1pbnV0ZTogJzAwJywKICAgICAgICBzZWNvbmQ6ICcwMCcKICAgICAgfTsKICAgIH0KCiAgICBpZiAoZmxhZykgewogICAgICAvLyDlt7LmiqLlrozmtLvliqjlvLnnqpcKICAgICAgaWYgKHJlcy5pbmZvLmxpbWl0QWN0U3RhdGUgPT0gMyB8fCByZXMuaW5mby5saW1pdEFjdFN0YXRlID09IDIgfHwgIXRoaXMuaW5mby5yZW1haW5OdW0pIHsKICAgICAgICB0aGlzLmdldEVuZEFjdGl2ZSgpOwogICAgICB9CiAgICB9CiAgfSwKICAvLyDjgILjgILjgILjgILjgILjgILjgILjgILjgILjgILjgILjgILjgILjgILjgILjgILjgILjgILjgILjgILjgILkvJjljJbnu5PmnZ/jgILjgILjgILjgILjgILjgILjgILjgILjgILjgILjgILjgILjgILjgIIKICBjbG9zZVBvcDogZnVuY3Rpb24gY2xvc2VQb3AoKSB7CiAgICB0aGlzLnNob3dQb3AgPSBmYWxzZTsKICB9LAogIC8vIOekvOWMheeJueacieS/oeaBrwogIGdldEdpZnRJbmZvOiBmdW5jdGlvbiBnZXRHaWZ0SW5mbygpIHsKICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgIHJldHVybiB0aGlzLiRhcGkuYWN0X2dpZnRfaW5mbyh7CiAgICAgIGNoYW5uZWxUeXBlOiB0aGlzLmNoYW5uZWxUeXBlLAogICAgICBxckNvZGU6IHRoaXMucXJDb2RlLAogICAgICBhY3RTbjogdGhpcy5hY3RTbiwKICAgICAgbGF0OiB0aGlzLmxvY2F0aW9uSW5mby5sYXRpdHVkZSwKICAgICAgbG5nOiB0aGlzLmxvY2F0aW9uSW5mby5sb25naXR1ZGUKICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICBpZiAocmVzLnN0YXRlKSB7CiAgICAgICAgdmFyIGNhcmRTdW0gPSAwOwogICAgICAgIHJlcy5pbmZvLmNhcmRMaXN0LmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgIGNhcmRTdW0gKz0gaXRlbS5jYXJkTnVtOwogICAgICAgIH0pOwogICAgICAgIF90aGlzMi5pbmZvID0gT2JqZWN0LmFzc2lnbih7CiAgICAgICAgICBjYXJkU3VtOiBjYXJkU3VtCiAgICAgICAgfSwgX3RoaXMyLmluZm8sIHJlcy5pbmZvKTsKCiAgICAgICAgaWYgKHJlcy5pbmZvLnJlbWFpbk51bSA9PSAwKSB7CiAgICAgICAgICBfdGhpczIuaGFuZGxlckJ0bign5bey5ZSu572EJywgdHJ1ZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKICB9LAogIGhhbmRsZXJCdG46IGZ1bmN0aW9uIGhhbmRsZXJCdG4odGV4dCkgewogICAgdmFyIGRpc2FibGVkID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBmYWxzZTsKICAgIHZhciBmb250U2l6ZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogJ2Z0MzQnOwogICAgdGhpcy5idG5UZXh0ID0gdGV4dDsKICAgIHRoaXMuYnRuRm9udFNpemUgPSBmb250U2l6ZTsKICAgIHRoaXMuYnRuRGlzYWJsZWQgPSBkaXNhYmxlZDsKCiAgICBpZiAoZGlzYWJsZWQpIHsKICAgICAgdGhpcy5zaG93VGltZSA9IGZhbHNlOwogICAgfQogIH0sCiAgLy8g5Yik5pat55So5oi36LSt5Lmw5L+h5oGvCiAgZ2V0UmVhbFRpbWVJbmZvOiBmdW5jdGlvbiBnZXRSZWFsVGltZUluZm8obGltaXRGcmVxdWVuY3kpIHsKICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgIHJldHVybiB0aGlzLiRhcGkucmVhbFRpbWVfaW5mbyh7CiAgICAgIGFjdFNuOiB0aGlzLmFjdFNuCiAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgaWYgKHJlcy5zdGF0ZSkgewogICAgICAgIF90aGlzMy5yZWFsSW5mbyA9IHJlcy5pbmZvOwogICAgICB9CiAgICB9KTsKICB9LAogIGdldFJlY2VpdmVDb25kaXRpb246IGZ1bmN0aW9uIGdldFJlY2VpdmVDb25kaXRpb24oKSB7CiAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICByZXR1cm4gdGhpcy4kYXBpLnJlY2VpdmVfY29uZGl0aW9uKHsKICAgICAgYWN0U246IHRoaXMuYWN0U24KICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICBpZiAocmVzLnN0YXRlKSB7CiAgICAgICAgX3RoaXM0LmNvbmRpdGlvbkluZm8gPSByZXMuaW5mbzsKICAgICAgfQogICAgfSk7CiAgfSwKICAvLyDlpITnkIbnq4vljbPpooblj5bnmoTmjInpkq4KICBoYW5kbGVyUmVjZWl2ZUJ0bjogZnVuY3Rpb24gaGFuZGxlclJlY2VpdmVCdG4oKSB7CiAgICB2YXIgaGFzUmVjZWl2ZUNoYW5uZWxGcmVlR2lmdCA9IHRoaXMuaW5mby5oYXNSZWNlaXZlQ2hhbm5lbEZyZWVHaWZ0OwogICAgdmFyIGNoYW5uZWxUeXBlID0gdGhpcy5jaGFubmVsVHlwZTsKICAgIHRoaXMuaGFuZGxlckJ0bign56uL5Y2z6aKG5Y+WJyk7CiAgICBpZiAoaGFzUmVjZWl2ZUNoYW5uZWxGcmVlR2lmdCAmJiBjaGFubmVsVHlwZSA9PSAnQ0hBTk5FTF9BQ1RJVklUWV9MQUJFTF9TSE9XJykgdGhpcy5oYW5kbGVyQnRuKCfpooblj5bmrKHmlbDlt7LnlKjlrownLCB0cnVlKTsKICB9LAogIC8vIOmAmueUqOa0u+WKqOivpuaDhQogIGdldEFjdERldGFpbDogZnVuY3Rpb24gZ2V0QWN0RGV0YWlsKGZsYWcpIHsKICAgIHZhciBfdGhpczUgPSB0aGlzOwoKICAgIHRoaXMuJFRvYXN0LmxvYWRpbmcoewogICAgICBtZXNzYWdlOiAn5Yqg6L295LitLi4uJywKICAgICAgZm9yYmlkQ2xpY2s6IHRydWUsCiAgICAgIGR1cmF0aW9uOiAwCiAgICB9KTsKICAgIHJldHVybiB0aGlzLiRhcGkuYWN0X2RldGFpbCh7CiAgICAgIGNoYW5uZWxUeXBlOiB0aGlzLmNoYW5uZWxUeXBlLAogICAgICBxckNvZGU6IHRoaXMucXJDb2RlLAogICAgICBhY3RTbjogdGhpcy5hY3RTbgogICAgfSkudGhlbiggLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICAgICAgdmFyIF9yZWYgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUocmVzKSB7CiAgICAgICAgdmFyIHZpcFVzZXIsIGNoYW5uZWxUeXBlLCByZXN0cmljdFN0YXRlLCBwYWNrYWdlR2lmdFR5cGUsIGhhc1JlY2VpdmVDaGFubmVsRnJlZUdpZnQsIHJlbWFpbk51bSwgY2hhbm5lbFRyYWNrLCBzZWxsUHJpY2UsIG5vVmlwUHJpY2UsIHN0YXRlLCBidXlMaW1pdCwgdG90YWxOdW0sIGNvbnRhdGlvbiwgZXhjaGFuZ2VfZGF0YSwgcmVtYWluVGltZTsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBpZiAoIXJlcy5zdGF0ZSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzU7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF90aGlzNS5zaG93U2hhcmUgPSB0cnVlOwogICAgICAgICAgICAgICAgX3RoaXM1LmVudW1LZXkgPSByZXMuaW5mby5jaGlsZEVudW1LZXk7CiAgICAgICAgICAgICAgICBfdGhpczUuc2hhcmVJbmZvU2VsZiA9IHsKICAgICAgICAgICAgICAgICAgZGVzYzogcmVzLmluZm8uYWN0TmFtZSB8fCAn5aSn56S85YyFJwogICAgICAgICAgICAgICAgfTsgLy8gdGhpcy5zaGFyZVBhZ2UoKQogICAgICAgICAgICAgICAgLy8g5aSE55CG6ZmQ5pe255qE5YCS6K6h5pe2562J6Zeu6aKYIAoKICAgICAgICAgICAgICAgIGlmIChyZXMuaW5mby5jaGlsZEVudW1LZXkgPT0gJ0FDVF9HSUZUX1BBQ0tBR0VfUFVSQ0hBU0VfTElNSVQnKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzNS5oYW5kbGVyTGltaXQocmVzLCBmbGFnKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXMuaW5mby5jaGFubmVsVHlwZSA9IF90aGlzNS5jaGFubmVsVHlwZSB8fCAnJzsKICAgICAgICAgICAgICAgIF90aGlzNS5pbmZvID0gT2JqZWN0LmFzc2lnbih7fSwgX3RoaXM1LmluZm8sIHJlcy5pbmZvKTsKICAgICAgICAgICAgICAgIF90aGlzNS5yZW1haW5UaW1lID0gcmVzLmluZm8ucmVtYWluVGltZTsKICAgICAgICAgICAgICAgIF90aGlzNS5zaG93VGltZSA9IHJlcy5pbmZvLnNob3dUaW1lOwogICAgICAgICAgICAgICAgX3RoaXM1LnJlYWR5ID0gdHJ1ZTsKICAgICAgICAgICAgICAgIC8vIOaMiemSruaWh+WtlwogICAgICAgICAgICAgICAgdmlwVXNlciA9IF90aGlzNS52aXBDYXJkSW5mby52aXBVc2VyOwogICAgICAgICAgICAgICAgX3RoaXM1LnZpcFVzZXIgPSBfdGhpczUudmlwQ2FyZEluZm8udmlwVXNlcjsKICAgICAgICAgICAgICAgIGNoYW5uZWxUeXBlID0gX3RoaXM1LmNoYW5uZWxUeXBlOwogICAgICAgICAgICAgICAgcmVzdHJpY3RTdGF0ZSA9IF90aGlzNS5pbmZvLnJlc3RyaWN0U3RhdGU7CiAgICAgICAgICAgICAgICBwYWNrYWdlR2lmdFR5cGUgPSBfdGhpczUuaW5mby5wYWNrYWdlR2lmdFR5cGU7CiAgICAgICAgICAgICAgICBoYXNSZWNlaXZlQ2hhbm5lbEZyZWVHaWZ0ID0gX3RoaXM1LmluZm8uaGFzUmVjZWl2ZUNoYW5uZWxGcmVlR2lmdDsKICAgICAgICAgICAgICAgIHJlbWFpbk51bSA9IF90aGlzNS5pbmZvLnJlbWFpbk51bTsKICAgICAgICAgICAgICAgIGNoYW5uZWxUcmFjayA9IF90aGlzNS5pbmZvLmNoYW5uZWxUcmFjazsKICAgICAgICAgICAgICAgIHNlbGxQcmljZSA9IF90aGlzNS5pbmZvLnNlbGxQcmljZTsKICAgICAgICAgICAgICAgIG5vVmlwUHJpY2UgPSBfdGhpczUuaW5mby5ub1ZpcFByaWNlOwogICAgICAgICAgICAgICAgc3RhdGUgPSByZXMuaW5mby5hY3RTdGF0ZTsKICAgICAgICAgICAgICAgIGJ1eUxpbWl0ID0gcmVzLmluZm8uYnV5TGltaXQ7CgogICAgICAgICAgICAgICAgaWYgKHN0YXRlID09IDEpIHsKICAgICAgICAgICAgICAgICAgX3RoaXM1LmhhbmRsZXJCdG4oJ+acquW8gOWniycsIHRydWUpOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzdGF0ZSA9PSAzKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzNS5oYW5kbGVyQnRuKCflt7LllK7nvYQnLCB0cnVlKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc3RhdGUgPT0gNCkgewogICAgICAgICAgICAgICAgICBfdGhpczUuaGFuZGxlckJ0bign5bey57uT5p2fJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHN0YXRlID09IDUpIHsKICAgICAgICAgICAgICAgICAgLy8gIOS8muWRmAogICAgICAgICAgICAgICAgICBpZiAodmlwVXNlcikgewogICAgICAgICAgICAgICAgICAgIGlmIChzZWxsUHJpY2UgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICBfdGhpczUuaGFuZGxlckJ0bign5bey5ZSu572EJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgIF90aGlzNS5oYW5kbGVyQnRuKCfpooblj5bmrKHmlbDlt7LnlKjlrownLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGJ1eUxpbWl0ID09IDEgJiYgbm9WaXBQcmljZSA+IDApIHsKICAgICAgICAgICAgICAgICAgICAgIF90aGlzNS5oYW5kbGVyQnRuKCflt7LllK7nvYQnLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGJ1eUxpbWl0ID09IDEgJiYgbm9WaXBQcmljZSA9PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgICBfdGhpczUuaGFuZGxlckJ0bign6aKG5Y+W5qyh5pWw5bey55So5a6MJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChidXlMaW1pdCA9PSAyKSB7CiAgICAgICAgICAgICAgICAgICAgICBfdGhpczUuaGFuZGxlckJ0bign5bey5ZSu572EJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IC8vIOWklumDqOa4oOmBk+i/m+WFpQoKCiAgICAgICAgICAgICAgICBpZiAoc3RhdGUgPT0gMikgewogICAgICAgICAgICAgICAgICAvLyAuLi4uLi4uLi4uLi4uLuWklumDqOa4oOmBk+ekvOWMheS4uuWUruWNluWeiy4uLi4uLi4uLi4uLi4uLi4uLi4uCiAgICAgICAgICAgICAgICAgIGlmIChjaGFubmVsVHJhY2sgPyBwYWNrYWdlR2lmdFR5cGUgPT0gMSA6IHJlc3RyaWN0U3RhdGUgPT0gMikgewogICAgICAgICAgICAgICAgICAgIGlmIChyZW1haW5OdW0gPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICBfdGhpczUuaGFuZGxlckJ0bign56uL5Y2z6LSt5LmwJyk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgIC8vICDkvJrlkZgKICAgICAgICAgICAgICAgICAgICAgIGlmICh2aXBVc2VyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWxsUHJpY2UgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXM1LmhhbmRsZXJCdG4oJ+W3suWUrue9hCcsIHRydWUpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzNS5oYW5kbGVyQnRuKCfpooblj5bmrKHmlbDlt7LnlKjlrownLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJ1eUxpbWl0ID09IDEgJiYgbm9WaXBQcmljZSA+IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpczUuaGFuZGxlckJ0bign5bey5ZSu572EJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYnV5TGltaXQgPT0gMSAmJiBub1ZpcFByaWNlID09IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpczUuaGFuZGxlckJ0bign6aKG5Y+W5qyh5pWw5bey55So5a6MJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYnV5TGltaXQgPT0gMikgewogICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzNS5oYW5kbGVyQnRuKCflt7LllK7nvYQnLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0gLy8g5LuF5Lya5ZGY5Y+v6LSt5Lmw5pe277yM6Z2e5Lya5ZGY5pi+56S6CgoKICAgICAgICAgICAgICAgICAgICBpZiAoYnV5TGltaXQgPT0gMiAmJiAhdmlwVXNlcikgewogICAgICAgICAgICAgICAgICAgICAgX3RoaXM1LmhhbmRsZXJCdG4oJ+W8gOmAmuW5tui0reS5sCcpOwogICAgICAgICAgICAgICAgICAgIH0gLy8g5LuF5Lya5ZGY5Y+v6LSt5Lmw77yM5Lya5ZGY5Lu35Li6MO+8jOmdnuS8muWRmOinhuinkgoKCiAgICAgICAgICAgICAgICAgICAgaWYgKGJ1eUxpbWl0ID09IDIgJiYgIXNlbGxQcmljZSAmJiAhdmlwVXNlcikgewogICAgICAgICAgICAgICAgICAgICAgX3RoaXM1Lm9wZW5fcmVjZWl2ZSA9IHRydWU7CgogICAgICAgICAgICAgICAgICAgICAgX3RoaXM1LmhhbmRsZXJCdG4oJ+W8gOmAmuW5tumihuWPlicpOwogICAgICAgICAgICAgICAgICAgIH0gLy8uLi4uLi4uLi4uLi4uLi4uLueri+WNs+mihuWPlueahOaMiemSruW8gOWniy4uLi4uLi4uLi4uLi4uLi4uLi4KICAgICAgICAgICAgICAgICAgICAvLyDku4XkvJrlkZjlj6/otK3kubDvvIzkvJrlkZjku7fkuLow77yM5Lya5ZGY6KeG6KeSCgoKICAgICAgICAgICAgICAgICAgICBpZiAoYnV5TGltaXQgPT0gMiAmJiAhc2VsbFByaWNlICYmIHZpcFVzZXIpIHsKICAgICAgICAgICAgICAgICAgICAgIF90aGlzNS5oYW5kbGVyUmVjZWl2ZUJ0bihzdGF0ZSk7CiAgICAgICAgICAgICAgICAgICAgfSAvLyDmiYDmnInkurrlj6/otK3kubDvvIzkvJrlkZjku7fjgIHpnZ7kvJrlkZjku7fpg73kuLow77yM5omA5pyJ5Lq66KeG6KeSCgoKICAgICAgICAgICAgICAgICAgICBpZiAoYnV5TGltaXQgPT0gMSAmJiAhc2VsbFByaWNlICYmICFub1ZpcFByaWNlKSB7CiAgICAgICAgICAgICAgICAgICAgICBfdGhpczUuaGFuZGxlclJlY2VpdmVCdG4oc3RhdGUpOwogICAgICAgICAgICAgICAgICAgIH0gLy8g5omA5pyJ5Lq65Y+v6LSt5Lmw77yM5Lya5ZGY5Lu344CB6Z2e5Lya5ZGY5Lu36YO95Li6MO+8jOaJgOacieS6uuinhuinkgoKCiAgICAgICAgICAgICAgICAgICAgaWYgKGJ1eUxpbWl0ID09IDEgJiYgIXNlbGxQcmljZSAmJiAhbm9WaXBQcmljZSkgewogICAgICAgICAgICAgICAgICAgICAgX3RoaXM1LmhhbmRsZXJSZWNlaXZlQnRuKHN0YXRlKTsKICAgICAgICAgICAgICAgICAgICB9IC8vIOaJgOacieS6uuWPr+i0reS5sO+8jOS8muWRmOS7t+OAgemdnuS8muWRmOS7t+mDveS4ujDvvIzmiYDmnInkurrop4bop5IKCgogICAgICAgICAgICAgICAgICAgIGlmIChidXlMaW1pdCA9PSAxICYmICFzZWxsUHJpY2UgJiYgdmlwVXNlcikgewogICAgICAgICAgICAgICAgICAgICAgX3RoaXM1LmhhbmRsZXJSZWNlaXZlQnRuKHN0YXRlKTsKICAgICAgICAgICAgICAgICAgICB9IC8vLi4uLi4uLi4uLi4uLi4uLi7nq4vljbPpooblj5bnmoTmjInpkq7nu5PmnZ8uLi4uLi4uLi4uLi4uLi4uLi4uCgogICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNoYW5uZWxUcmFjayA/IHBhY2thZ2VHaWZ0VHlwZSA9PSAyIDogcmVzdHJpY3RTdGF0ZSA9PSAxKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gLi4uLi4uLi4uLi4uLi7lpJbpg6jmuKDpgZPnpLzljIXkuLrlhY3otLnpooblj5blnosuLi4uLi4uLi4uLi4uLi4uCiAgICAgICAgICAgICAgICAgICAgaWYgKHJlbWFpbk51bSA+IDApIHsKICAgICAgICAgICAgICAgICAgICAgIF90aGlzNS5oYW5kbGVyQnRuKCfnq4vljbPpooblj5YnKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgX3RoaXM1LmhhbmRsZXJCdG4oJ+W3suWUrue9hCcsIHRydWUpOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgaWYgKGhhc1JlY2VpdmVDaGFubmVsRnJlZUdpZnQgJiYgY2hhbm5lbFR5cGUgPT0gJ0NIQU5ORUxfQUNUSVZJVFlfTEFCRUxfU0hPVycpIHsKICAgICAgICAgICAgICAgICAgICAgIF90aGlzNS5oYW5kbGVyQnRuKCfpooblj5bmrKHmlbDlt7LnlKjlrownLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0gLy8uLi4uLi4uLi4uLi4uLi4uLi4uLumihuWPluasoeaVsOS4jui0reS5sOasoeaVsOaYr+WQpuW3sueUqOWujC4uLi4uLi4uLi4uLi4uLi4gCgoKICAgICAgICAgICAgICAgICAgdG90YWxOdW0gPSBOdW1iZXIoX3RoaXM1LnJlYWxJbmZvLnVzZXJCdXlOdW0pICsgTnVtYmVyKF90aGlzNS5yZWFsSW5mby51c2VyRnJlZVJlY2VpdmVOdW0pOyAvLyDlvZPliY3nlKjmiLfnmoTotK3kubDmlbDph4/lkozpooblj5bmlbDph4/mgLvlkowKCiAgICAgICAgICAgICAgICAgIGNvbnRhdGlvbiA9IHJlcy5pbmZvLmJ1eUxpbWl0ID09IDEgJiYgIXJlcy5pbmZvLnNlbGxQcmljZSAmJiAhcmVzLmluZm8ubm9WaXBQcmljZSB8fCByZXMuaW5mby5idXlMaW1pdCA9PSAyICYmICFyZXMuaW5mby5zZWxsUHJpY2U7IC8vIOWIpOaWreW3sumihuWPlueahOeKtuaAgQogICAgICAgICAgICAgICAgICAvLyDliKTmlq3mmK/lkKbpmZDliLbotK3kubAKCiAgICAgICAgICAgICAgICAgIGlmIChyZXMuaW5mby5saW1pdFN0YXRlKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHRvdGFsTnVtID49IHJlcy5pbmZvLmxpbWl0RnJlcXVlbmN5KSB7CiAgICAgICAgICAgICAgICAgICAgICAvLyDnlKjmiLfmgLvmiJDlip/otK3kubDmlbDph4/lpKfkuo7pmZDliLbotK3kubDmlbDph48KICAgICAgICAgICAgICAgICAgICAgIF90aGlzNS5oYW5kbGVyQnRuKCflt7LotK3kubAnLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGlmICh0b3RhbE51bSA+PSByZXMuaW5mby5saW1pdEZyZXF1ZW5jeSAmJiBjb250YXRpb24pIHsKICAgICAgICAgICAgICAgICAgICAgIC8vIOW9k+WJjeeUqOaIt+W9k+WJjea0u+WKqOS4reaAu+WFjei0uemihuWPluaVsOmHj+Wkp+S6jumZkOWItumihuWPluaVsOmHjwogICAgICAgICAgICAgICAgICAgICAgX3RoaXM1LmhhbmRsZXJCdG4oJ+mihuWPluasoeaVsOW3sueUqOWujCcsIHRydWUpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSAvLyDliKTmlq3kuLrlhZHmjaLkuK3lv4Pov5vlhaUKCgogICAgICAgICAgICAgICAgaWYgKF90aGlzNS5oYXNFeGNoYW5nZSAhPSAnJykgewogICAgICAgICAgICAgICAgICBleGNoYW5nZV9kYXRhID0gX3RoaXM1LmV4Y2hhbmdlX2RhdGE7IC8vIOWFkeaNouS4reW/g+a0u+WKqOaVsOaNrgoKICAgICAgICAgICAgICAgICAgaWYgKGV4Y2hhbmdlX2RhdGEuaGFzRXhjaGFuZ2UpIHsKICAgICAgICAgICAgICAgICAgICBfdGhpczUuaGFuZGxlckJ0bign5bey5YWR5o2iJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGV4Y2hhbmdlX2RhdGEucmVtYWluTnVtID4gMCkgewogICAgICAgICAgICAgICAgICAgICAgaWYgKGV4Y2hhbmdlX2RhdGEuc3RhdGUgIT0gMikgewogICAgICAgICAgICAgICAgICAgICAgICBfdGhpczUuaGFuZGxlckJ0bign5bey57uT5p2fJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXhjaGFuZ2VfZGF0YS5jb25kaXRpb24pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpczUuaGFuZGxlckJ0bign56uL5Y2z5YWR5o2iJywgZmFsc2UpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzNS5oYW5kbGVyQnRuKCfnq4vljbPlhZHmjaInLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICBfdGhpczUuaGFuZGxlckJ0bign5bey5YWR5a6MJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IC8vIC4uLi4uLi4uLi4uLi4uLi4u5LyY5YyW5paw5aKeLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLgogICAgICAgICAgICAgICAgLy8g5Yik5pat5LuO6ZmQ6LSt6L+b5YWlCgoKICAgICAgICAgICAgICAgIGlmICghKF90aGlzNS5pbmZvLmNoaWxkRW51bUtleSA9PSAnQUNUX0dJRlRfUEFDS0FHRV9QVVJDSEFTRV9MSU1JVCcpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzMDsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKF90aGlzNS5pbmZvLnJlbWFpbk51bSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjk7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF90aGlzNS5oYW5kbGVyQnRuKCflt7LmiqLlrownLCB0cnVlKTsKCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAyOToKICAgICAgICAgICAgICAgIGlmIChyZXMuaW5mby5hY3RTdGF0ZSA9PSAxMSB8fCByZXMuaW5mby5hY3RTdGF0ZSA9PSAzKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzNS5oYW5kbGVyQnRuKCflt7LmiqLlrownLCB0cnVlKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIC8vIGlmIChyZXMuaW5mby5saW1pdEFjdFN0YXRlID09IDgpIHsKICAgICAgICAgICAgICAgICAgLy8gICB0aGlzLmhhbmRsZXJCdG4oJ+mihOe6puaPkOmGkicsIGZhbHNlKQogICAgICAgICAgICAgICAgICAvLyB9IGVsc2UgaWYgKHJlcy5pbmZvLmxpbWl0QWN0U3RhdGUgPT0gOSkgewogICAgICAgICAgICAgICAgICAvLyAgIHRoaXMuaGFuZGxlckJ0bign5bey6aKE57qmJywgZmFsc2UpCiAgICAgICAgICAgICAgICAgIC8vIH0gCiAgICAgICAgICAgICAgICAgIGlmIChyZXMuaW5mby5saW1pdEFjdFN0YXRlID09IDggfHwgcmVzLmluZm8ubGltaXRBY3RTdGF0ZSA9PSA5KSB7CiAgICAgICAgICAgICAgICAgICAgX3RoaXM1LmhhbmRsZXJCdG4oJ+acquW8gOWniycsIHRydWUpOwogICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlcy5pbmZvLmxpbWl0QWN0U3RhdGUgPT0gMSkgewogICAgICAgICAgICAgICAgICAgIF90aGlzNS5oYW5kbGVyQnRuKCfnq4vljbPmiqLotK0nLCBmYWxzZSk7CiAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzLmluZm8ubGltaXRBY3RTdGF0ZSA9PSAxMCkgewogICAgICAgICAgICAgICAgICAgIF90aGlzNS5oYW5kbGVyQnRuKCflt7LotK3kubAnLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXMuaW5mby5saW1pdEFjdFN0YXRlID09IDMpIHsKICAgICAgICAgICAgICAgICAgICBfdGhpczUuaGFuZGxlckJ0bign5bey5oqi5a6MJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzLmluZm8ubGltaXRBY3RTdGF0ZSA9PSAyKSB7CiAgICAgICAgICAgICAgICAgICAgX3RoaXM1LmhhbmRsZXJCdG4oJ+W3suaKouWujCcsIHRydWUpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgMzA6CiAgICAgICAgICAgICAgICBfdGhpczUuc2hvd0J0blR4dCA9IHRydWU7IC8vIOWmguaenOmcgOimgeaYvuekuuWAkuiuoeaXtgoKICAgICAgICAgICAgICAgIGlmIChfdGhpczUuc2hvd1RpbWUgJiYgX3RoaXM1LmluZm8uY2hpbGRFbnVtS2V5ICE9ICdBQ1RfR0lGVF9QQUNLQUdFX1BVUkNIQVNFX0xJTUlUJykgewogICAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKF90aGlzNS50aW1lcik7CiAgICAgICAgICAgICAgICAgIHJlbWFpblRpbWUgPSByZXMuaW5mby5yZW1haW5UaW1lOwogICAgICAgICAgICAgICAgICBfdGhpczUudGltZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHJlbWFpblRpbWUgPj0gMTAwMCkgewogICAgICAgICAgICAgICAgICAgICAgcmVtYWluVGltZSAtPSAxMDAwOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKF90aGlzNS50aW1lcik7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBfdGhpczUucmVtYWluVGltZSA9IHJlbWFpblRpbWUgfHwgMDsKICAgICAgICAgICAgICAgICAgfSwgMTAwMCk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX3RoaXM1LmdldENhc2hOdW0oKTsgLy8g6I635Y+W5rS75Yqo57qi5YyF5b2T5YmN5Lqr55So5pyA5aSn57qi5YyFCgoKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzNjsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDM1OgogICAgICAgICAgICAgICAgX3RoaXM1LmJhY2tfdG8ocmVzKTsKCiAgICAgICAgICAgICAgY2FzZSAzNjoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUpOwogICAgICB9KSk7CgogICAgICByZXR1cm4gZnVuY3Rpb24gKF94KSB7CiAgICAgICAgcmV0dXJuIF9yZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfTsKICAgIH0oKSkuZmluYWxseShmdW5jdGlvbiAoKSB7CiAgICAgIF90aGlzNS4kVG9hc3QuY2xlYXIoKTsKICAgIH0pOwogIH0sCiAgLy8g6aKG5Y+W56S85YyF5o6l5Y+j6LCD55SoCiAgLy8gcmVjZWl2ZVR5cGUg6I635Y+W5pa55byP77yMMeS8muWRmOmihuWPlu+8jDLkvJrlkZjotK3kubDvvIwz5rig6YGT6LSt5LmwCiAgcmVjZWl2ZUdpZnQ6IGZ1bmN0aW9uIHJlY2VpdmVHaWZ0KCkgewogICAgdmFyIF90aGlzNiA9IHRoaXM7CgogICAgdmFyIHJlY2VpdmVUeXBlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiAxOwogICAgdmFyIGNvbmRpdGlvbkluZm8gPSB0aGlzLmNvbmRpdGlvbkluZm87CiAgICB2YXIgdHJhY3ZlbFVzZXJMaXN0ID0gdGhpcy50cmFjdmVsVXNlckxpc3Q7CgogICAgaWYgKGNvbmRpdGlvbkluZm8uaXNDb25kaXRpb24gJiYgdHJhY3ZlbFVzZXJMaXN0Lmxlbmd0aCA9PSAwKSB7CiAgICAgIC8vIOWIpOaWreaYr+WQpumcgOaxguWhq+WGmeS/oeaBrwogICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgbmFtZTogJ3RyYXZlbEluZm9ybWF0aW9uJywKICAgICAgICBxdWVyeTogewogICAgICAgICAgYWN0U246IHRoaXMub3B0aW9ucy5hY3RTbgogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB2YXIgYWN0RGVhbCA9IG9yZGVyUGF5LmFjdERlYWwoewogICAgICBjaXR5SWQ6IHRoaXMubG9jYXRpb25DaXR5LmNpdHlJZCwKICAgICAgYWN0U246IHRoaXMuYWN0U24sCiAgICAgIGRlYWxOdW06IDEsCiAgICAgIGNoYW5uZWxUeXBlOiB0aGlzLmNoYW5uZWxUeXBlLAogICAgICByZWFsRmVlOiAwLAogICAgICByZWNlaXZlVHlwZTogcmVjZWl2ZVR5cGUsCiAgICAgIG9wZW5WaXA6IGZhbHNlLAogICAgICAvL+aYr+WQpuW8gOmAmuaciOWNoeS8muWRmOW5tui0reS5sAogICAgICBhY3RGZWU6IDAsCiAgICAgIC8v5rS75Yqo5pSv5LuY6LS555SoCiAgICAgIHZpcEZlZTogMCwKICAgICAgdmlwQ2FyZElkOiAnJywKICAgICAgYnV5VHlwZTogMCwKICAgICAgcXJDb2RlOiB0aGlzLnFyQ29kZSwKICAgICAgY29tcElkOiB0aGlzLmNvbXBJZCwKICAgICAgLy8g5ZCI6L6RSWQKICAgICAgY2hvb3NlRGF0ZTogdGhpcy5zZWxEYXRlLnN0YXJ0VGltZSA/IHV0aWxzLmZvcm1hdFRpbWUodGhpcy5zZWxEYXRlLnN0YXJ0VGltZSB8fCAwLCAnWVlZWU1NREQnKSA6IDAsCiAgICAgIC8vIOiHquaIkea4uOmAieaLqeaXtumXtAogICAgICB0cmFjdmVsVXNlckxpc3Q6IEpTT04uc3RyaW5naWZ5KHRoaXMudHJhY3ZlbFVzZXJMaXN0KQogICAgfSk7CgogICAgaWYgKGFjdERlYWwpIHsKICAgICAgYWN0RGVhbC50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBpZiAocmVzLnN0YXRlKSB7CiAgICAgICAgICAvLyDmlLnlj5jlhajlsYDog73lkKblhY3otLnpooblj5bnpLzljIXnmoTnirbmgIEKICAgICAgICAgIF90aGlzNi5TRVRfVVBEQVRFR0lGVCh0cnVlKTsgLy8g5riF6Zmk55So5oi35aGr5YaZ5L+h5oGvCgoKICAgICAgICAgIF90aGlzNi4kc2F2ZS5yZW1vdmUoJ3Nlc3Npb24nLCAndHJhdmVsSW5mb3JtYXRpb24nKTsKCiAgICAgICAgICBfdGhpczYuJHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgbmFtZTogJ2dpZnRCYWdTdWNjZXNzJywKICAgICAgICAgICAgcXVlcnk6IHsKICAgICAgICAgICAgICB0cmFkZUlkOiByZXMuaW5mby50cmFkZUlkLAogICAgICAgICAgICAgIGFjdE5hbWU6IF90aGlzNi5pbmZvLmFjdE5hbWUsCiAgICAgICAgICAgICAgcmVjZWl2ZTogMSwKICAgICAgICAgICAgICBhY3RTbjogX3RoaXM2LmFjdFNuCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOyAvLyDot7Povazpooblj5bmiJDlip/pobUKICAgICAgICAgIC8vIHd4Lm5hdmlnYXRlVG8oewogICAgICAgICAgLy8gICB1cmw6IGAvcGFnZXMvYWN0aXZpdHkvZ2lmdF9iYWdfZGV0YWlsL3N1Y2Nlc3Mvc3VjY2Vzcz90cmFkZUlkPSR7cmVzLmluZm8udHJhZGVJZH0mYWN0TmFtZT0ke3RoaXMuaW5mby5hY3ROYW1lfSZyZWNlaXZlPTEmYWN0U249JHt0aGlzLmFjdFNufWAsCiAgICAgICAgICAvLyAgIHN1Y2Nlc3M6IChyZXN1bHQpPT57CiAgICAgICAgICAvLyAgICAgdGhpcy5zZXREYXRhKHsKICAgICAgICAgIC8vICAgICAgIGlzQ2FuQ2xpY2s6IGZhbHNlIAogICAgICAgICAgLy8gICAgIH0pCiAgICAgICAgICAvLyAgIH0KICAgICAgICAgIC8vIH0pOwoKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sCiAgLy8g5Yik5pat5piv5ZCm5pyJ5pyq5pSv5LuY55qE6K6i5Y2VCiAgLy8gcmVjZWl2ZVR5cGUg6I635Y+W5pa55byP77yMMeS8muWRmOmihuWPlu+8jDLkvJrlkZjotK3kubDvvIwz5rig6YGT6LSt5LmwCiAgb3JkZXJVbnBheTogZnVuY3Rpb24gb3JkZXJVbnBheShyZWNlaXZlVHlwZSkgewogICAgdmFyIF90aGlzNyA9IHRoaXM7CgogICAgdGhpcy4kc2F2ZS5zZXQoJ3Nlc3Npb24nLCAnb3JkZXJJbmZvJywgdGhpcy5pbmZvKTsKICAgIGlmICh0aGlzLmlzQ2FuQ2xpY2syKSByZXR1cm47CiAgICB0aGlzLmlzQ2FuQ2xpY2syID0gdHJ1ZTsKICAgIHRoaXMuJGFwaS5vcmRlcl91bnBheSh7CiAgICAgIGFjdFNuOiB0aGlzLmFjdFNuCiAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgaWYgKHJlcy5zdGF0ZSkgewogICAgICAgIGlmIChyZXMuaW5mby5leGlzdHNVblBheSkgewogICAgICAgICAgLy8g5aaC5p6c5a2Y5Zyo5pyq5pSv5LuY55qE6K6i5Y2V77yM6Lez6L2s5Yiw6K6i5Y2V5YiX6KGo6aG1CiAgICAgICAgICBfdGhpczcuJHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgbmFtZTogJ29yZGVyTGlzdCcKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBfdGhpczcuanVtcFN1Ym1pdChyZWNlaXZlVHlwZSk7CgogICAgICAgICAgX3RoaXM3LmlzQ2FuQ2xpY2syID0gZmFsc2U7CiAgICAgICAgfQogICAgICB9CiAgICB9KS5jYXRjaChmdW5jdGlvbiAoKSB7CiAgICAgIF90aGlzNy5pc0NhbkNsaWNrMiA9IGZhbHNlOwogICAgfSk7CiAgfSwKICAvLyDot7PovazotK3kubDpobXpnaIKICBqdW1wU3VibWl0OiBmdW5jdGlvbiBqdW1wU3VibWl0KHJlY2VpdmVUeXBlKSB7CiAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgIG5hbWU6ICdzdWJtaXRPcmRlcicsCiAgICAgIHF1ZXJ5OiB7CiAgICAgICAgcXJDb2RlOiB0aGlzLm9wdGlvbnMucXJDb2RlIHx8ICcnLAogICAgICAgIGNvbXBJZDogdGhpcy5vcHRpb25zLmNvbXBJZCB8fCAnJywKICAgICAgICBhY3RTbjogdGhpcy5vcHRpb25zLmFjdFNuLAogICAgICAgIGNoYW5uZWxUeXBlOiB0aGlzLm9wdGlvbnMuY2hhbm5lbFR5cGUsCiAgICAgICAgcmVjZWl2ZVR5cGU6IHJlY2VpdmVUeXBlCiAgICAgIH0KICAgIH0pOwogIH0sCiAgLy8g6Z2e5Lya5ZGY5byA6YCa5bm26aKG5Y+WCiAgb3BlblJlY2VpdmU6IGZ1bmN0aW9uIG9wZW5SZWNlaXZlKCkgewogICAgdGhpcy4kc2V0KHRoaXMuaW5mbywgJ3NlbGxQcmljZScsIDApOwogICAgdGhpcy4kc2V0KHRoaXMuaW5mbywgJ25vVmlwUHJpY2UnLCAwKTsKICAgIHRoaXMuJHNhdmUuc2V0KCdzZXNzaW9uJywgJ29yZGVySW5mbycsIHRoaXMuaW5mbyk7IC8vIOmdnuS8muWRmOW8gOmAmuW5tumihuWPlgoKICAgIHZhciByZWNlaXZlVHlwZSA9IHRoaXMuY2hhbm5lbFR5cGUgPT0gJ0NIQU5ORUxfQUNUSVZJVFlfTEFCRUxfU0hPVycgPyA0IDogMTsKICAgIHRoaXMuanVtcFN1Ym1pdChyZWNlaXZlVHlwZSk7CiAgfSwKICBoYW5kbGVyTGltaXRFdmVudDogZnVuY3Rpb24gaGFuZGxlckxpbWl0RXZlbnQoKSB7CiAgICBpZiAodGhpcy5pbmZvLmxpbWl0QWN0U3RhdGUgPT0gMTIpIHsKICAgICAgdGhpcy4kVG9hc3QoJ+W9k+WJjeWQiOi+kemdnui/m+ihjOS4reeKtuaAgScpOwogICAgfSBlbHNlIHsKICAgICAgaWYgKHRoaXMuYnRuVGV4dCA9PSAn56uL5Y2z5oqi6LStJykgewogICAgICAgIHRoaXMuJHNhdmUuc2V0KCdzZXNzaW9uJywgJ29yZGVySW5mbycsIHRoaXMuaW5mbyk7CiAgICAgICAgdGhpcy5qdW1wU3VibWl0KDIpOwogICAgICB9CiAgICB9CiAgfSwKCiAgLyoqCiAgKiDpooblj5bmiJbogIXmiqLotK3npLzljIUKICAgICAgcmVzdHJpY3RTdGF0ZSAg5piv5ZCm5Y+v6LSt5Lmw77yaMeWQpiAy5pivCiAgICAgIHJlY2VpdmVUeXBlOiDlpJbpg6jmuKDpgZN7CiAgICAgICAg6LSt5Lmw77yaIDMKICAgICAgICDlhY3otLnpooY6ICAxCiAgICAgIH0KICAqLwogIGdldEdpZnQ6IGZ1bmN0aW9uIGdldEdpZnQoKSB7CiAgICB2YXIgdmlwVXNlciA9IHRoaXMudmlwQ2FyZEluZm8udmlwVXNlcjsKICAgIHZhciBpc25ld1VzZXIgPSB0aGlzLnJlYWxJbmZvLm5ld1VzZXI7CiAgICB2YXIgcGFja2FnZUdpZnRUeXBlID0gdGhpcy5pbmZvLnBhY2thZ2VHaWZ0VHlwZTsgLy8gMeWUruWNliAy5YWN6LS56aKGCgogICAgdmFyIGZyZWVSZWNlaXZlVHlwZSA9IHRoaXMuaW5mby5mcmVlUmVjZWl2ZVR5cGU7IC8vIDHmiYDmnInkurrlj6/pooblj5YgMuS7hemZkOaWsOeUqOaItyAz5LuF6ZmQ5Lya5ZGYIDTku4XpmZDpnZ7kvJrlkZgKCiAgICB2YXIgcmVzdHJpY3RTdGF0ZSA9IHRoaXMuaW5mby5yZXN0cmljdFN0YXRlOwogICAgdmFyIGNoYW5uZWxUcmFjayA9IHRoaXMuaW5mby5jaGFubmVsVHJhY2s7IC8vIOmAmui/h+i/meS4quWtl+aute+8jOWIpOaWreeUqHBhY2thZ2VHaWZ0VHlwZei/mOaYr3Jlc3RyaWN0U3RhdGXlrZfmrrUKCiAgICB2YXIganVtcFNhdGUgPSBmYWxzZTsgLy8g55So5p2l5Yik5pat5piv5ZCm5o+Q56S65LuF6ZmQ5p+Q55So5oi36aKG5Y+WCgogICAgaWYgKGZyZWVSZWNlaXZlVHlwZSA9PSAxKSB7CiAgICAgIC8vIOaJgOacieS6uuWPr+mihuWPlgogICAgICBqdW1wU2F0ZSA9IHRydWU7CiAgICB9IGVsc2UgaWYgKGZyZWVSZWNlaXZlVHlwZSA9PSAyICYmIGlzbmV3VXNlcikgewogICAgICAvLyDliKTmlq3nlKjmiLfmmK/lkKbkuLrmlrDnlKjmiLcKICAgICAganVtcFNhdGUgPSB0cnVlOwogICAgfSBlbHNlIGlmIChmcmVlUmVjZWl2ZVR5cGUgPT0gMyAmJiB2aXBVc2VyKSB7CiAgICAgIC8vIOWIpOaWreaYr+WQpuS7heS8muWRmOmihuWPlgogICAgICBqdW1wU2F0ZSA9IHRydWU7CiAgICB9IGVsc2UgaWYgKGZyZWVSZWNlaXZlVHlwZSA9PSA0ICYmICF2aXBVc2VyKSB7CiAgICAgIC8vIOWIpOaWreaYr+WQpuS7hemdnuS8muWRmOmihuWPlgogICAgICBqdW1wU2F0ZSA9IHRydWU7CiAgICB9IC8vIOWmguaenOaYr+W8gOmAmuW5tumihuWPlgoKCiAgICBpZiAodGhpcy5vcGVuX3JlY2VpdmUpIHsKICAgICAgdGhpcy4kc2V0KHRoaXMuaW5mbywgJ3NlbGxQcmljZScsIDApOwogICAgICB0aGlzLiRzZXQodGhpcy5pbmZvLCAnbm9WaXBQcmljZScsIDApOwogICAgfQoKICAgIHRoaXMuJHNhdmUuc2V0KCdzZXNzaW9uJywgJ29yZGVySW5mbycsIHRoaXMuaW5mbyk7CgogICAgaWYgKHRoaXMuaGFzRXhjaGFuZ2UgIT0gJycpIHsKICAgICAgLy8g5Yik5pat5YWR5aWW5Lit5b+D6L+b5YWlIOeri+WNs+WFkeaNogogICAgICB2YXIgY29uZGl0aW9uSW5mbyA9IHRoaXMuY29uZGl0aW9uSW5mbzsKICAgICAgdmFyIHRyYWN2ZWxVc2VyTGlzdCA9IHRoaXMudHJhY3ZlbFVzZXJMaXN0OwoKICAgICAgaWYgKGNvbmRpdGlvbkluZm8uaXNDb25kaXRpb24gJiYgdHJhY3ZlbFVzZXJMaXN0Lmxlbmd0aCA9PSAwKSB7CiAgICAgICAgLy8g5Yik5pat5piv5ZCm6ZyA5rGC5aGr5YaZ5L+h5oGvCiAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goewogICAgICAgICAgbmFtZTogJ3RyYXZlbEluZm9ybWF0aW9uJywKICAgICAgICAgIHF1ZXJ5OiB7CiAgICAgICAgICAgIGFjdFNuOiB0aGlzLm9wdGlvbnMuYWN0U24KICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICghdGhpcy5idG5EaXNhYmxlZCkgdGhpcy5leGNoYW5nZSgpOwogICAgfSBlbHNlIGlmICh0aGlzLmluZm8uY2hpbGRFbnVtS2V5ID09ICdBQ1RfR0lGVF9QQUNLQUdFX1BVUkNIQVNFX0xJTUlUJykgewogICAgICB0aGlzLmhhbmRsZXJMaW1pdEV2ZW50KCk7CiAgICB9IGVsc2UgaWYgKHRoaXMuaW5mby5hY3RTdGF0ZSA9PSAyKSB7CiAgICAgIC8vIOWIpOaWreaYr+WQpuaYr+S7juWklumDqOa4oOmBk+i/m+WFpe+8jOWklumDqOa4oOmBk+i/m+WFpeaXtu+8jOWmguaenOmFjee9rueUqOaIt+WPr+i0reS5sO+8jOmdnuS8muWRmOS5n+WPr+i0reS5sOekvOWMhQogICAgICB2YXIgYnV5TGltaXQgPSB0aGlzLmluZm8uYnV5TGltaXQ7CiAgICAgIHZhciBzZWxsUHJpY2UgPSB0aGlzLmluZm8uc2VsbFByaWNlOwogICAgICB2YXIgbm9WaXBQcmljZSA9IHRoaXMuaW5mby5ub1ZpcFByaWNlOwogICAgICB2YXIgYnV5U3RhdGUgPSBmYWxzZTsgLy8gIOaJgOacieS6uiAgIOS8miAwICAg6Z2eIDAKCiAgICAgIGlmIChidXlMaW1pdCA9PSAxICYmIG5vVmlwUHJpY2UgPT0gMCAmJiBzZWxsUHJpY2UgPT0gMCkgewogICAgICAgIGJ1eVN0YXRlID0gZmFsc2U7IC8vICDkvJrlkZjouqvku70KICAgICAgfSBlbHNlIGlmICh2aXBVc2VyICYmIHNlbGxQcmljZSA+IDApIHsKICAgICAgICBidXlTdGF0ZSA9IHRydWU7CiAgICAgIH0gZWxzZSBpZiAoIXZpcFVzZXIpIHsKICAgICAgICBidXlTdGF0ZSA9IGJ1eUxpbWl0ID09IDIgPyB0cnVlIDogbm9WaXBQcmljZSA+IDA7CiAgICAgIH0KCiAgICAgIGlmIChjaGFubmVsVHJhY2sgPyBwYWNrYWdlR2lmdFR5cGUgPT0gMSA6IHJlc3RyaWN0U3RhdGUgPT0gMikgewogICAgICAgIGlmIChidXlTdGF0ZSkgewogICAgICAgICAgLy8g6LSt5Lmw56S85YyFCiAgICAgICAgICAvLyDlpoLmnpzmmK/lpJbpg6jmuKDpgZPlubbkuJTmmK/pooblj5bnirbmgIHvvIxyZWNlaXZlVHlwZeS4ujTvvIzotK3kubDnirbmgIFyZWNlaXZlVHlwZeS4ujIKICAgICAgICAgIHZhciByZWNlaXZlVHlwZSA9IHRoaXMuY2hhbm5lbFR5cGUgPT0gJ0NIQU5ORUxfQUNUSVZJVFlfTEFCRUxfU0hPVycgJiYgdGhpcy5vcGVuX3JlY2VpdmUgPyA0IDogMjsKCiAgICAgICAgICBpZiAoYnV5TGltaXQgPT0gMiAmJiBzZWxsUHJpY2UgPT0gMCkgewogICAgICAgICAgICByZWNlaXZlVHlwZSA9IDE7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5vcmRlclVucGF5KHJlY2VpdmVUeXBlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8g5L2/55So5a2X5q61cmVzdHJpY3RTdGF0ZeWIpOaWrQogICAgICAgICAgdGhpcy5yZWNlaXZlR2lmdCg0KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoY2hhbm5lbFRyYWNrID8gcGFja2FnZUdpZnRUeXBlID09IDIgOiByZXN0cmljdFN0YXRlID09IDEpIHsKICAgICAgICAvLyDlhY3otLnpooYKICAgICAgICBpZiAoY2hhbm5lbFRyYWNrKSB7CiAgICAgICAgICAvLyDkvb/nlKjlrZfmrrVwYWNrYWdlR2lmdFR5cGXliKTmlq0KICAgICAgICAgIGlmIChmcmVlUmVjZWl2ZVR5cGUgIT0gMSAmJiAhanVtcFNhdGUpIHsKICAgICAgICAgICAgdGhpcy4kVG9hc3QoIlx1NEVDNVx1OTY1MCIuY29uY2F0KHRoaXMucmVjZWl2ZU9ialtmcmVlUmVjZWl2ZVR5cGVdLCAiXHU5ODg2XHU1M0Q2IikpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5yZWNlaXZlR2lmdCg0KTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8g5L2/55So5a2X5q61cmVzdHJpY3RTdGF0ZeWIpOaWrQogICAgICAgICAgdGhpcy5yZWNlaXZlR2lmdCg0KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LAogIC8vIOWFkeaNogogIGV4Y2hhbmdlOiBmdW5jdGlvbiBleGNoYW5nZSgpIHsKICAgIHZhciBfdGhpczggPSB0aGlzOwoKICAgIHZhciBpdGVtID0gdGhpcy5leGNoYW5nZV9kYXRhOwogICAgdGhpcy4kZGlhbG9nLmNvbmZpcm0oewogICAgICB0aXRsZTogIlx1NjYyRlx1NTQyNlx1Nzg2RVx1OEJBNFx1NTE1MVx1NjM2MiIuY29uY2F0KGl0ZW0uYWN0TmFtZSB8fCAnJywgIj8iKSwKICAgICAgbWVzc2FnZTogJ+WFkeaNouWQjuS4jeWPr+abtOaUueS4lOWOn+aciea9ruWNoeWwhuS8mua4heepuicKICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICBfdGhpczgucHJpY2VFeGNoYW5nZShpdGVtKTsKICAgIH0pLmNhdGNoKGZ1bmN0aW9uICgpIHsvLyBvbiBjYW5jZWwKICAgIH0pOwogIH0sCiAgLy8g5byA5aeL5YWR5o2iCiAgcHJpY2VFeGNoYW5nZTogZnVuY3Rpb24gcHJpY2VFeGNoYW5nZShpdGVtKSB7CiAgICB2YXIgX3RoaXM5ID0gdGhpczsKCiAgICBpZiAodGhpcy5jYW5DbGljaykgcmV0dXJuOwogICAgdGhpcy5jYW5DbGljayA9IHRydWU7CiAgICB0aGlzLiRhcGkucHJpY2VfZXhjaGFuZ2UoewogICAgICBhY3RTbjogaXRlbS5hY3RTbiwKICAgICAgYXdhcmRJZDogaXRlbS5hd2FyZElkLAogICAgICBjaXR5SWQ6IHRoaXMubG9jYXRpb25DaXR5LmNpdHlJZCwKICAgICAgY2hvb3NlRGF0ZTogdGhpcy5zZWxEYXRlLnN0YXJ0VGltZSA/IHV0aWxzLmZvcm1hdFRpbWUodGhpcy5zZWxEYXRlLnN0YXJ0VGltZSB8fCAwLCAnWVlZWU1NREQnKSA6IDAsCiAgICAgIC8vIOiHquaIkea4uOmAieaLqeaXtumXtAogICAgICB0cmFjdmVsVXNlckxpc3Q6IEpTT04uc3RyaW5naWZ5KHRoaXMudHJhY3ZlbFVzZXJMaXN0KQogICAgfSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgIGlmIChyZXMuc3RhdGUpIHsKICAgICAgICBfdGhpczkubWFzayA9IHRydWU7CgogICAgICAgIF90aGlzOS5oYW5kbGVyQnRuKCflt7LlhZHmjaInLCB0cnVlKTsgLy8g5riF6Zmk55So5oi35aGr5YaZ5L+h5oGvCgoKICAgICAgICBfdGhpczkuJHNhdmUucmVtb3ZlKCdzZXNzaW9uJywgJ3RyYXZlbEluZm9ybWF0aW9uJyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgX3RoaXM5LiRUb2FzdChyZXMubWVzc2FnZSk7CiAgICAgIH0KICAgIH0pLmZpbmFsbHkoZnVuY3Rpb24gKCkgewogICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczkuY2FuQ2xpY2sgPSBmYWxzZTsKICAgICAgfSwgMzAwKTsKICAgIH0pOwogIH0sCiAgZ29DYXJkOiBmdW5jdGlvbiBnb0NhcmQoKSB7CiAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgIG5hbWU6ICdjb3Vwb25MaXN0JwogICAgfSk7CiAgfSwKICBjbG9zZTogZnVuY3Rpb24gY2xvc2UoKSB7CiAgICB0aGlzLm1hc2sgPSBmYWxzZTsKICB9LAogIC8vIOiOt+WPluS8muWRmOWNoeacgOS9juS7t+agvAogIHZpcFByaWNlOiBmdW5jdGlvbiB2aXBQcmljZSgpIHsKICAgIHZhciBfdGhpczEwID0gdGhpczsKCiAgICB0aGlzLiRhcGkubG93X3ByaWNlKHt9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgaWYgKHJlcy5zdGF0ZSkgewogICAgICAgIF90aGlzMTAubG93UHJpY2UgPSByZXMuaW5mby5sb3dQcmljZTsKICAgICAgfQogICAgfSk7CiAgfSwKICBzaG93T3JkZXJUaXA6IGZ1bmN0aW9uIHNob3dPcmRlclRpcCgpIHsKICAgIHRoaXMuJGRpYWxvZy5hbGVydCh7CiAgICAgIHRpdGxlOiAn5o+Q56S6JywKICAgICAgbWVzc2FnZTogJ+iuouWNlei2heaXtuW3suWPlua2iO+8jOivt+mHjeaWsOS4i+WNlScsCiAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn56Gu5a6aJywKICAgICAgY29uZmlybUJ1dHRvbkNvbG9yOiAnI0Q5MDYzNCcKICAgIH0pOwogIH0sCiAgdG9Kb2luOiBmdW5jdGlvbiB0b0pvaW4oKSB7CiAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgIG5hbWU6ICdqb2luVmlwJywKICAgICAgcXVlcnk6IHsKICAgICAgICBjaGFubmVsVHlwZTogdGhpcy5jaGFubmVsVHlwZQogICAgICB9CiAgICB9KTsKICB9LAogIC8vIOWFs+mXree6ouWMheWIl+ihqAogIGNvbHNlY2FzaE1hc2s6IGZ1bmN0aW9uIGNvbHNlY2FzaE1hc2soKSB7CiAgICB0aGlzLmNhc2hNYXNrID0gIXRoaXMuY2FzaE1hc2s7CiAgfSwKICAvLyDojrflj5bmtLvliqjnuqLljIXlvZPliY3kuqvnlKjmnIDlpKfnuqLljIUKICBnZXRDYXNoTnVtOiBmdW5jdGlvbiBnZXRDYXNoTnVtKCkgewogICAgdmFyIF90aGlzMTEgPSB0aGlzOwoKICAgIHZhciB2aXBfY2hlY2sgPSAhdGhpcy52aXBVc2VyICYmIHRoaXMuaW5mby5idXlMaW1pdCA9PSAyID8gdHJ1ZSA6IGZhbHNlOwogICAgdmFyIHByaWNlID0gdGhpcy5pbmZvLmJ1eUxpbWl0ID09IDIgfHwgdGhpcy52aXBVc2VyID8gdGhpcy5pbmZvLnNlbGxQcmljZSA6IHRoaXMuaW5mby5ub1ZpcFByaWNlOwogICAgdGhpcy4kYXBpLmNhc2hfcmVkX2xpc3QoewogICAgICBhY3RTbjogdGhpcy5hY3RTbiwKICAgICAgY2l0eUlkOiB0aGlzLmxvY2F0aW9uQ2l0eS5jaXR5SWQsCiAgICAgIG9wZW5WaXA6IHZpcF9jaGVjaywKICAgICAgLy8g5piv5ZCm5Yu+6YCJ5Lya5ZGY5Y2hCiAgICAgIHZpcEZlZTogdmlwX2NoZWNrID8gdGhpcy5sb3dQcmljZSA6IDAsCiAgICAgIC8vIOS8muWRmOWNoemHkeminQogICAgICBhY3RGZWU6IHByaWNlLAogICAgICAvLyDmtLvliqjph5Hpop0KICAgICAgY2FyZElkOiAiIiAvLyDnibnljZbljaHliLhpZCB8fCDnpLzljIXkvKDnqboKCiAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgaWYgKHJlcy5zdGF0ZSkgewogICAgICAgIHZhciByZWRMaXN0ID0gcmVzLmluZm8uY2FzaFJlZExpc3QgfHwgW107CiAgICAgICAgdmFyIGNvbnN1bWVyQ291cG9uTGlzdCA9IHJlcy5pbmZvLmNvbnN1bWVyQ291cG9uTGlzdCB8fCBbXTsKICAgICAgICB2YXIgdXNhYmxlTGlzdCA9IHJlZExpc3QuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICByZXR1cm4gaXRlbS5jdXJyZW50QWJsZVVzZTsKICAgICAgICB9KTsgLy8g6L+H5ruk5Y+v55So57qi5YyFCgogICAgICAgIHZhciBzb3J0VXNhYmxlTGlzdCA9IHVzYWJsZUxpc3Quc29ydChmdW5jdGlvbiAoYSwgYikgewogICAgICAgICAgLy8g6ZmN5bqP5o6S5bqPCiAgICAgICAgICByZXR1cm4gYi5tb25leSAtIGEubW9uZXk7CiAgICAgICAgfSk7CiAgICAgICAgX3RoaXMxMS5zZWxDYXNocmVkID0gc29ydFVzYWJsZUxpc3RbMF0gfHwge307IC8vIOmAieS4reacgOWkp+e6ouWMhQoKICAgICAgICBpZiAoY29uc3VtZXJDb3Vwb25MaXN0Lmxlbmd0aCkgewogICAgICAgICAgX3RoaXMxMS5zZWxDb25zdW1lciA9IGNvbnN1bWVyQ291cG9uTGlzdFswXSB8fCB7fTsgLy8g6YCJ5Lit5raI6LS55Yi4CiAgICAgICAgfQogICAgICB9CiAgICB9KS5maW5hbGx5KGZ1bmN0aW9uICgpIHt9KTsKICB9LAogIGhhc0NhY2hSZWRMaXN0OiBmdW5jdGlvbiBoYXNDYWNoUmVkTGlzdChfcmVmMikgewogICAgdmFyIGRldGFpbCA9IF9yZWYyLmRldGFpbDsKCiAgICBpZiAoZGV0YWlsICYmIGRldGFpbC5sZW5ndGggPiAwKSB7CiAgICAgIC8vIOmHjeaWsOivt+axgue6ouWMheaOpeWPowogICAgICB0aGlzLnNlbGVjdENvbXBvbmVudCgnI2FjdGl2ZUNhc2gnKS5nZXRDYXNoTGlzdCgpOwogICAgICB0aGlzLmdldENhc2hOdW0oKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuc2hvd1BhZ2VNb2RlbCA9IHRydWU7CiAgICB9CiAgfQp9LCAiZ2V0R2lmdCIsIGZ1bmN0aW9uIGdldEdpZnQoKSB7CiAgdmFyIHZpcFVzZXIgPSB0aGlzLnZpcENhcmRJbmZvLnZpcFVzZXI7CiAgdmFyIGlzbmV3VXNlciA9IHRoaXMucmVhbEluZm8ubmV3VXNlcjsKICB2YXIgcGFja2FnZUdpZnRUeXBlID0gdGhpcy5pbmZvLnBhY2thZ2VHaWZ0VHlwZTsgLy8gMeWUruWNliAy5YWN6LS56aKGCgogIHZhciBmcmVlUmVjZWl2ZVR5cGUgPSB0aGlzLmluZm8uZnJlZVJlY2VpdmVUeXBlOyAvLyAx5omA5pyJ5Lq65Y+v6aKG5Y+WIDLku4XpmZDmlrDnlKjmiLcgM+S7hemZkOS8muWRmCA05LuF6ZmQ6Z2e5Lya5ZGYCgogIHZhciByZXN0cmljdFN0YXRlID0gdGhpcy5pbmZvLnJlc3RyaWN0U3RhdGU7CiAgdmFyIGNoYW5uZWxUcmFjayA9IHRoaXMuaW5mby5jaGFubmVsVHJhY2s7IC8vIOmAmui/h+i/meS4quWtl+aute+8jOWIpOaWreeUqHBhY2thZ2VHaWZ0VHlwZei/mOaYr3Jlc3RyaWN0U3RhdGXlrZfmrrUKCiAgdmFyIGp1bXBTYXRlID0gZmFsc2U7IC8vIOeUqOadpeWIpOaWreaYr+WQpuaPkOekuuS7hemZkOafkOeUqOaIt+mihuWPlgoKICBpZiAoZnJlZVJlY2VpdmVUeXBlID09IDEpIHsKICAgIC8vIOaJgOacieS6uuWPr+mihuWPlgogICAganVtcFNhdGUgPSB0cnVlOwogIH0gZWxzZSBpZiAoZnJlZVJlY2VpdmVUeXBlID09IDIgJiYgaXNuZXdVc2VyKSB7CiAgICAvLyDliKTmlq3nlKjmiLfmmK/lkKbkuLrmlrDnlKjmiLcKICAgIGp1bXBTYXRlID0gdHJ1ZTsKICB9IGVsc2UgaWYgKGZyZWVSZWNlaXZlVHlwZSA9PSAzICYmIHZpcFVzZXIpIHsKICAgIC8vIOWIpOaWreaYr+WQpuS7heS8muWRmOmihuWPlgogICAganVtcFNhdGUgPSB0cnVlOwogIH0gZWxzZSBpZiAoZnJlZVJlY2VpdmVUeXBlID09IDQgJiYgIXZpcFVzZXIpIHsKICAgIC8vIOWIpOaWreaYr+WQpuS7hemdnuS8muWRmOmihuWPlgogICAganVtcFNhdGUgPSB0cnVlOwogIH0gLy8g5aaC5p6c5piv5byA6YCa5bm26aKG5Y+WCgoKICBpZiAodGhpcy5vcGVuX3JlY2VpdmUpIHsKICAgIHRoaXMuJHNldCh0aGlzLmluZm8sICdzZWxsUHJpY2UnLCAwKTsKICAgIHRoaXMuJHNldCh0aGlzLmluZm8sICdub1ZpcFByaWNlJywgMCk7CiAgfQoKICB0aGlzLiRzYXZlLnNldCgnc2Vzc2lvbicsICdvcmRlckluZm8nLCB0aGlzLmluZm8pOwoKICBpZiAodGhpcy5oYXNFeGNoYW5nZSAhPSAnJykgewogICAgLy8g5Yik5pat5YWR5aWW5Lit5b+D6L+b5YWlIOeri+WNs+WFkeaNogogICAgdmFyIGNvbmRpdGlvbkluZm8gPSB0aGlzLmNvbmRpdGlvbkluZm87CiAgICB2YXIgdHJhY3ZlbFVzZXJMaXN0ID0gdGhpcy50cmFjdmVsVXNlckxpc3Q7CgogICAgaWYgKGNvbmRpdGlvbkluZm8uaXNDb25kaXRpb24gJiYgdHJhY3ZlbFVzZXJMaXN0Lmxlbmd0aCA9PSAwKSB7CiAgICAgIC8vIOWIpOaWreaYr+WQpumcgOaxguWhq+WGmeS/oeaBrwogICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgbmFtZTogJ3RyYXZlbEluZm9ybWF0aW9uJywKICAgICAgICBxdWVyeTogewogICAgICAgICAgYWN0U246IHRoaXMub3B0aW9ucy5hY3RTbgogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAoIXRoaXMuYnRuRGlzYWJsZWQpIHRoaXMuZXhjaGFuZ2UoKTsKICB9IGVsc2UgaWYgKHRoaXMuaW5mby5jaGlsZEVudW1LZXkgPT0gJ0FDVF9HSUZUX1BBQ0tBR0VfUFVSQ0hBU0VfTElNSVQnKSB7CiAgICB0aGlzLmhhbmRsZXJMaW1pdEV2ZW50KCk7CiAgfSBlbHNlIGlmICh0aGlzLmluZm8uYWN0U3RhdGUgPT0gMikgewogICAgLy8g5Yik5pat5piv5ZCm5piv5LuO5aSW6YOo5rig6YGT6L+b5YWl77yM5aSW6YOo5rig6YGT6L+b5YWl5pe277yM5aaC5p6c6YWN572u55So5oi35Y+v6LSt5Lmw77yM6Z2e5Lya5ZGY5Lmf5Y+v6LSt5Lmw56S85YyFCiAgICB2YXIgYnV5TGltaXQgPSB0aGlzLmluZm8uYnV5TGltaXQ7CiAgICB2YXIgc2VsbFByaWNlID0gdGhpcy5pbmZvLnNlbGxQcmljZTsKICAgIHZhciBub1ZpcFByaWNlID0gdGhpcy5pbmZvLm5vVmlwUHJpY2U7CiAgICB2YXIgYnV5U3RhdGUgPSBmYWxzZTsgLy8gIOaJgOacieS6uiAgIOS8miAwICAg6Z2eIDAKCiAgICBpZiAoYnV5TGltaXQgPT0gMSAmJiBub1ZpcFByaWNlID09IDAgJiYgc2VsbFByaWNlID09IDApIHsKICAgICAgYnV5U3RhdGUgPSBmYWxzZTsgLy8gIOS8muWRmOi6q+S7vQogICAgfSBlbHNlIGlmICh2aXBVc2VyICYmIHNlbGxQcmljZSA+IDApIHsKICAgICAgYnV5U3RhdGUgPSB0cnVlOwogICAgfSBlbHNlIGlmICghdmlwVXNlcikgewogICAgICBidXlTdGF0ZSA9IGJ1eUxpbWl0ID09IDIgPyB0cnVlIDogbm9WaXBQcmljZSA+IDA7CiAgICB9CgogICAgaWYgKGNoYW5uZWxUcmFjayA/IHBhY2thZ2VHaWZ0VHlwZSA9PSAxIDogcmVzdHJpY3RTdGF0ZSA9PSAyKSB7CiAgICAgIGlmIChidXlTdGF0ZSkgewogICAgICAgIC8vIOi0reS5sOekvOWMhQogICAgICAgIC8vIOWmguaenOaYr+WklumDqOa4oOmBk+W5tuS4lOaYr+mihuWPlueKtuaAge+8jHJlY2VpdmVUeXBl5Li6NO+8jOi0reS5sOeKtuaAgXJlY2VpdmVUeXBl5Li6MgogICAgICAgIHZhciByZWNlaXZlVHlwZSA9IHRoaXMuY2hhbm5lbFR5cGUgPT0gJ0NIQU5ORUxfQUNUSVZJVFlfTEFCRUxfU0hPVycgJiYgdGhpcy5vcGVuX3JlY2VpdmUgPyA0IDogMjsKCiAgICAgICAgaWYgKGJ1eUxpbWl0ID09IDIgJiYgc2VsbFByaWNlID09IDApIHsKICAgICAgICAgIHJlY2VpdmVUeXBlID0gMTsKICAgICAgICB9CgogICAgICAgIHRoaXMub3JkZXJVbnBheShyZWNlaXZlVHlwZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8g5L2/55So5a2X5q61cmVzdHJpY3RTdGF0ZeWIpOaWrQogICAgICAgIHRoaXMucmVjZWl2ZUdpZnQoNCk7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAoY2hhbm5lbFRyYWNrID8gcGFja2FnZUdpZnRUeXBlID09IDIgOiByZXN0cmljdFN0YXRlID09IDEpIHsKICAgICAgLy8g5YWN6LS56aKGCiAgICAgIGlmIChjaGFubmVsVHJhY2spIHsKICAgICAgICAvLyDkvb/nlKjlrZfmrrVwYWNrYWdlR2lmdFR5cGXliKTmlq0KICAgICAgICBpZiAoZnJlZVJlY2VpdmVUeXBlICE9IDEgJiYgIWp1bXBTYXRlKSB7CiAgICAgICAgICB0aGlzLiRUb2FzdCgiXHU0RUM1XHU5NjUwIi5jb25jYXQodGhpcy5yZWNlaXZlT2JqW2ZyZWVSZWNlaXZlVHlwZV0sICJcdTk4ODZcdTUzRDYiKSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMucmVjZWl2ZUdpZnQoNCk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vIOS9v+eUqOWtl+autXJlc3RyaWN0U3RhdGXliKTmlq0KICAgICAgICB0aGlzLnJlY2VpdmVHaWZ0KDQpOwogICAgICB9CiAgICB9CiAgfQp9KSkpLCBfZGVmaW5lUHJvcGVydHkoX25hbWUkbWl4aW5zJGNvbXB1dGVkLCAiY3JlYXRlZCIsIGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgdmFyIF90aGlzMTIgPSB0aGlzOwoKICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMigpIHsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIF90aGlzMTIub3B0aW9ucyA9IF90aGlzMTIuJHJvdXRlLnF1ZXJ5OwogICAgICAgICAgICBfdGhpczEyLmFjdFNuID0gX3RoaXMxMi5vcHRpb25zLmFjdFNuOwogICAgICAgICAgICBfdGhpczEyLnFyQ29kZSA9IF90aGlzMTIub3B0aW9ucy5xckNvZGUgfHwgJyc7CiAgICAgICAgICAgIF90aGlzMTIuY2hhbm5lbFR5cGUgPSBfdGhpczEyLm9wdGlvbnMuY2hhbm5lbFR5cGUgfHwgJyc7CiAgICAgICAgICAgIF90aGlzMTIuY29tcElkID0gX3RoaXMxMi5vcHRpb25zLmNvbXBJZCB8fCAnJzsKICAgICAgICAgICAgX3RoaXMxMi5oYXNFeGNoYW5nZSA9IF90aGlzMTIub3B0aW9ucy5oYXNFeGNoYW5nZSB8fCAnJzsKICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA4OwogICAgICAgICAgICByZXR1cm4gX3RoaXMxMi5nZXRSZWFsVGltZUluZm8oKTsKCiAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgIGlmIChfdGhpczEyLm9wdGlvbnMucG9wdXApIHsKICAgICAgICAgICAgICBfdGhpczEyLnNob3dPcmRlclRpcCgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoX3RoaXMxMi5oYXNFeGNoYW5nZSAhPSAiIikgewogICAgICAgICAgICAgIC8vIOWIpOaWreS4uuWFkeaNouS4reW/g+i/m+WFpQogICAgICAgICAgICAgIF90aGlzMTIuZXhjaGFuZ2VfZGF0YSA9IF90aGlzMTIuJHNhdmUuZ2V0KCdzZXNzaW9uJywgJ2V4Y2hhbmdlX2RhdGEnKTsgLy8g5YWR5o2i5Lit5b+D5rS75Yqo5pWw5o2uCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF90aGlzMTIuZ2V0UmVjZWl2ZUNvbmRpdGlvbigpOyAvLyDmmK/lkKbpnIDopoHloavlhpnnlKjmiLfkv6Hmga/lj4rlhbbmnaHku7YKCgogICAgICAgICAgICBfdGhpczEyLnZpcFByaWNlKCk7CgogICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDE0OwogICAgICAgICAgICByZXR1cm4gX3RoaXMxMi5nZXRHaWZ0SW5mbygpOwoKICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTY7CiAgICAgICAgICAgIHJldHVybiBfdGhpczEyLmdldEFjdERldGFpbCh0cnVlKTsKCiAgICAgICAgICBjYXNlIDE2OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlMik7CiAgfSkpKCk7Cn0pLCBfbmFtZSRtaXhpbnMkY29tcHV0ZWQpOw=="},null]}