{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\src\\components\\common\\common\\uploadImg.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\src\\components\\common\\common\\uploadImg.vue","mtime":1597889072411},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubnVtYmVyLmNvbnN0cnVjdG9yIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiQzovVXNlcnMvQWRtaW5pc3RyYXRvci9EZXNrdG9wL3ZpcF9pbmxpbmVfaDUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgZ2V0V1hTaWduIGZyb20gJ0AvdXRpbHMvd3gnOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ3VwbG9hZEltZycsCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgICR3eDoge30KICAgIH07CiAgfSwKICBwcm9wczogewogICAgaW1nczogewogICAgICB0eXBlOiBBcnJheQogICAgfSwKICAgIHVwbG9hZEltZ051bTogewogICAgICB0eXBlOiBOdW1iZXIsCiAgICAgIGRlZmF1bHQ6IDEKICAgIH0KICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMDsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzsKICAgICAgICAgICAgICByZXR1cm4gZ2V0V1hTaWduKCk7CgogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgX3RoaXMuJHd4ID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gOTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gNjsKICAgICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDApOwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKF9jb250ZXh0LnQwKTsKCiAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZSwgbnVsbCwgW1swLCA2XV0pOwogICAgfSkpKCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBjaG9vc2VJbWc6IGZ1bmN0aW9uIGNob29zZUltZygpIHsKICAgICAgdmFyIHRoYXQgPSB0aGlzOwogICAgICB2YXIgY291bnQgPSB0aGlzLnVwbG9hZEltZ051bSB8fCAxOwogICAgICBjb3VudCA9IGNvdW50IC0gdGhpcy5pbWdzLmxlbmd0aDsKICAgICAgdGhpcy4kd3guY2hvb3NlSW1hZ2UoewogICAgICAgIGNvdW50OiBjb3VudCwKICAgICAgICAvLyDpu5jorqQ5CiAgICAgICAgc2l6ZVR5cGU6IFsib3JpZ2luYWwiLCAiY29tcHJlc3NlZCJdLAogICAgICAgIC8vIOWPr+S7peaMh+WumuaYr+WOn+Wbvui/mOaYr+WOi+e8qeWbvu+8jOm7mOiupOS6jOiAhemDveaciQogICAgICAgIHNvdXJjZVR5cGU6IFsiYWxidW0iLCAiY2FtZXJhIl0sCiAgICAgICAgLy8g5Y+v5Lul5oyH5a6a5p2l5rqQ5piv55u45YaM6L+Y5piv55u45py677yM6buY6K6k5LqM6ICF6YO95pyJCiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gc3VjY2VzcyhyZXMpIHsKICAgICAgICAgIHZhciBsb2NhbElkcyA9IHJlcy5sb2NhbElkczsgLy8g6L+U5Zue6YCJ5a6a54Wn54mH55qE5pys5ZywSUTliJfooajvvIxsb2NhbElk5Y+v5Lul5L2c5Li6aW1n5qCH562+55qEc3Jj5bGe5oCn5pi+56S65Zu+54mHCgogICAgICAgICAgdmFyIGkgPSAwLAogICAgICAgICAgICAgIGxlbiA9IGxvY2FsSWRzLmxlbmd0aDsKCiAgICAgICAgICBmdW5jdGlvbiB1cGxvYWQoKSB7CiAgICAgICAgICAgIHRoYXQuJHd4LnVwbG9hZEltYWdlKHsKICAgICAgICAgICAgICBsb2NhbElkOiBsb2NhbElkc1tpXSwKICAgICAgICAgICAgICAvLyDpnIDopoHkuIrkvKDnmoTlm77niYfnmoTmnKzlnLBJRO+8jOeUsWNob29zZUltYWdl5o6l5Y+j6I635b6XCiAgICAgICAgICAgICAgaXNTaG93UHJvZ3Jlc3NUaXBzOiAxLAogICAgICAgICAgICAgIC8vIOm7mOiupOS4ujHvvIzmmL7npLrov5vluqbmj5DnpLoKICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiBzdWNjZXNzKHJlcykgewogICAgICAgICAgICAgICAgaSsrOwoKICAgICAgICAgICAgICAgIGlmIChpIDwgbGVuKSB7CiAgICAgICAgICAgICAgICAgIHVwbG9hZCgpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHZhciBzZXJ2ZXJJZCA9IHJlcy5zZXJ2ZXJJZDsgLy8g6L+U5Zue5Zu+54mH55qE5pyN5Yqh5Zmo56uvSUTljbNtZWRpYV9pZOWwhuasoWlk5Lyg57uZ5ZCO5Y+w77yM54S25ZCO6L+U5Zueb3Nz5Zu+54mH5Zyw5Z2ACgogICAgICAgICAgICAgICAgdGhhdC4kYXBpLmRvd25sb2FkSW1hZ2UoewogICAgICAgICAgICAgICAgICBtZWRpYUlkOiBzZXJ2ZXJJZAogICAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgICAgIGlmIChyZXMuc3RhdGUpIHsKICAgICAgICAgICAgICAgICAgICB0aGF0LmltZ3MucHVzaChyZXMuaW5mby5tZWRpYVVybCk7IC8vIOmqjOivgeWbvueJh+aVj+aEnwoKICAgICAgICAgICAgICAgICAgICB0aGF0LiRlbWl0KCd1cGRhdGU6aW1ncycsIHRoYXQuaW1ncyk7CiAgICAgICAgICAgICAgICAgICAgdGhhdC4kVG9hc3QoIlx1NEUwQVx1NEYyMFx1NjIxMFx1NTI5RiIpOwogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHRoYXQuJFRvYXN0KHJlcy5tZXNzYWdlKTsKICAgICAgICAgICAgICAgICAgICB0aGF0LiRlbWl0KCdpbWdFcnJvcicsIHJlcy5tZXNzYWdlKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KCiAgICAgICAgICB1cGxvYWQoKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0KfTs="},{"version":3,"sources":["uploadImg.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAcA,OAAA,SAAA,MAAA,YAAA;AACA,eAAA;AACA,EAAA,IAAA,EAAA,WADA;AAEA,EAAA,IAFA,kBAEA;AACA,WAAA;AACA,MAAA,GAAA,EAAA;AADA,KAAA;AAGA,GANA;AAOA,EAAA,KAAA,EAAA;AACA,IAAA,IAAA,EAAA;AACA,MAAA,IAAA,EAAA;AADA,KADA;AAIA,IAAA,YAAA,EAAA;AACA,MAAA,IAAA,EAAA,MADA;AAEA,MAAA,OAAA,EAAA;AAFA;AAJA,GAPA;AAgBA,EAAA,OAhBA,qBAgBA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAEA,SAAA,EAFA;;AAAA;AAEA,cAAA,KAAA,CAAA,GAFA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAIA,cAAA,OAAA,CAAA,GAAA;;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA,GAtBA;AAuBA,EAAA,OAAA,EAAA;AACA,IAAA,SADA,uBACA;AACA,UAAA,IAAA,GAAA,IAAA;AACA,UAAA,KAAA,GAAA,KAAA,YAAA,IAAA,CAAA;AACA,MAAA,KAAA,GAAA,KAAA,GAAA,KAAA,IAAA,CAAA,MAAA;AACA,WAAA,GAAA,CAAA,WAAA,CAAA;AACA,QAAA,KAAA,EAAA,KADA;AACA;AACA,QAAA,QAAA,EAAA,CAAA,UAAA,EAAA,YAAA,CAFA;AAEA;AACA,QAAA,UAAA,EAAA,CAAA,OAAA,EAAA,QAAA,CAHA;AAGA;AACA,QAAA,OAAA,EAAA,iBAAA,GAAA,EAAA;AACA,cAAA,QAAA,GAAA,GAAA,CAAA,QAAA,CADA,CACA;;AACA,cAAA,CAAA,GAAA,CAAA;AAAA,cACA,GAAA,GAAA,QAAA,CAAA,MADA;;AAEA,mBAAA,MAAA,GAAA;AACA,YAAA,IAAA,CAAA,GAAA,CAAA,WAAA,CAAA;AACA,cAAA,OAAA,EAAA,QAAA,CAAA,CAAA,CADA;AACA;AACA,cAAA,kBAAA,EAAA,CAFA;AAEA;AACA,cAAA,OAAA,EAAA,iBAAA,GAAA,EAAA;AACA,gBAAA,CAAA;;AACA,oBAAA,CAAA,GAAA,GAAA,EAAA;AACA,kBAAA,MAAA;AACA;;AACA,oBAAA,QAAA,GAAA,GAAA,CAAA,QAAA,CALA,CAKA;;AACA,gBAAA,IAAA,CAAA,IAAA,CAAA,aAAA,CAAA;AACA,kBAAA,OAAA,EAAA;AADA,iBAAA,EAEA,IAFA,CAEA,UAAA,GAAA,EAAA;AACA,sBAAA,GAAA,CAAA,KAAA,EAAA;AACA,oBAAA,IAAA,CAAA,IAAA,CAAA,IAAA,CAAA,GAAA,CAAA,IAAA,CAAA,QAAA,EADA,CAEA;;AACA,oBAAA,IAAA,CAAA,KAAA,CAAA,aAAA,EAAA,IAAA,CAAA,IAAA;AACA,oBAAA,IAAA,CAAA,MAAA;AACA,mBALA,MAKA;AACA,oBAAA,IAAA,CAAA,MAAA,CAAA,GAAA,CAAA,OAAA;AACA,oBAAA,IAAA,CAAA,KAAA,CAAA,UAAA,EAAA,GAAA,CAAA,OAAA;AACA;AACA,iBAZA;AAaA;AAtBA,aAAA;AAwBA;;AACA,UAAA,MAAA;AACA;AAnCA,OAAA;AAqCA;AA1CA;AAvBA,CAAA","sourcesContent":["<!--\r\n * @Description: \r\n * @Version: 1.0\r\n * @Autor: yesong\r\n * @Date: 2020-08-03 20:49:17\r\n * @LastEditors: yesong\r\n * @LastEditTime: 2020-08-08 16:54:23\r\n--> \r\n<template>\r\n  <div @click=\"chooseImg\">\r\n    <slot name=\"uploadImg\"></slot>\r\n  </div>\r\n</template>\r\n<script>\r\n  import getWXSign from '@/utils/wx'\r\n  export default {\r\n    name: 'uploadImg',\r\n    data() {\r\n      return {\r\n        $wx: {}\r\n      }\r\n    },\r\n    props: {\r\n      imgs: {\r\n        type: Array\r\n      },\r\n      uploadImgNum: {\r\n        type: Number,\r\n        default: 1\r\n      }\r\n    },\r\n    async created() {\r\n      try {\r\n        this.$wx = await getWXSign()\r\n      } catch (error) {\r\n        console.log(error)\r\n      }\r\n    },\r\n    methods: {\r\n      chooseImg() {\r\n        var that = this;\r\n        let count = this.uploadImgNum || 1;\r\n            count = count - this.imgs.length\r\n        this.$wx.chooseImage({\r\n          count: count, // 默认9\r\n          sizeType: [\"original\", \"compressed\"], // 可以指定是原图还是压缩图，默认二者都有\r\n          sourceType: [\"album\", \"camera\"], // 可以指定来源是相册还是相机，默认二者都有\r\n          success: function(res) {\r\n            var localIds = res.localIds; // 返回选定照片的本地ID列表，localId可以作为img标签的src属性显示图片\r\n            var i = 0,\r\n              len = localIds.length;\r\n            function upload() {\r\n              that.$wx.uploadImage({\r\n                localId: localIds[i], // 需要上传的图片的本地ID，由chooseImage接口获得\r\n                isShowProgressTips: 1, // 默认为1，显示进度提示\r\n                success: function(res) {\r\n                  i++;\r\n                  if (i < len) {\r\n                    upload();\r\n                  }\r\n                  var serverId = res.serverId; // 返回图片的服务器端ID即media_id将次id传给后台，然后返回oss图片地址\r\n                  that.$api.downloadImage({\r\n                    mediaId: serverId\r\n                  }).then(res => {\r\n                    if (res.state) {\r\n                      that.imgs.push(res.info.mediaUrl)\r\n                      // 验证图片敏感\r\n                      that.$emit('update:imgs', that.imgs)\r\n                      that.$Toast(`上传成功`)\r\n                    } else {\r\n                      that.$Toast(res.message)\r\n                      that.$emit('imgError', res.message)\r\n                    }\r\n                  });\r\n                }\r\n              });\r\n            }\r\n            upload();\r\n          }\r\n        });\r\n      }\r\n    }\r\n  }\r\n</script>\r\n<style lang=\"less\" scoped>\r\n\r\n</style>\r\n\r\n\r\n"],"sourceRoot":"src/components/common/common"}]}