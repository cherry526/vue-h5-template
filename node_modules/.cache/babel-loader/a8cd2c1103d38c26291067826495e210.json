{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\src\\views\\active\\activeCoupon.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\src\\views\\active\\activeCoupon.vue","mtime":1596796726566},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKCJDOi9Vc2Vycy9BZG1pbmlzdHJhdG9yL0Rlc2t0b3AvdmlwX2lubGluZV9oNS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHQiKTsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwOwoKdmFyIF92dWV4ID0gcmVxdWlyZSgidnVleCIpOwoKdmFyIF9hY3RpdmVCcmFuZCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiQGNvbXBvbmVudHMvYWN0aXZlL2FjdGl2ZUJyYW5kIikpOwoKdmFyIF9hY3RpdmVOb3RpY2UgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIkBjb21wb25lbnRzL2FjdGl2ZS9hY3RpdmVOb3RpY2UiKSk7Cgp2YXIgX2FjdGl2ZUdyYXBoaWMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIkBjb21wb25lbnRzL2FjdGl2ZS9hY3RpdmVHcmFwaGljIikpOwoKdmFyIF9hY3RpdmVSb29tID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJAY29tcG9uZW50cy9hY3RpdmUvYWN0aXZlUm9vbSIpKTsKCnZhciBfYWN0aXZlQ291cG9uID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJAY29tcG9uZW50cy9hY3RpdmUvYWN0aXZlQ291cG9uIikpOwoKdmFyIF9hY3RpdmVDYXNoID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJAY29tcG9uZW50cy9hY3RpdmUvYWN0aXZlQ2FzaCIpKTsKCnZhciBfdXRpbHMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIkAvdXRpbHMvdXRpbHMiKSk7Cgp2YXIgX3BheSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiQC91dGlscy9wYXkiKSk7Cgp2YXIgX2FjdGl2ZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiQC9maWx0ZXJzL2FjdGl2ZSIpKTsKCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCnZhciBfZGVmYXVsdCA9IHsKICBuYW1lOiAnc3BlY2lhbFNhbGUnLAogIGNvbXB1dGVkOiB7fSwKICBjb21wb25lbnRzOiB7CiAgICBhY3RpdmVDb3Vwb246IF9hY3RpdmVDb3Vwb24uZGVmYXVsdCwKICAgIGFjdGl2ZUNhc2g6IF9hY3RpdmVDYXNoLmRlZmF1bHQsCiAgICBhY3RpdmVHcmFwaGljOiBfYWN0aXZlR3JhcGhpYy5kZWZhdWx0LAogICAgYWN0aXZlQnJhbmQ6IF9hY3RpdmVCcmFuZC5kZWZhdWx0LAogICAgYWN0aXZlUm9vbTogX2FjdGl2ZVJvb20uZGVmYXVsdCwKICAgIGFjdGl2ZU5vdGljZTogX2FjdGl2ZU5vdGljZS5kZWZhdWx0CiAgfSwKCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHZpcFVzZXI6IGZhbHNlLAogICAgICBzdWl0U2hvcHM6IFtdLAogICAgICBtZWRpYUxpc3Q6IFtdLAogICAgICBncmFwaGljRGV0YWlsOiAnJywKICAgICAgLy8g6K+m5oOFaHRtbOS/oeaBrwogICAgICB0aW1lcjogbnVsbCwKICAgICAgcmVjb21tZW5kTGlzdDogW10sCiAgICAgIC8vIOWFtuS7luekvOWMheaOqOiNkC/mjqjojZDmnYPnm4oKICAgICAgZmxhZzogdHJ1ZSwKICAgICAgc2hvd1BvcDogZmFsc2UsCiAgICAgIC8vIOmdnuS8muWRmOi0reS5sOaXtuaPkOekugogICAgICByZWNvbVBhZ2U6IDEsCiAgICAgIC8vIOeJueWNlueahOaOqOiNkOadg+ebiuS4iuaLieabtOWkmgogICAgICBoYXNNb3JlOiB0cnVlLAogICAgICAvLyDnibnljZbnmoTmjqjojZDmnYPnm4rmm7TlpJrmj5DnpLoKICAgICAgYnRuRGlzYWJsZWQ6IGZhbHNlLAogICAgICBjYXNoTWFzazogZmFsc2UsCiAgICAgIHNlbENhc2hyZWQ6IHt9LAogICAgICBzZWxDb25zdW1lcjoge30sCiAgICAgIGNhbGVuZGFyTWFzazogZmFsc2UsCiAgICAgIC8vIOaXpeWOhuW8ueeqlwogICAgICBzZWxEYXRlOiB7CiAgICAgICAgc3RhcnRUaW1lOiAnJywKICAgICAgICBlbmRUaW1lOiAnJwogICAgICB9LAogICAgICAvLyDoh6rmiJHmuLjpgInkuK3nmoTml7bpl7QKICAgICAgdHJhdmVsTW9udGhJbmZvOiB7fSwKICAgICAgY29uZGl0aW9uSW5mbzoge30sCiAgICAgIC8vIOWFkeWlluS4reW/g+S/oeaBrwogICAgICB0cmFjdmVsVXNlckxpc3Q6IFtdLAogICAgICByZWZyZXNoOiBmYWxzZSwKICAgICAgLy8g5Yi35paw5pel5Y6G5pWw5o2uCiAgICAgIGRvd25UaW1lOiB7CiAgICAgICAgaG91cjogJzAwJywKICAgICAgICBtaW51dGU6ICcwMCcsCiAgICAgICAgc2Vjb25kOiAnMDAnCiAgICAgIH0sCiAgICAgIHJlYWR5OiBmYWxzZSwKICAgICAgYnRuVGV4dDogJ+eri+WNs+aKoui0rScsCiAgICAgIHNob3dCdG5UeHQ6IHRydWUsCiAgICAgIGZpeGVkRGV0YWlsOiB7fSwKICAgICAgLy8g6Zeo5bqX5ZOB54mM5Lq65Z2H5L+h5oGvCiAgICAgIHJlbWFpblRpbWU6IDM5OTkwMDAsCiAgICAgIGNoYW5uZWxUeXBlOiAnJywKICAgICAgb3B0aW9uczogdGhpcy4kcm91dGUucXVlcnkgfHwge30sCiAgICAgIGluZm86IHt9CiAgICB9OwogIH0sCgogIGNvbXB1dGVkOiB7IC4uLigwLCBfdnVleC5tYXBHZXR0ZXJzKShbImxvY2F0aW9uSW5mbyIsICJ3eFVzZXIiLCAibG9jYXRpb25DaXR5IiwgInZpcENhcmRJbmZvIiwgInVwZGF0ZUZsYWciXSkKICB9LAogIG1ldGhvZHM6IHsKICAgIC8vIOaMiemSrumihuWPluOAgeW8gOmAmuOAgei0reS5sOetieaTjeS9nOS6i+S7tgogICAgaGFuZGxlckV2ZW50KCkgewogICAgICBpZiAodGhpcy5idG5EaXNhYmxlZCkgcmV0dXJuOyAvLyDmjInpkq7nva7ngbDml7bvvIzml6Dms5Xngrnlh7votK3kubDmjInpkq4KCiAgICAgIGxldCBpbmZvID0gdGhpcy5pbmZvOwoKICAgICAgaWYgKGluZm8uc3VwcGxpZXJDb2RlID09ICdQQVJUWV9aV1knICYmIFszLCA0LCA1XS5pbmNsdWRlcyhpbmZvLnZhbGlkaXR5VHlwZSkpIHsKICAgICAgICAvLyDoh6rmiJHmuLjnibnljZbml7YgJiYg6ZyA6KaB6YCJ5a6a5pel5pyfICAg5by55Ye66YCJ5oup5pel5Y6GCiAgICAgICAgaWYgKCF0aGlzLmNhbGVuZGFyTWFzaykgewogICAgICAgICAgdGhpcy5jYWxlbmRhck1hc2sgPSB0cnVlOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgaWYgKCF0aGlzLnNlbERhdGUuc3RhcnRUaW1lKSB7CiAgICAgICAgICAvLyDmnKrpgInmi6nml7bpl7QKICAgICAgICAgIHRoaXMuJFRvYXN0KCfor7fpgInmi6nmuLjnjqnml6XmnJ8nKTsKICAgICAgICAgIHRoaXMuY2FsZW5kYXJNYXNrID0gdHJ1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKGluZm8udmFsaWRpdHlUeXBlID09IDQgfHwgaW5mby52YWxpZGl0eVR5cGUgPT0gNSkgewogICAgICAgICAgICAvLyDmuLjlrqLpgInlrprml6XmnJ/lu7blkI5Y5pyJ5pWIIHx8IOa4uOWuoumAieWumuaXpeacn+aMh+WumuaXtumXtOacieaViAogICAgICAgICAgICB0aGlzLiRkaWFsb2cuY29uZmlybSh7CiAgICAgICAgICAgICAgdGl0bGU6ICfnoa7lrprlh7rmuLjml7bpl7Q/JywKICAgICAgICAgICAgICBtZXNzYWdlOiBgJHtfdXRpbHMuZGVmYXVsdC5mb3JtYXRUaW1lKHRoaXMuc2VsRGF0ZS5zdGFydFRpbWUgfHwgMCwgJ1lZWVkvTU0vREQnKX0gfiAke191dGlscy5kZWZhdWx0LmZvcm1hdFRpbWUodGhpcy5zZWxEYXRlLmVuZFRpbWUgfHwgMCwgJ1lZWVkvTU0vREQnKX1gCiAgICAgICAgICAgIH0pLnRoZW4oKCkgPT4gewogICAgICAgICAgICAgIHRoaXMucGxhY2VPcmRlcigpOwogICAgICAgICAgICB9KS5jYXRjaCgoKSA9PiB7Ly8gb24gY2FuY2VsCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy4kZGlhbG9nLmNvbmZpcm0oewogICAgICAgICAgICAgIHRpdGxlOiAn56Gu5a6a5Ye65ri45pe26Ze0PycsCiAgICAgICAgICAgICAgbWVzc2FnZTogYCR7X3V0aWxzLmRlZmF1bHQuZm9ybWF0VGltZSh0aGlzLnNlbERhdGUuc3RhcnRUaW1lIHx8IDAsICdZWVlZL01NL0REJyl9YAogICAgICAgICAgICB9KS50aGVuKCgpID0+IHsKICAgICAgICAgICAgICB0aGlzLnBsYWNlT3JkZXIoKTsKICAgICAgICAgICAgfSkuY2F0Y2goKCkgPT4gey8vIG9uIGNhbmNlbAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5wbGFjZU9yZGVyKCk7CiAgICB9LAoKICAgIC8vIOS4i+WNlQogICAgcGxhY2VPcmRlcigpIHsKICAgICAgaWYgKHRoaXMub3B0aW9ucy5oYXNFeGNoYW5nZSAhPSAnJykgewogICAgICAgIGNvbnNvbGUubG9nKCfop6blj5Hngrnlh7votK3kubAxJywgdGhpcy5pbmZvLmNoaWxkRW51bUtleSwgdGhpcy5mcmVlLCB0aGlzLmluZm8uY2FyZFR5cGUpOyAvLyDliKTmlq3lhZHlpZbkuK3lv4Pov5vlhaUgIOeri+WNs+WFkeaNogoKICAgICAgICBsZXQgY29uZGl0aW9uSW5mbyA9IHRoaXMuY29uZGl0aW9uSW5mbzsKICAgICAgICBsZXQgdHJhY3ZlbFVzZXJMaXN0ID0gdGhpcy50cmFjdmVsVXNlckxpc3Q7CgogICAgICAgIGlmIChjb25kaXRpb25JbmZvLmlzQ29uZGl0aW9uICYmIHRyYWN2ZWxVc2VyTGlzdC5sZW5ndGggPT0gMCkgewogICAgICAgICAgLy8g5Yik5pat5piv5ZCm6ZyA5rGC5aGr5YaZ5L+h5oGvCiAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgICAgIG5hbWU6ICd0cmF2ZWxJbmZvcm1hdGlvbicsCiAgICAgICAgICAgIHF1ZXJ5OiB7CiAgICAgICAgICAgICAgYWN0U246IHRoaXMub3B0aW9ucy5hY3RTbgogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHRoaXMuZXhjaGFuZ2UoKTsKICAgICAgfSBlbHNlIGlmICh0aGlzLmluZm8uY2hpbGRFbnVtS2V5ID09ICdBQ1RfU1BFQ0lBTF9PRkZFUl9QVVJDSEFTRV9MSU1JVCcpIHsKICAgICAgICBjb25zb2xlLmxvZygn6Kem5Y+R54K55Ye76LSt5LmwMicsIHRoaXMuaW5mby5jaGlsZEVudW1LZXksIHRoaXMuZnJlZSwgdGhpcy5pbmZvLmNhcmRUeXBlKTsgLy8g5LuO6ZmQ6LSt6L+b5YWlCgogICAgICAgIHRoaXMuaGFuZGxlckxpbWl0RXZlbnQoKTsKICAgICAgfSBlbHNlIGlmICh0aGlzLmZyZWUgJiYgdGhpcy5pbmZvLmNhcmRUeXBlICE9ICdDQVJEX0RJUkVDVF9SRUNIQVJHRScpIHsKICAgICAgICBsZXQgY29uZGl0aW9uSW5mbyA9IHRoaXMuY29uZGl0aW9uSW5mbzsKICAgICAgICBsZXQgdHJhY3ZlbFVzZXJMaXN0ID0gdGhpcy50cmFjdmVsVXNlckxpc3Q7CiAgICAgICAgY29uc29sZS5sb2coJ+inpuWPkeeCueWHu+i0reS5sDMnLCBjb25kaXRpb25JbmZvLmlzQ29uZGl0aW9uLCB0aGlzLmZyZWUsIHRyYWN2ZWxVc2VyTGlzdCk7CgogICAgICAgIGlmIChjb25kaXRpb25JbmZvLmlzQ29uZGl0aW9uICYmIHRyYWN2ZWxVc2VyTGlzdC5sZW5ndGggPT0gMCkgewogICAgICAgICAgLy8g5Yik5pat5piv5ZCm6ZyA5rGC5aGr5YaZ5L+h5oGvCiAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgICAgIG5hbWU6ICd0cmF2ZWxJbmZvcm1hdGlvbicsCiAgICAgICAgICAgIHF1ZXJ5OiB7CiAgICAgICAgICAgICAgYWN0U246IHRoaXMub3B0aW9ucy5hY3RTbgogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9IC8vIOWFjei0uemihuWPlgoKCiAgICAgICAgdGhpcy5nZXRGcmVlKCk7CiAgICAgIH0gZWxzZSBpZiAodGhpcy5vcGVuX3JlY2VpdmUpIHsKICAgICAgICBjb25zb2xlLmxvZygn6Kem5Y+R54K55Ye76LSt5LmwNCcsIHRoaXMuaW5mby5jaGlsZEVudW1LZXksIHRoaXMuZnJlZSwgdGhpcy5pbmZvLmNhcmRUeXBlKTsKICAgICAgICB0aGlzLm9wZW5SZWNlaXZlKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc29sZS5sb2coJ+inpuWPkeeCueWHu+i0reS5sDUnLCB0aGlzLmluZm8uY2hpbGRFbnVtS2V5LCB0aGlzLmZyZWUsIHRoaXMuaW5mby5jYXJkVHlwZSk7CiAgICAgICAgdGhpcy50b0J1eSgpOwogICAgICB9CiAgICB9LAoKICAgIGhhbmRsZXJMaW1pdEV2ZW50KCkgewogICAgICBpZiAodGhpcy5pbmZvLmxpbWl0QWN0U3RhdGUgPT0gMTIpIHsKICAgICAgICB0aGlzLiRUb2FzdCgn5b2T5YmN5ZCI6L6R6Z2e6L+b6KGM5Lit54q25oCBJyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKHRoaXMuYnRuVGV4dCA9PSAn56uL5Y2z5oqi6LStJykgewogICAgICAgICAgdGhpcy50b0J1eSgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwKCiAgICAvLyDlhZHmjaIKICAgIGV4Y2hhbmdlKCkgewogICAgICBsZXQgaXRlbSA9IHRoaXMuZXhjaGFuZ2VfZGF0YTsKICAgICAgdGhpcy4kZGlhbG9nLmNvbmZpcm0oewogICAgICAgIHRpdGxlOiBg5piv5ZCm56Gu6K6k5YWR5o2iJHtpdGVtLmFjdE5hbWUgfHwgJyd9P2AsCiAgICAgICAgbWVzc2FnZTogJ+WFkeaNouWQjuS4jeWPr+abtOaUueS4lOWOn+aciea9ruWNoeWwhuS8mua4heepuicKICAgICAgfSkudGhlbigoKSA9PiB7CiAgICAgICAgdGhpcy5wcmljZUV4Y2hhbmdlKGl0ZW0pOwogICAgICB9KS5jYXRjaCgoKSA9PiB7Ly8gb24gY2FuY2VsCiAgICAgIH0pOwogICAgfSwKCiAgICAvLyDlvIDlp4vlhZHmjaIKICAgIHByaWNlRXhjaGFuZ2UoaXRlbSkgewogICAgICBpZiAodGhpcy5pc0NhbkNsaWNrKSByZXR1cm47CiAgICAgIHRoaXMuaXNDYW5DbGljayA9IHRydWU7CiAgICAgIHRoaXMuJGFwaS5wcmljZV9leGNoYW5nZSh7CiAgICAgICAgYWN0U246IGl0ZW0uYWN0U24sCiAgICAgICAgYXdhcmRJZDogaXRlbS5hd2FyZElkLAogICAgICAgIGNpdHlJZDogdGhpcy5sb2NhdGlvbkNpdHkuY2l0eUlkLAogICAgICAgIGNob29zZURhdGU6IHRoaXMuc2VsRGF0ZS5zdGFydFRpbWUgPyBfdXRpbHMuZGVmYXVsdC5mb3JtYXRUaW1lKHRoaXMuc2VsRGF0ZS5zdGFydFRpbWUgfHwgMCwgJ1lZWVlNTUREJykgOiAwLAogICAgICAgIC8vIOiHquaIkea4uOmAieaLqeaXtumXtAogICAgICAgIHRyYWN2ZWxVc2VyTGlzdDogSlNPTi5zdHJpbmdpZnkodGhpcy50cmFjdmVsVXNlckxpc3QpCiAgICAgIH0pLnRoZW4ocmVzID0+IHsKICAgICAgICBpZiAocmVzLnN0YXRlKSB7CiAgICAgICAgICB0aGlzLm1hc2sgPSB0cnVlOwogICAgICAgICAgdGhpcy50cmFjdmVsVXNlckxpc3QgPSBbXTsKICAgICAgICAgIHRoaXMuJHNhdmUucmVtb3ZlKCdzZXNzaW9uJywgJ3RyYXZlbEluZm9ybWF0aW9uJyk7CiAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+W3suWFkeaNoicsIHRydWUpOyAvLyDmuIXpmaTnlKjmiLfloavlhpnkv6Hmga8KCiAgICAgICAgICB0aGlzLiRzYXZlLnJlbW92ZSgnc2Vzc2lvbicsICd0cmF2ZWxJbmZvcm1hdGlvbicpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLiRUb2FzdChyZXMubWVzc2FnZSk7CiAgICAgICAgfQogICAgICB9KS5maW5hbGx5KCgpID0+IHsKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgIHRoaXMuaXNDYW5DbGljayA9IGZhbHNlOwogICAgICAgIH0sIDMwMCk7CiAgICAgIH0pOwogICAgfSwKCiAgICBnb0NhcmQoKSB7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICBuYW1lOiAnY291cG9uTGlzdCcKICAgICAgfSk7CiAgICB9LAoKICAgIGNsb3NlKCkgewogICAgICB0aGlzLm1hc2sgPSBmYWxzZTsKICAgIH0sCgogICAgLy8g6Z2e5Lya5ZGY5byA6YCa5bm26aKG5Y+WCiAgICBvcGVuUmVjZWl2ZSgpIHsKICAgICAgdGhpcy4kc2V0KHRoaXMuaW5mbywgJ3NlbGxQcmljZScsIDApOwogICAgICB0aGlzLiRzZXQodGhpcy5pbmZvLCAnbm9WaXBQcmljZScsIDApOwogICAgICBsZXQgcmVjZWl2ZVR5cGUgPSB0aGlzLm9wdGlvbnMuY2hhbm5lbFR5cGUgPT0gJ0NIQU5ORUxfQUNUSVZJVFlfTEFCRUxfU0hPVycgPyA0IDogMTsKICAgICAgbGV0IGluZm8gPSB0aGlzLmluZm87CiAgICAgIGluZm8uc2VsRGF0ZSA9IHRoaXMuc2VsRGF0ZTsKICAgICAgaW5mby5kZXNjcmliZSA9ICcnOwogICAgICB0aGlzLiRzYXZlLnNldCgnc2Vzc2lvbicsICdvcmRlckluZm8nLCB0aGlzLmluZm8pOyAvLyDpnZ7kvJrlkZjlvIDpgJrlubbpooblj5YKCiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICBuYW1lOiAnc3VibWl0T3JkZXInLAogICAgICAgIHF1ZXJ5OiB7CiAgICAgICAgICBjb21wSWQ6IHRoaXMub3B0aW9ucy5jb21wSWQgfHwgJycsCiAgICAgICAgICBhY3RTbjogdGhpcy5vcHRpb25zLmFjdFNuLAogICAgICAgICAgY2hhbm5lbFR5cGU6IHRoaXMub3B0aW9ucy5jaGFubmVsVHlwZSwKICAgICAgICAgIHJlY2VpdmVUeXBlOiByZWNlaXZlVHlwZQogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAoKICAgIC8vIOWUruS7t+S4ujDml7bvvIzlhY3otLnpooYKICAgIGdldEZyZWUoKSB7CiAgICAgIGxldCBhY3REZWFsID0gX3BheS5kZWZhdWx0LmFjdERlYWwoewogICAgICAgIGNpdHlJZDogdGhpcy5sb2NhdGlvbkNpdHkuY2l0eUlkLAogICAgICAgIGFjdFNuOiB0aGlzLm9wdGlvbnMuYWN0U24sCiAgICAgICAgZGVhbE51bTogMSwKICAgICAgICBjaGFubmVsVHlwZTogdGhpcy5vcHRpb25zLmNoYW5uZWxUeXBlLAogICAgICAgIHFyQ29kZTogdGhpcy5vcHRpb25zLnFyQ29kZSB8fCAnJywKICAgICAgICByZWFsRmVlOiAwLAogICAgICAgIHJlY2VpdmVUeXBlOiB0aGlzLm9wdGlvbnMuY2hhbm5lbFR5cGUgPT0gJ0NIQU5ORUxfQUNUSVZJVFlfTEFCRUxfU0hPVycgPyA0IDogMSwKICAgICAgICAvLyDojrflj5bmlrnlvI/vvIwx5Lya5ZGY6aKG5Y+W77yMMuS8muWRmOi0reS5sO+8jDPmuKDpgZPotK3kubAgdjEuMi4w5pS55Li6MQogICAgICAgIG9wZW5WaXA6IGZhbHNlLAogICAgICAgIC8v5piv5ZCm5byA6YCa5pyI5Y2h5Lya5ZGY5bm26LSt5LmwCiAgICAgICAgYWN0RmVlOiAwLAogICAgICAgIC8v5rS75Yqo5pSv5LuY6LS555SoCiAgICAgICAgdmlwRmVlOiAwLAogICAgICAgIHZpcENhcmRJZDogJycsCiAgICAgICAgYnV5VHlwZTogMCwKICAgICAgICBjb21wSWQ6IHRoaXMub3B0aW9ucy5jb21wSWQsCiAgICAgICAgLy8g5ZCI6L6RSWQKICAgICAgICBjaG9vc2VEYXRlOiB0aGlzLnNlbERhdGUuc3RhcnRUaW1lID8gX3V0aWxzLmRlZmF1bHQuZm9ybWF0VGltZSh0aGlzLnNlbERhdGUuc3RhcnRUaW1lIHx8IDAsICdZWVlZTU1ERCcpIDogMCwKICAgICAgICAvLyDoh6rmiJHmuLjpgInmi6nml7bpl7QKICAgICAgICB0cmFjdmVsVXNlckxpc3Q6IEpTT04uc3RyaW5naWZ5KHRoaXMudHJhY3ZlbFVzZXJMaXN0KQogICAgICB9KTsKCiAgICAgIGlmIChhY3REZWFsKSB7CiAgICAgICAgYWN0RGVhbC50aGVuKHJlcyA9PiB7CiAgICAgICAgICBpZiAocmVzLnN0YXRlKSB7CiAgICAgICAgICAgIHRoaXMudHJhY3ZlbFVzZXJMaXN0ID0gW107CiAgICAgICAgICAgIHRoaXMuJHNhdmUucmVtb3ZlKCdzZXNzaW9uJywgJ3RyYXZlbEluZm9ybWF0aW9uJyk7CiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgICBuYW1lOiAnc3BlY2lhbFNhbGVTdWNjZXNzJywKICAgICAgICAgICAgICBxdWVyeTogewogICAgICAgICAgICAgICAgdHJhZGVJZDogcmVzLmluZm8udHJhZGVJZCwKICAgICAgICAgICAgICAgIGFjdE5hbWU6IHRoaXMuaW5mby5hY3ROYW1lLAogICAgICAgICAgICAgICAgcmVjZWl2ZTogMSwKICAgICAgICAgICAgICAgIGFjdFNuOiB0aGlzLm9wdGlvbnMuYWN0U24sCiAgICAgICAgICAgICAgICB2aXBfY2hlY2s6IDAKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9LAoKICAgIHRvQnV5KCkgewogICAgICBpZiAodGhpcy5pc0NhbkNsaWNrKSByZXR1cm47CiAgICAgIHRoaXMuaXNDYW5DbGljayA9IHRydWU7CiAgICAgIGxldCBpbmZvID0gdGhpcy5pbmZvOwogICAgICBpbmZvLnNlbERhdGUgPSB0aGlzLnNlbERhdGU7CiAgICAgIGluZm8uZGVzY3JpYmUgPSAnJzsKICAgICAgdGhpcy4kc2F2ZS5zZXQoJ3Nlc3Npb24nLCAnb3JkZXJJbmZvJywgdGhpcy5pbmZvKTsgLy8g5Yik5pat5piv5ZCm5pyJ5pyq5pSv5LuY55qE6K6i5Y2VCgogICAgICB0aGlzLiRhcGkub3JkZXJfdW5wYXkoewogICAgICAgIGFjdFNuOiB0aGlzLm9wdGlvbnMuYWN0U24KICAgICAgfSkudGhlbihyZXMgPT4gewogICAgICAgIGlmIChyZXMuc3RhdGUpIHsKICAgICAgICAgIGlmIChyZXMuaW5mby5leGlzdHNVblBheSkgewogICAgICAgICAgICAvLyDlpoLmnpzlrZjlnKjmnKrmlK/ku5jnmoTorqLljZXvvIzot7PovazliLDorqLljZXliJfooajpobUKICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goewogICAgICAgICAgICAgIG5hbWU6ICdvcmRlckxpc3QnCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbGV0IHJlY2VpdmVUeXBlID0gdGhpcy5vcHRpb25zLmNoYW5uZWxUeXBlID09ICdDSEFOTkVMX0FDVElWSVRZX0xBQkVMX1NIT1cnID8gMyA6IDI7CiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgICBuYW1lOiAnc3VibWl0T3JkZXInLAogICAgICAgICAgICAgIHF1ZXJ5OiB7CiAgICAgICAgICAgICAgICBxckNvZGU6IHRoaXMub3B0aW9ucy5xckNvZGUgfHwgJycsCiAgICAgICAgICAgICAgICBjb21wSWQ6IHRoaXMub3B0aW9ucy5jb21wSWQgfHwgJycsCiAgICAgICAgICAgICAgICBhY3RTbjogdGhpcy5vcHRpb25zLmFjdFNuLAogICAgICAgICAgICAgICAgY2hhbm5lbFR5cGU6IHRoaXMub3B0aW9ucy5jaGFubmVsVHlwZSwKICAgICAgICAgICAgICAgIHJlY2VpdmVUeXBlOiByZWNlaXZlVHlwZQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KS5maW5hbGx5KCgpID0+IHsKICAgICAgICB0aGlzLmlzQ2FuQ2xpY2sgPSBmYWxzZTsKICAgICAgfSk7CiAgICB9LAoKICAgIC8vIOWIpOaWreeUqOaIt+i0reS5sOS/oeaBrwogICAgZ2V0UmVhbFRpbWVJbmZvKGxpbWl0RnJlcXVlbmN5KSB7CiAgICAgIHJldHVybiB0aGlzLiRhcGkucmVhbFRpbWVfaW5mbyh7CiAgICAgICAgYWN0U246IHRoaXMub3B0aW9ucy5hY3RTbgogICAgICB9KS50aGVuKHJlcyA9PiB7CiAgICAgICAgaWYgKHJlcy5zdGF0ZSkgewogICAgICAgICAgdGhpcy5yZWFsSW5mbyA9IHJlcy5pbmZvOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAoKICAgIGhhbmRsZXJCdG4odGV4dCwgZGlzYWJsZWQgPSBmYWxzZSkgewogICAgICB0aGlzLmJ0blRleHQgPSB0ZXh0OwogICAgICB0aGlzLmJ0bkRpc2FibGVkID0gZGlzYWJsZWQ7CiAgICB9LAoKICAgIGhhbmRsZXJMaW1pdChpbmZvMiwgZmxhZykgewogICAgICAvLyAx5pyq5byA5aeLIDLov5vooYzkuK0gM+W3sue7k+adnwogICAgICBsZXQgY3VycmVudFRpbWUgPSArbmV3IERhdGUoKTsKCiAgICAgIGlmIChpbmZvMi5saW1pdEVuZFRpbWUgPCBjdXJyZW50VGltZSAmJiBpbmZvMi5saW1pdFN0YXJ0VGltZSA8IGN1cnJlbnRUaW1lKSB7CiAgICAgICAgaW5mbzIudGltZVN0YXRlID0gMzsKICAgICAgfSBlbHNlIGlmIChpbmZvMi5saW1pdEVuZFRpbWUgPiBjdXJyZW50VGltZSAmJiBpbmZvMi5saW1pdFN0YXJ0VGltZSA8IGN1cnJlbnRUaW1lKSB7CiAgICAgICAgaW5mbzIudGltZVN0YXRlID0gMjsKICAgICAgfSBlbHNlIGlmIChpbmZvMi5saW1pdFN0YXJ0VGltZSA+IGN1cnJlbnRUaW1lKSB7CiAgICAgICAgaW5mbzIudGltZVN0YXRlID0gMTsKICAgICAgICBsZXQgaGVhZGxpbmUgPSBnZXREYXlOYW1lKGluZm8yLmxpbWl0U3RhcnRUaW1lKTsKICAgICAgICB0aGlzLmhlYWRsaW5lID0gaGVhZGxpbmU7CiAgICAgIH0KCiAgICAgIGlmIChpbmZvMi50aW1lU3RhdGUgIT0gMykgewogICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5saW1pdFRpbWVyKTsKICAgICAgICB0aGlzLmxpbWl0VGltZXIgPSBzZXRJbnRlcnZhbCgoKSA9PiB7CiAgICAgICAgICBsZXQgbm93VGltZSA9ICtuZXcgRGF0ZSgpOwogICAgICAgICAgdmFyIGN1dFRpbWUgPSAwOwoKICAgICAgICAgIGlmIChpbmZvMi50aW1lU3RhdGUgPT0gMSkgewogICAgICAgICAgICBjdXRUaW1lID0gaW5mbzIubGltaXRTdGFydFRpbWUgLSBub3dUaW1lOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY3V0VGltZSA9IGluZm8yLmxpbWl0RW5kVGltZSAtIG5vd1RpbWU7CiAgICAgICAgICB9CgogICAgICAgICAgbGV0IGxhc3RUaW1lID0gX3V0aWxzLmRlZmF1bHQuY291bnREb3duMyhjdXRUaW1lKTsKCiAgICAgICAgICB0aGlzLmRvd25UaW1lID0gbGFzdFRpbWU7CgogICAgICAgICAgaWYgKGN1dFRpbWUgPD0gMCAmJiBpbmZvMi5saW1pdEFjdFN0YXRlICE9IDEyKSB7CiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5saW1pdFRpbWVyKTsKICAgICAgICAgICAgdGhpcy5nZXRBY3REZXRhaWwoKTsKICAgICAgICAgIH0KICAgICAgICB9LCAxMDAwKTsKICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmRvd25UaW1lLCAndGhpcy5kb3duVGltZScpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuZG93blRpbWUgPSB7CiAgICAgICAgICBob3VyOiAnMDAnLAogICAgICAgICAgbWludXRlOiAnMDAnLAogICAgICAgICAgc2Vjb25kOiAnMDAnCiAgICAgICAgfTsKICAgICAgfQoKICAgICAgaWYgKGZsYWcpIHsKICAgICAgICBjb25zb2xlLmxvZygnZmxhZycsIGluZm8yLCAnPT09PT09PT09PT09PT0nKTsgLy8g5bey5oqi5a6M5rS75Yqo5by556qXCgogICAgICAgIGlmIChpbmZvMi5saW1pdEFjdFN0YXRlID09IDMgfHwgaW5mbzIubGltaXRBY3RTdGF0ZSA9PSAyIHx8ICF0aGlzLmluZm8ucmVtYWluTnVtKSB7CiAgICAgICAgICB0aGlzLmdldEVuZEFjdGl2ZSgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwKCiAgICAvLyDojrflj5bmtLvliqjor6bmg4UKICAgIGFzeW5jIGdldEFjdERldGFpbChmbGFnKSB7CiAgICAgIHRoaXMuJFRvYXN0LmxvYWRpbmcoewogICAgICAgIG1lc3NhZ2U6ICfliqDovb3kuK0uLi4nLAogICAgICAgIGZvcmJpZENsaWNrOiB0cnVlLAogICAgICAgIGR1cmF0aW9uOiAwCiAgICAgIH0pOwogICAgICBhd2FpdCB0aGlzLmdldFNwZWNpYWxJbmZvKCk7IC8vIOWmguaenOaYr+eJueWNlua0u+WKqOivpuaDhe+8jGNhcmRJZO+8jGRldGFpbElk5LuO54m55Y2W6K+m5oOF6YeM6Z2i6I635Y+WCgogICAgICBhd2FpdCB0aGlzLmdldENvdXBEZXRhaWwoKTsgLy8g6I635Y+W5Y2h5Yi46K+m5oOFCgogICAgICBhd2FpdCB0aGlzLmdldFJlYWxUaW1lSW5mbygpOwogICAgICB0aGlzLmdldFN1aXRTaG9wcygpOyAvLyDojrflj5bpgILnlKjlupfpk7oKCiAgICAgIHRoaXMuJGFwaS5hY3RfZGV0YWlsKHsKICAgICAgICBjaGFubmVsVHlwZTogdGhpcy5vcHRpb25zLmNoYW5uZWxUeXBlLAogICAgICAgIHFyQ29kZTogdGhpcy5vcHRpb25zLnFyQ29kZSB8fCAnJywKICAgICAgICBhY3RTbjogdGhpcy5vcHRpb25zLmFjdFNuCiAgICAgIH0pLnRoZW4oYXN5bmMgcmVzID0+IHsKICAgICAgICBpZiAocmVzLnN0YXRlKSB7CiAgICAgICAgICBsZXQgaW5mbzEgPSB0aGlzLmluZm87CiAgICAgICAgICBsZXQgaW5mbzIgPSByZXMuaW5mbzsKICAgICAgICAgIGxldCBjb250YXRpb24gPSBpbmZvMi5idXlMaW1pdCA9PSAxICYmICFpbmZvMi5zZWxsUHJpY2UgJiYgIWluZm8yLm5vVmlwUHJpY2UgfHwgaW5mbzIuYnV5TGltaXQgPT0gMiAmJiAhaW5mbzIuc2VsbFByaWNlOyAvLyDliKTmlq3lt7Lpooblj5bnmoTnirbmgIEKICAgICAgICAgIC8vIOWkhOeQhumZkOaXtueahOWAkuiuoeaXtuetiemXrumimCAKCiAgICAgICAgICBpZiAoaW5mbzIuY2hpbGRFbnVtS2V5ID09ICdBQ1RfU1BFQ0lBTF9PRkZFUl9QVVJDSEFTRV9MSU1JVCcpIHsKICAgICAgICAgICAgdGhpcy5oYW5kbGVyTGltaXQoaW5mbzIsIGZsYWcpOwogICAgICAgICAgfQoKICAgICAgICAgIGluZm8xLmNoYW5uZWxUeXBlID0gdGhpcy5vcHRpb25zLmNoYW5uZWxUeXBlIHx8ICcnOwogICAgICAgICAgbGV0IGluZm8gPSB7IC4uLmluZm8xLAogICAgICAgICAgICAuLi5pbmZvMgogICAgICAgICAgfTsKICAgICAgICAgIHRoaXMuaW5mbyA9IGluZm87CiAgICAgICAgICB0aGlzLnJlbWFpblRpbWUgPSBpbmZvMi5yZW1haW5UaW1lOwogICAgICAgICAgdGhpcy5yZWFkeSA9IHRydWU7CiAgICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmluZm8sICdpbmZvMWluZm8xaW5mbzFpbmZvMWluZm8xJyk7IC8vIOiHquaIkea4uOeJueWNluaXtumcgOiwg+eUqOaXpeWOhuaOpeWPoyAo5Y2h5Yi45pyJ5pWI5pyf57G75Z6L5Li6IDMsNCw1KQoKICAgICAgICAgIGlmICh0aGlzLmluZm8uc3VwcGxpZXJDb2RlID09ICdQQVJUWV9aV1knKSB7CiAgICAgICAgICAgIC8vIOiHquaIkea4uOaYvuekuuS8muWRmOS7t++8iOmAieaLqeaXpeacn+WQjui/memHjOeahOS7t+agvOS4jeWPmO+8iQogICAgICAgICAgICB0aGlzLiRzZXQodGhpcy5pbmZvLCAndHJhdmVsUHJpY2UnLCBpbmZvMi5zZWxsUHJpY2UpOwoKICAgICAgICAgICAgaWYgKHRoaXMuc2VsRGF0ZS5zZWxsUHJpY2UgfHwgdGhpcy5zZWxEYXRlLnNlbGxQcmljZSA9PSAwKSB7CiAgICAgICAgICAgICAgLy8g5Yik5pat5bey6YCJ5oup55qE5Lu35qC8CiAgICAgICAgICAgICAgdGhpcy4kc2V0KHRoaXMuaW5mbywgJ3NlbGxQcmljZScsIHRoaXMuc2VsRGF0ZS5zZWxsUHJpY2UpOwogICAgICAgICAgICAgIHRoaXMuJHNldCh0aGlzLmluZm8sICdub1ZpcFByaWNlJywgdGhpcy5zZWxEYXRlLm5vVmlwUHJpY2UpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoWzMsIDQsIDVdLmluY2x1ZGVzKGluZm8xLnZhbGlkaXR5VHlwZSkpIHsvLyDliKTmlq3pgInlrprml6XmnJ/vvIzmmL7npLrml6XljoYKICAgICAgICAgICAgICAvLyB0aGlzLnRyYXZlbEFjdE1vbnRoKCkKICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmluZm8ubGltaXRUaW1lID4gMCkgewogICAgICAgICAgICAgIC8vIOWIpOaWreW9k+WJjeaXtumXtOaYr+WQpuWPr+i0reS5sCAKICAgICAgICAgICAgICBsZXQgbGltaXRUaW1lID0gdGhpcy5pbmZvLmxpbWl0VGltZTsKICAgICAgICAgICAgICBsZXQgZGF0ZSA9IG5ldyBEYXRlKCk7CiAgICAgICAgICAgICAgbGV0IGggPSBkYXRlLmdldEhvdXJzKCkgPiA5ID8gZGF0ZS5nZXRIb3VycygpICsgJycgOiAnMCcgKyBkYXRlLmdldEhvdXJzKCk7CiAgICAgICAgICAgICAgdmFyIG0gPSBkYXRlLmdldE1pbnV0ZXMoKSA+IDkgPyBkYXRlLmdldE1pbnV0ZXMoKSArICcnIDogJzAnICsgZGF0ZS5nZXRNaW51dGVzKCk7CiAgICAgICAgICAgICAgbGV0IGRheVRpbWUgPSBoICsgbTsKCiAgICAgICAgICAgICAgaWYgKGRheVRpbWUgPiBsaW1pdFRpbWUpIHsKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+W9k+WJjeS4jeWPr+i0reS5sCcsIHRydWUpOwogICAgICAgICAgICAgICAgfSwgNTAwKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4odGhpcy5pbmZvLmNhcmRUeXBlID09PSAnQ0FSRF9ESVJFQ1RfUkVDSEFSR0UnID8gJ+eri+WNs+WFheWAvCcgOiAn56uL5Y2z6LSt5LmwJyk7IC8vIOS7hemZkOS8muWRmOi0reS5sO+8jOmdnuS8muWRmOaYvuekugoKICAgICAgICAgIGlmIChpbmZvMi5idXlMaW1pdCA9PSAyICYmICF0aGlzLnZpcFVzZXIpIHsKICAgICAgICAgICAgdGhpcy5oYW5kbGVyQnRuKCflvIDpgJrlubbotK3kubAnKTsKICAgICAgICAgIH0gLy8g5LuF6ZmQ5Lya5ZGY6LSt5Lmw5LiU5Lya5ZGY5ZSu5Lu35Li6MO+8jOmdnuS8muWRmOinhuinkgoKCiAgICAgICAgICBpZiAoaW5mbzIuYnV5TGltaXQgPT0gMiAmJiAhaW5mbzIuc2VsbFByaWNlICYmICF0aGlzLnZpcFVzZXIpIHsKICAgICAgICAgICAgdGhpcy5oYW5kbGVyQnRuKCflvIDpgJrlubbpooblj5YnKTsKICAgICAgICAgICAgdGhpcy5vcGVuX3JlY2VpdmUgPSB0cnVlOyAvLyDmoIflv5fmmK/lvIDpgJrlubbpooblj5bmjInpkq4KICAgICAgICAgIH0KCiAgICAgICAgICBpZiAodGhpcy5pbmZvLnJlbWFpbk51bSA+IDAgfHwgdGhpcy5pbmZvLmNhcmRUeXBlID09PSAnQ0FSRF9ESVJFQ1RfUkVDSEFSR0UnKSB7CiAgICAgICAgICAgIGlmICh0aGlzLmluZm8uY2hhbm5lbFR5cGUgPT0gJ0NIQU5ORUxfQ09OU1VNRVJfQ09VUE9OJyB8fCB0aGlzLmluZm8uY2hhbm5lbFR5cGUgPT0gJ0NIQU5ORUxfRk9SVFVORV9DT1VQT04nKSB7CiAgICAgICAgICAgICAgLy8g5raI6LS55Yi45rig6YGT5pe277yM5Yik5pat5Y6f5Lu3CiAgICAgICAgICAgICAgaWYgKGluZm8yLndvcnRoID09IDApIHsKICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign56uL5Y2z6aKG5Y+WJyk7CiAgICAgICAgICAgICAgICB0aGlzLmZyZWUgPSB0cnVlOyAvL+WPr+S7peWFjei0uemihuWPlgogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBpZiAoIWluZm8yLnNlbGxQcmljZSAmJiB0aGlzLnZpcFVzZXIgfHwgaW5mbzIuYnV5TGltaXQgPT0gMSAmJiAhaW5mbzIuc2VsbFByaWNlICYmICFpbmZvMi5ub1ZpcFByaWNlKSB7CiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+eri+WNs+mihuWPlicpOwogICAgICAgICAgICAgICAgdGhpcy5mcmVlID0gdHJ1ZTsgLy/lj6/ku6XlhY3otLnpooblj5YKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIOW6k+WtmOS4ujDml7YKICAgICAgICAgICAgaWYgKGNvbnRhdGlvbikgewogICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign5bey6aKG5a6MJywgdHJ1ZSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgdGhpcy5oYW5kbGVyQnRuKCflt7LllK7nvYQnLCB0cnVlKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGlmIChpbmZvMi5hY3RTdGF0ZSA9PSAzIHx8IGluZm8yLmFjdFN0YXRlID09IDQgfHwgaW5mbzIuYWN0U3RhdGUgPT0gNSkgewogICAgICAgICAgICAvL+WUruS7t+mDveS4ujAKICAgICAgICAgICAgaWYgKGNvbnRhdGlvbikgewogICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign5bey6aKG5a6MJywgdHJ1ZSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgdGhpcy5oYW5kbGVyQnRuKCflt7LllK7nvYQnLCB0cnVlKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGlmIChpbmZvMi5hY3RTdGF0ZSA9PSAxKSB7CiAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign5rS75Yqo5pyq5byA5aeLJywgdHJ1ZSk7CiAgICAgICAgICB9IGVsc2UgaWYgKGluZm8yLmFjdFN0YXRlID09IDIwKSB7CiAgICAgICAgICAgIC8vIOiHquaIkea4uOWNoeWIuOW9k+WJjeaXtumXtOS4jeWPr+i0reS5sAogICAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+W9k+WJjeS4jeWPr+i0reS5sCcsIHRydWUpOwogICAgICAgICAgfQoKICAgICAgICAgIGxldCB0b3RhbE51bSA9IE51bWJlcih0aGlzLnJlYWxJbmZvLnVzZXJCdXlOdW0pICsgTnVtYmVyKHRoaXMucmVhbEluZm8udXNlckZyZWVSZWNlaXZlTnVtKTsgLy8g5b2T5YmN55So5oi355qE6LSt5Lmw5pWw6YeP5ZKM6aKG5Y+W5pWw6YeP5oC75ZKMCiAgICAgICAgICAvLyDmmK/lkKbpmZDliLbotK3kubAKCiAgICAgICAgICBpZiAoaW5mbzIubGltaXRTdGF0ZSkgewogICAgICAgICAgICBpZiAodG90YWxOdW0gPj0gaW5mbzIubGltaXRGcmVxdWVuY3kpIHsKICAgICAgICAgICAgICAvLyDnlKjmiLfmgLvmiJDlip/otK3kubDmlbDph4/lpKfkuo7pmZDliLbotK3kubDmlbDph48KICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+W3sui0reS5sCcsIHRydWUpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAodG90YWxOdW0gPj0gaW5mbzIubGltaXRGcmVxdWVuY3kgJiYgY29udGF0aW9uKSB7CiAgICAgICAgICAgICAgLy8g5b2T5YmN55So5oi35b2T5YmN5rS75Yqo5Lit5oC75YWN6LS56aKG5Y+W5pWw6YeP5aSn5LqO6ZmQ5Yi26aKG5Y+W5pWw6YePCiAgICAgICAgICAgICAgdGhpcy5oYW5kbGVyQnRuKCflt7Lpooblj5YnLCB0cnVlKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMuc2hvd0J0blR4dCA9IHRydWU7IC8vIC4uLi4uLi4uLi4uLi4uLi4u5LyY5YyW5paw5aKeLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLgogICAgICAgICAgLy8g5Yik5pat5LuO6ZmQ6LSt6L+b5YWlCgogICAgICAgICAgaWYgKGluZm8yLmNoaWxkRW51bUtleSA9PSAnQUNUX1NQRUNJQUxfT0ZGRVJfUFVSQ0hBU0VfTElNSVQnKSB7CiAgICAgICAgICAgIGlmICghdGhpcy5pbmZvLnJlbWFpbk51bSkgewogICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign5bey5oqi5a6MJywgdHJ1ZSk7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAocmVzLmluZm8uYWN0U3RhdGUgPT0gMTEgfHwgcmVzLmluZm8uYWN0U3RhdGUgPT0gMykgewogICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign5bey5oqi5a6MJywgdHJ1ZSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgLy8gaWYgKHJlcy5pbmZvLmxpbWl0QWN0U3RhdGUgPT0gOCkgewogICAgICAgICAgICAgIC8vICAgdGhpcy5oYW5kbGVyQnRuKCfpooTnuqbmj5DphpInLCBmYWxzZSkKICAgICAgICAgICAgICAvLyB9IGVsc2UgaWYgKHJlcy5pbmZvLmxpbWl0QWN0U3RhdGUgPT0gOSkgewogICAgICAgICAgICAgIC8vICAgdGhpcy5oYW5kbGVyQnRuKCflt7LpooTnuqYnLCBmYWxzZSkKICAgICAgICAgICAgICAvLyB9IAogICAgICAgICAgICAgIGlmIChyZXMuaW5mby5saW1pdEFjdFN0YXRlID09IDggfHwgcmVzLmluZm8ubGltaXRBY3RTdGF0ZSA9PSA5KSB7CiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+acquW8gOWniycsIHRydWUpOwogICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzLmluZm8ubGltaXRBY3RTdGF0ZSA9PSAxKSB7CiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+eri+WNs+aKoui0rScsIGZhbHNlKTsKICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlcy5pbmZvLmxpbWl0QWN0U3RhdGUgPT0gMTApIHsKICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign5bey6LSt5LmwJywgdHJ1ZSk7CiAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXMuaW5mby5saW1pdEFjdFN0YXRlID09IDMpIHsKICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign5bey5oqi5a6MJywgdHJ1ZSk7CiAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXMuaW5mby5saW1pdEFjdFN0YXRlID09IDIpIHsKICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign5bey5oqi5a6MJywgdHJ1ZSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9IC8vIOWIpOaWreS4uuWFkeaNouS4reW/g+i/m+WFpQoKCiAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmhhc0V4Y2hhbmdlICE9ICcnKSB7CiAgICAgICAgICAgIGxldCBleGNoYW5nZV9kYXRhID0gdGhpcy5leGNoYW5nZV9kYXRhOyAvLyDlhZHmjaLkuK3lv4PmtLvliqjmlbDmja4KCiAgICAgICAgICAgIGlmIChleGNoYW5nZV9kYXRhLmhhc0V4Y2hhbmdlKSB7CiAgICAgICAgICAgICAgdGhpcy5oYW5kbGVyQnRuKCflt7LlhZHmjaInLCB0cnVlKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBpZiAoZXhjaGFuZ2VfZGF0YS5yZW1haW5OdW0gPiAwKSB7CiAgICAgICAgICAgICAgICBpZiAoZXhjaGFuZ2VfZGF0YS5zdGF0ZSAhPSAyKSB7CiAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign5bey57uT5p2fJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBpZiAoZXhjaGFuZ2VfZGF0YS5jb25kaXRpb24pIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+eri+WNs+WFkeaNoicsIGZhbHNlKTsKICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+eri+WNs+WFkeaNoicsIHRydWUpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlckJ0bign5bey5YWR5a6MJywgdHJ1ZSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9IC8vIOWmguaenOmcgOimgeaYvuekuuWAkuiuoeaXtgoKCiAgICAgICAgICBpZiAoaW5mbzIuc2hvd1RpbWUgJiYgaW5mbzIuY2hpbGRFbnVtS2V5ICE9ICdBQ1RfU1BFQ0lBTF9PRkZFUl9QVVJDSEFTRV9MSU1JVCcpIHsKICAgICAgICAgICAgLy8gLi4uLi4uLi4uLi4uLi4uLi4u5LyY5YyW57uT5p2fLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4KICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnRpbWVyKTsKICAgICAgICAgICAgdmFyIHJlbWFpblRpbWUgPSB0aGlzLnJlbWFpblRpbWU7CiAgICAgICAgICAgIHRoaXMudGltZXIgPSBzZXRJbnRlcnZhbCgoKSA9PiB7CiAgICAgICAgICAgICAgaWYgKHJlbWFpblRpbWUgPj0gMTAwMCkgewogICAgICAgICAgICAgICAgcmVtYWluVGltZSAtPSAxMDAwOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMudGltZXIpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdGhpcy5yZW1haW5UaW1lID0gcmVtYWluVGltZSB8fCAwOwogICAgICAgICAgICB9LCAxMDAwKTsKICAgICAgICAgIH0gLy8gdGhpcy5nZXRDYXNoTnVtKCkgLy8g6I635Y+W5b2T5YmN5rS75Yqo5Y+v55So5oq15omj5pyA5aSn6YeR6aKd57qi5YyFCgogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmJhY2tfdG8ocmVzKTsKICAgICAgICB9CiAgICAgIH0pLmZpbmFsbHkoKCkgPT4gewogICAgICAgIHRoaXMuJFRvYXN0LmNsZWFyKCk7CiAgICAgIH0pOwogICAgfSwKCiAgICAvLyDojrflj5bmtLvliqjljaHliLjor6bmg4UKICAgIGdldENvdXBEZXRhaWwoKSB7CiAgICAgIHJldHVybiB0aGlzLiRhcGkuYWN0X2NhcmRfZGV0YWlsKHsKICAgICAgICBjYXJkSWQ6IHRoaXMuY2FyZElkLAogICAgICAgIGRldGFpbElkOiB0aGlzLmRldGFpbElkLAogICAgICAgIGFjdFNuOiB0aGlzLm9wdGlvbnMuYWN0U24KICAgICAgfSkudGhlbihyZXMgPT4gewogICAgICAgIGlmIChyZXMuc3RhdGUpIHsKICAgICAgICAgIHRoaXMuaW5mbyA9IHsgLi4udGhpcy5pbmZvLAogICAgICAgICAgICAuLi5yZXMuaW5mbwogICAgICAgICAgfTsKICAgICAgICAgIHRoaXMubWVkaWFMaXN0ID0gcmVzLmluZm8ubWVkaWFMaXN0OwoKICAgICAgICAgIGlmIChyZXMuaW5mby5zaG9wU2hvdykgewogICAgICAgICAgICB0aGlzLmdldFN1aXRTaG9wcygpOwogICAgICAgICAgfSAvLyDoh6rmiJHmuLjljaHliLjml7bllYblrrbor6bmg4XmmL7npLrkuLrlm77mlofor6bmg4UKCgogICAgICAgICAgaWYgKHRoaXMuaW5mby5kZXNjcmliZSkgewogICAgICAgICAgICB0aGlzLmdyYXBoaWNEZXRhaWwgPSB0aGlzLmluZm8uZGVzY3JpYmU7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5nZXRGaXhlZERldGFpbChyZXMuaW5mby5zaG9wU24pOyAvLyDojrflj5bllYblrrbor6bmg4UKICAgICAgICB9IGVsc2Ugey8vIHRoaXMuYmFja190byhyZXMpCiAgICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKCiAgICAvLyDnibnljZbmtLvliqjnibnmnInkv6Hmga8KICAgIGdldFNwZWNpYWxJbmZvKCkgewogICAgICByZXR1cm4gdGhpcy4kYXBpLnNwZWNpYWxfc2VsbF9pbmZvKHsKICAgICAgICBjaGFubmVsVHlwZTogdGhpcy5vcHRpb25zLmNoYW5uZWxUeXBlIHx8ICcnLAogICAgICAgIHFyQ29kZTogdGhpcy5vcHRpb25zLnFyQ29kZSB8fCAnJywKICAgICAgICBhY3RTbjogdGhpcy5vcHRpb25zLmFjdFNuCiAgICAgIH0pLnRoZW4ocmVzID0+IHsKICAgICAgICBjb25zb2xlLmxvZygnc3BlY2lhbF9zZWxsX2luZm8nLCByZXMuaW5mbyk7CgogICAgICAgIGlmIChyZXMuc3RhdGUpIHsKICAgICAgICAgIHRoaXMuY2FyZElkID0gcmVzLmluZm8uY2FyZElkLCB0aGlzLmRldGFpbElkID0gcmVzLmluZm8uZGV0YWlsSWQ7CiAgICAgICAgICB0aGlzLmluZm8gPSB7IC4uLnRoaXMuaW5mbywKICAgICAgICAgICAgLi4ucmVzLmluZm8KICAgICAgICAgIH07CiAgICAgICAgfSBlbHNlIHsvLyB0aGlzLmJhY2tfdG8ocmVzKQogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAoKICAgIC8vIOiOt+WPluWVhuWutuWbuuWumuS/oeaBrwogICAgZ2V0Rml4ZWREZXRhaWwoc2hvcFNuKSB7CiAgICAgIHRoaXMuJGFwaS5zaG9wX2ZpeGVkX2RldGFpbCh7CiAgICAgICAgc2hvcFNuLAogICAgICAgIGxhdDogdGhpcy5sb2NhdGlvbkluZm8ubGF0aXR1ZGUsCiAgICAgICAgbG5nOiB0aGlzLmxvY2F0aW9uSW5mby5sb25naXR1ZGUKICAgICAgfSkudGhlbihyZXMgPT4gewogICAgICAgIGlmIChyZXMuc3RhdGUpIHsKICAgICAgICAgIHRoaXMuZml4ZWREZXRhaWwgPSByZXMuaW5mby5zaG9wOwoKICAgICAgICAgIGlmICghdGhpcy5pbmZvLmRlc2NyaWJlKSB7CiAgICAgICAgICAgIHRoaXMuZ3JhcGhpY0RldGFpbCA9IHJlcy5pbmZvLnNob3AuZGV0YWlsOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAoKICAgIC8vIOWFs+mXree6ouWMheWIl+ihqAogICAgY29sc2VjYXNoTWFzaygpIHsKICAgICAgdGhpcy5jYXNoTWFzayA9ICF0aGlzLmNhc2hNYXNrOwogICAgfSwKCiAgICAvLyDojrflj5bmtLvliqjnuqLljIXlvZPliY3kuqvnlKjmnIDlpKfnuqLljIUKICAgIGdldENhc2hOdW0oKSB7CiAgICAgIHRoaXMuJFRvYXN0LmxvYWRpbmcoewogICAgICAgIG1lc3NhZ2U6ICfliqDovb3kuK0uLi4nLAogICAgICAgIGZvcmJpZENsaWNrOiB0cnVlLAogICAgICAgIGR1cmF0aW9uOiAwCiAgICAgIH0pOwogICAgICBsZXQgdmlwX2NoZWNrID0gIXRoaXMudmlwVXNlciAmJiB0aGlzLmluZm8uYnV5TGltaXQgPT0gMiA/IHRydWUgOiBmYWxzZTsKICAgICAgbGV0IHByaWNlID0gdGhpcy5pbmZvLmJ1eUxpbWl0ID09IDIgfHwgdGhpcy52aXBVc2VyID8gdGhpcy5pbmZvLnNlbGxQcmljZSA6IHRoaXMuaW5mby5ub1ZpcFByaWNlOwogICAgICB0aGlzLiRhcGkuY2FzaF9yZWRfbGlzdCh7CiAgICAgICAgYWN0U246IHRoaXMub3B0aW9ucy5hY3RTbiwKICAgICAgICBjaXR5SWQ6IHRoaXMubG9jYXRpb25DaXR5LmNpdHlJZCwKICAgICAgICBvcGVuVmlwOiB2aXBfY2hlY2ssCiAgICAgICAgLy8g5piv5ZCm5Yu+6YCJ5Lya5ZGY5Y2hCiAgICAgICAgdmlwRmVlOiB2aXBfY2hlY2sgPyB0aGlzLnZpcEZlZSA6IDAsCiAgICAgICAgLy8g5Lya5ZGY5Y2h6YeR6aKdCiAgICAgICAgYWN0RmVlOiBwcmljZSwKICAgICAgICAvLyDmtLvliqjph5Hpop0KICAgICAgICBjYXJkSWQ6IHRoaXMuaW5mby5jYXJkSWQgLy8g54m55Y2W5Y2h5Yi4aWQgfHwg56S85YyF5Lyg56m6CgogICAgICB9KS50aGVuKHJlcyA9PiB7CiAgICAgICAgaWYgKHJlcy5zdGF0ZSkgewogICAgICAgICAgbGV0IHJlZExpc3QgPSByZXMuaW5mby5jYXNoUmVkTGlzdCB8fCBbXTsKICAgICAgICAgIGxldCBjb25zdW1lckNvdXBvbkxpc3QgPSByZXMuaW5mby5jb25zdW1lckNvdXBvbkxpc3QgfHwgW107CiAgICAgICAgICBsZXQgdXNhYmxlTGlzdCA9IHJlZExpc3QuZmlsdGVyKGl0ZW0gPT4gaXRlbS5jdXJyZW50QWJsZVVzZSk7IC8vIOi/h+a7pOWPr+eUqOe6ouWMhQoKICAgICAgICAgIGxldCBzb3J0VXNhYmxlTGlzdCA9IHVzYWJsZUxpc3Quc29ydChmdW5jdGlvbiAoYSwgYikgewogICAgICAgICAgICAvLyDpmY3luo/mjpLluo8KICAgICAgICAgICAgcmV0dXJuIGIubW9uZXkgLSBhLm1vbmV5OwogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLnNlbENhc2hyZWQgPSBzb3J0VXNhYmxlTGlzdFswXTsgLy8g6YCJ5Lit5pyA5aSn57qi5YyFCgogICAgICAgICAgaWYgKGNvbnN1bWVyQ291cG9uTGlzdC5sZW5ndGgpIHsKICAgICAgICAgICAgdGhpcy5zZWxDb25zdW1lciA9IGNvbnN1bWVyQ291cG9uTGlzdFswXSB8fCB7fTsgLy8g6YCJ5Lit5raI6LS55Yi4CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KS5maW5hbGx5KCgpID0+IHsKICAgICAgICB0aGlzLiRUb2FzdC5jbGVhcigpOwogICAgICB9KTsKICAgIH0sCgogICAgLy8g6I635Y+W5Lya5ZGY5Y2h5pyA5L2O5Lu35qC8CiAgICB2aXBQcmljZSgpIHsKICAgICAgdGhpcy4kYXBpLnYxXzRfdmlwX2xvd1ByaWNlKHsKICAgICAgICB0b3BpY1R5cGU6IDEsCiAgICAgICAgdG9waWNTbjogdGhpcy5vcHRpb25zLmFjdFNuCiAgICAgIH0pLnRoZW4ocmVzID0+IHsKICAgICAgICBpZiAocmVzLnN0YXRlKSB7CiAgICAgICAgICB0aGlzLnZpcEZlZSA9IHJlcy5pbmZvID8gcmVzLmluZm8ubG93UHJpY2UgfHwgMCA6IDA7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCgogICAgLy8g5YWz6Zet57qi5YyF5by556qX5pe2CiAgICBoYXNDYWNoUmVkTGlzdCh7CiAgICAgIGRldGFpbAogICAgfSkgewogICAgICBpZiAoZGV0YWlsICYmIGRldGFpbC5sZW5ndGggPiAwKSB7CiAgICAgICAgLy8g6YeN5paw6K+35rGC57qi5YyF5o6l5Y+jCiAgICAgICAgLy8gdGhpcy5zZWxlY3RDb21wb25lbnQoJyNhY3RpdmVDYXNoJykuZ2V0Q2FzaExpc3QoKQogICAgICAgIHRoaXMuZ2V0Q2FzaE51bSgpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuc2hvd1BhZ2VNb2RlbCA9IHRydWU7CiAgICAgIH0KICAgIH0sCgogICAgLy8g6Ieq5oiR5ri45rS75Yqo6K+m5oOF6YCJ5oup5Lu35qC8CiAgICBzZWxEYXRlTGlzdChpdGVtKSB7CiAgICAgIGxldCBkYXRlID0gewogICAgICAgIHRleHQ6IGl0ZW0uZGF0ZS5zdWJzdHIoMCwgNiksCiAgICAgICAgbW9udGg6IGl0ZW0uZGF0ZS5zdWJzdHIoNCwgMiksCiAgICAgICAgeWVhcjogaXRlbS5kYXRlLnN1YnN0cigwLCA0KSwKICAgICAgICBkYXk6IGl0ZW0uZGF0ZS5zdWJzdHIoNiwgMikKICAgICAgfTsKICAgICAgdGhpcy4kcmVmcy5jYWxlbmRhci5zaG93Q2FsZW5kYXJEYXRhKGRhdGUpOwogICAgICB0aGlzLm9wZW5DYWxlbmRhcigpOyAvLyDmmL7npLrml6XljoblvLnnqpcKICAgIH0sCgogICAgb3BlbkNhbGVuZGFyKCkgewogICAgICB0aGlzLmNhbGVuZGFyTWFzayA9IHRydWU7CiAgICB9LAoKICAgIGdldFRyYXZlbE1vbnRoSW5mbyhkZXRhaWwpIHsKICAgICAgLy8g5o6l5pS25pel5Y6G5L+h5oGvCiAgICAgIGlmIChkZXRhaWwuZGF0YVR5cGUgPT0gJ2luaXQnKSB7CiAgICAgICAgLy8g5pel5Y6G5Yid5aeL5YyW5pWw5o2uCiAgICAgICAgdGhpcy50cmF2ZWxNb250aEluZm8gPSBkZXRhaWw7CgogICAgICAgIGlmIChkZXRhaWwudW5hYmxlQnV5KSB7CiAgICAgICAgICB0aGlzLmhhbmRsZXJCdG4oJ+W9k+WJjeS4jeWPr+i0reS5sCcsIHRydWUpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChkZXRhaWwuZGF0YVR5cGUgPT0gJ3NlbERhdGUnKSB7CiAgICAgICAgLy8g6YCJ5oup5pel5Y6G5L+h5oGvCiAgICAgICAgbGV0IGluZm8gPSB0aGlzLmluZm87CiAgICAgICAgaW5mby5zZWxsUHJpY2UgPSBkZXRhaWwuc2VsbFByaWNlOwogICAgICAgIGluZm8ubm9WaXBQcmljZSA9IGRldGFpbC5ub1ZpcFByaWNlOwogICAgICAgIHRoaXMuaW5mbyA9IGluZm87CiAgICAgICAgdGhpcy5zZWxEYXRlID0gZGV0YWlsOwogICAgICB9CiAgICB9LAoKICAgIGdldFJlY2VpdmVDb25kaXRpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLiRhcGkucmVjZWl2ZV9jb25kaXRpb24oewogICAgICAgIGFjdFNuOiB0aGlzLm9wdGlvbnMuYWN0U24KICAgICAgfSkudGhlbihyZXMgPT4gewogICAgICAgIGlmIChyZXMuc3RhdGUpIHsKICAgICAgICAgIHRoaXMuY29uZGl0aW9uSW5mbyA9IHJlcy5pbmZvOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CgogIH0sCgogIGNyZWF0ZWQoKSB7CiAgICBjb25zdCBvcHRpb25zID0gdGhpcy4kcm91dGUucXVlcnk7CiAgICBvcHRpb25zLmhhc0V4Y2hhbmdlID0gb3B0aW9ucy5oYXNFeGNoYW5nZSB8fCAnJzsKICAgIG9wdGlvbnMudHlwZSA9IG9wdGlvbnMudHlwZSB8fCAnJzsKICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7CgogICAgaWYgKG9wdGlvbnMucG9wdXApIHsKICAgICAgdGhpcy4kZGlhbG9nLmFsZXJ0KHsKICAgICAgICB0aXRsZTogJ+aPkOekuicsCiAgICAgICAgbWVzc2FnZTogJ+iuouWNlei2heaXtuW3suWPlua2iO+8jOivt+mHjeaWsOS4i+WNlScsCiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnoa7lrponLAogICAgICAgIGNvbmZpcm1CdXR0b25Db2xvcjogJyNEOTA2MzQnCiAgICAgIH0pOwogICAgfQoKICAgIHRoaXMuZ2V0QWN0RGV0YWlsKHRydWUpOwogICAgdGhpcy52aXBQcmljZSgpOwoKICAgIGlmICh0aGlzLm9wdGlvbnMuaGFzRXhjaGFuZ2UgIT0gJycpIHsKICAgICAgLy8g5Yik5pat5Li65YWR5o2i5Lit5b+D6L+b5YWlCiAgICAgIHRoaXMuZXhjaGFuZ2VfZGF0YSA9IHRoaXMuJHNhdmUuZ2V0KCdzZXNzaW9uJywgJ2V4Y2hhbmdlX2RhdGEnKTsgLy8g5YWR5o2i5Lit5b+D5rS75Yqo5pWw5o2uCiAgICB9CgogICAgdGhpcy5nZXRSZWNlaXZlQ29uZGl0aW9uKCk7IC8vIOaYr+WQpumcgOimgeWhq+WGmeeUqOaIt+S/oeaBr+WPiuWFtuadoeS7tgoKICAgIHRoaXMubmVlZEF1dGggPSB0aGlzLm5lZWRBdXRoOwogICAgdGhpcy5nZXRGcmVlQmFnID0gdGhpcy5nZXRGcmVlQmFnOwogICAgdGhpcy52aXBVc2VyID0gdGhpcy52aXBDYXJkSW5mby52aXBVc2VyOwogICAgdGhpcy5zZWxDYXNocmVkID0ge307CgogICAgaWYgKHRoaXMuYWN0RGV0YWxVcGRhdGUpIHsKICAgICAgLy8g5Yi35paw5rS75Yqo5pWw5o2uCiAgICAgIHRoaXMuZ2V0QWN0RGV0YWlsKHRydWUpOwogICAgICB0aGlzLmFjdERldGFsVXBkYXRlID0gZmFsc2U7CiAgICB9IC8vIOa0u+WKqOS7t+agvOWIt+aWsAoKCiAgICBpZiAodGhpcy51cGRhdGVGbGFnKSB7CiAgICAgIHRoaXMucmVmcmVzaCA9IHRydWU7CiAgICB9IC8vIOeUqOaIt+S/oeaBr+aVsOaNrgoKCiAgICBsZXQgdHJhdmVsSW5mb3JtYXRpb24gPSB0aGlzLiRzYXZlLmdldCgnc2Vzc2lvbicsICd0cmF2ZWxJbmZvcm1hdGlvbicpOwoKICAgIGlmICh0cmF2ZWxJbmZvcm1hdGlvbikgewogICAgICB0aGlzLnRyYWN2ZWxVc2VyTGlzdCA9IHRyYXZlbEluZm9ybWF0aW9uLmZvcm1MaXN0OwogICAgICB0aGlzLnNlbERhdGUgPSB0cmF2ZWxJbmZvcm1hdGlvbi5zZWxEYXRlOwoKICAgICAgaWYgKHRoaXMub3B0aW9ucy5oYXNFeGNoYW5nZSAhPSAnJykgewogICAgICAgIHRoaXMuZXhjaGFuZ2UoKTsKICAgICAgfSBlbHNlIGlmICh0aGlzLmZyZWUpIHsKICAgICAgICAvLyDlhY3otLnpooblj5YKICAgICAgICB0aGlzLmdldEZyZWUoKTsKICAgICAgfQogICAgfQogIH0sCgogIGFjdGl2YXRlZCgpIHt9LAoKICBkZXN0cm95ZWQoKSB7CiAgICAvLyDmuIXpmaTnlKjmiLfloavlhpnkv6Hmga8KICAgIHRoaXMuJHNhdmUucmVtb3ZlQXJyKCdzZXNzaW9uJywgWyd0cmF2ZWxJbmZvcm1hdGlvbicsICd1cGRhdGVGbGFnJ10pOwogIH0KCn07CmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0Ow=="},null]}