{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\thread-loader\\dist\\cjs.js!C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\src\\plugins\\wxqrcode.js","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\src\\plugins\\wxqrcode.js","mtime":1597889072490},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\vip_inline_h5\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5kZXgtb2YiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcubWF0Y2giOwoKLyoqDQogKiBxcmNvZGUNCiAqIEBwYXJhbSB0eXBlTnVtYmVyIDEgdG8gNDANCiAqIEBwYXJhbSBlcnJvckNvcnJlY3RMZXZlbCAnTCcsJ00nLCdRJywnSCcNCiAqLwp2YXIgcXJjb2RlID0gZnVuY3Rpb24gcXJjb2RlKHR5cGVOdW1iZXIsIGVycm9yQ29ycmVjdExldmVsKSB7CiAgdmFyIFBBRDAgPSAweEVDOwogIHZhciBQQUQxID0gMHgxMTsKICB2YXIgX3R5cGVOdW1iZXIgPSB0eXBlTnVtYmVyOwogIHZhciBfZXJyb3JDb3JyZWN0TGV2ZWwgPSBRUkVycm9yQ29ycmVjdExldmVsW2Vycm9yQ29ycmVjdExldmVsXTsKICB2YXIgX21vZHVsZXMgPSBudWxsOwogIHZhciBfbW9kdWxlQ291bnQgPSAwOwogIHZhciBfZGF0YUNhY2hlID0gbnVsbDsKCiAgdmFyIF9kYXRhTGlzdCA9IG5ldyBBcnJheSgpOwoKICB2YXIgX3RoaXMgPSB7fTsKCiAgdmFyIG1ha2VJbXBsID0gZnVuY3Rpb24gbWFrZUltcGwodGVzdCwgbWFza1BhdHRlcm4pIHsKICAgIF9tb2R1bGVDb3VudCA9IF90eXBlTnVtYmVyICogNCArIDE3OwoKICAgIF9tb2R1bGVzID0gZnVuY3Rpb24gKG1vZHVsZUNvdW50KSB7CiAgICAgIHZhciBtb2R1bGVzID0gbmV3IEFycmF5KG1vZHVsZUNvdW50KTsKCiAgICAgIGZvciAodmFyIHJvdyA9IDA7IHJvdyA8IG1vZHVsZUNvdW50OyByb3cgKz0gMSkgewogICAgICAgIG1vZHVsZXNbcm93XSA9IG5ldyBBcnJheShtb2R1bGVDb3VudCk7CgogICAgICAgIGZvciAodmFyIGNvbCA9IDA7IGNvbCA8IG1vZHVsZUNvdW50OyBjb2wgKz0gMSkgewogICAgICAgICAgbW9kdWxlc1tyb3ddW2NvbF0gPSBudWxsOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIG1vZHVsZXM7CiAgICB9KF9tb2R1bGVDb3VudCk7CgogICAgc2V0dXBQb3NpdGlvblByb2JlUGF0dGVybigwLCAwKTsKICAgIHNldHVwUG9zaXRpb25Qcm9iZVBhdHRlcm4oX21vZHVsZUNvdW50IC0gNywgMCk7CiAgICBzZXR1cFBvc2l0aW9uUHJvYmVQYXR0ZXJuKDAsIF9tb2R1bGVDb3VudCAtIDcpOwogICAgc2V0dXBQb3NpdGlvbkFkanVzdFBhdHRlcm4oKTsKICAgIHNldHVwVGltaW5nUGF0dGVybigpOwogICAgc2V0dXBUeXBlSW5mbyh0ZXN0LCBtYXNrUGF0dGVybik7CgogICAgaWYgKF90eXBlTnVtYmVyID49IDcpIHsKICAgICAgc2V0dXBUeXBlTnVtYmVyKHRlc3QpOwogICAgfQoKICAgIGlmIChfZGF0YUNhY2hlID09IG51bGwpIHsKICAgICAgX2RhdGFDYWNoZSA9IGNyZWF0ZURhdGEoX3R5cGVOdW1iZXIsIF9lcnJvckNvcnJlY3RMZXZlbCwgX2RhdGFMaXN0KTsKICAgIH0KCiAgICBtYXBEYXRhKF9kYXRhQ2FjaGUsIG1hc2tQYXR0ZXJuKTsKICB9OwoKICB2YXIgc2V0dXBQb3NpdGlvblByb2JlUGF0dGVybiA9IGZ1bmN0aW9uIHNldHVwUG9zaXRpb25Qcm9iZVBhdHRlcm4ocm93LCBjb2wpIHsKICAgIGZvciAodmFyIHIgPSAtMTsgciA8PSA3OyByICs9IDEpIHsKICAgICAgaWYgKHJvdyArIHIgPD0gLTEgfHwgX21vZHVsZUNvdW50IDw9IHJvdyArIHIpIGNvbnRpbnVlOwoKICAgICAgZm9yICh2YXIgYyA9IC0xOyBjIDw9IDc7IGMgKz0gMSkgewogICAgICAgIGlmIChjb2wgKyBjIDw9IC0xIHx8IF9tb2R1bGVDb3VudCA8PSBjb2wgKyBjKSBjb250aW51ZTsKCiAgICAgICAgaWYgKDAgPD0gciAmJiByIDw9IDYgJiYgKGMgPT0gMCB8fCBjID09IDYpIHx8IDAgPD0gYyAmJiBjIDw9IDYgJiYgKHIgPT0gMCB8fCByID09IDYpIHx8IDIgPD0gciAmJiByIDw9IDQgJiYgMiA8PSBjICYmIGMgPD0gNCkgewogICAgICAgICAgX21vZHVsZXNbcm93ICsgcl1bY29sICsgY10gPSB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBfbW9kdWxlc1tyb3cgKyByXVtjb2wgKyBjXSA9IGZhbHNlOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH07CgogIHZhciBnZXRCZXN0TWFza1BhdHRlcm4gPSBmdW5jdGlvbiBnZXRCZXN0TWFza1BhdHRlcm4oKSB7CiAgICB2YXIgbWluTG9zdFBvaW50ID0gMDsKICAgIHZhciBwYXR0ZXJuID0gMDsKCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IDg7IGkgKz0gMSkgewogICAgICBtYWtlSW1wbCh0cnVlLCBpKTsKICAgICAgdmFyIGxvc3RQb2ludCA9IFFSVXRpbC5nZXRMb3N0UG9pbnQoX3RoaXMpOwoKICAgICAgaWYgKGkgPT0gMCB8fCBtaW5Mb3N0UG9pbnQgPiBsb3N0UG9pbnQpIHsKICAgICAgICBtaW5Mb3N0UG9pbnQgPSBsb3N0UG9pbnQ7CiAgICAgICAgcGF0dGVybiA9IGk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gcGF0dGVybjsKICB9OwoKICB2YXIgc2V0dXBUaW1pbmdQYXR0ZXJuID0gZnVuY3Rpb24gc2V0dXBUaW1pbmdQYXR0ZXJuKCkgewogICAgZm9yICh2YXIgciA9IDg7IHIgPCBfbW9kdWxlQ291bnQgLSA4OyByICs9IDEpIHsKICAgICAgaWYgKF9tb2R1bGVzW3JdWzZdICE9IG51bGwpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgX21vZHVsZXNbcl1bNl0gPSByICUgMiA9PSAwOwogICAgfQoKICAgIGZvciAodmFyIGMgPSA4OyBjIDwgX21vZHVsZUNvdW50IC0gODsgYyArPSAxKSB7CiAgICAgIGlmIChfbW9kdWxlc1s2XVtjXSAhPSBudWxsKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIF9tb2R1bGVzWzZdW2NdID0gYyAlIDIgPT0gMDsKICAgIH0KICB9OwoKICB2YXIgc2V0dXBQb3NpdGlvbkFkanVzdFBhdHRlcm4gPSBmdW5jdGlvbiBzZXR1cFBvc2l0aW9uQWRqdXN0UGF0dGVybigpIHsKICAgIHZhciBwb3MgPSBRUlV0aWwuZ2V0UGF0dGVyblBvc2l0aW9uKF90eXBlTnVtYmVyKTsKCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBvcy5sZW5ndGg7IGkgKz0gMSkgewogICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHBvcy5sZW5ndGg7IGogKz0gMSkgewogICAgICAgIHZhciByb3cgPSBwb3NbaV07CiAgICAgICAgdmFyIGNvbCA9IHBvc1tqXTsKCiAgICAgICAgaWYgKF9tb2R1bGVzW3Jvd11bY29sXSAhPSBudWxsKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGZvciAodmFyIHIgPSAtMjsgciA8PSAyOyByICs9IDEpIHsKICAgICAgICAgIGZvciAodmFyIGMgPSAtMjsgYyA8PSAyOyBjICs9IDEpIHsKICAgICAgICAgICAgaWYgKHIgPT0gLTIgfHwgciA9PSAyIHx8IGMgPT0gLTIgfHwgYyA9PSAyIHx8IHIgPT0gMCAmJiBjID09IDApIHsKICAgICAgICAgICAgICBfbW9kdWxlc1tyb3cgKyByXVtjb2wgKyBjXSA9IHRydWU7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgX21vZHVsZXNbcm93ICsgcl1bY29sICsgY10gPSBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogIH07CgogIHZhciBzZXR1cFR5cGVOdW1iZXIgPSBmdW5jdGlvbiBzZXR1cFR5cGVOdW1iZXIodGVzdCkgewogICAgdmFyIGJpdHMgPSBRUlV0aWwuZ2V0QkNIVHlwZU51bWJlcihfdHlwZU51bWJlcik7CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxODsgaSArPSAxKSB7CiAgICAgIHZhciBtb2QgPSAhdGVzdCAmJiAoYml0cyA+PiBpICYgMSkgPT0gMTsKICAgICAgX21vZHVsZXNbTWF0aC5mbG9vcihpIC8gMyldW2kgJSAzICsgX21vZHVsZUNvdW50IC0gOCAtIDNdID0gbW9kOwogICAgfQoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMTg7IGkgKz0gMSkgewogICAgICB2YXIgbW9kID0gIXRlc3QgJiYgKGJpdHMgPj4gaSAmIDEpID09IDE7CiAgICAgIF9tb2R1bGVzW2kgJSAzICsgX21vZHVsZUNvdW50IC0gOCAtIDNdW01hdGguZmxvb3IoaSAvIDMpXSA9IG1vZDsKICAgIH0KICB9OwoKICB2YXIgc2V0dXBUeXBlSW5mbyA9IGZ1bmN0aW9uIHNldHVwVHlwZUluZm8odGVzdCwgbWFza1BhdHRlcm4pIHsKICAgIHZhciBkYXRhID0gX2Vycm9yQ29ycmVjdExldmVsIDw8IDMgfCBtYXNrUGF0dGVybjsKICAgIHZhciBiaXRzID0gUVJVdGlsLmdldEJDSFR5cGVJbmZvKGRhdGEpOwogICAgLyoqdmVydGljYWwgKi8KCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IDE1OyBpICs9IDEpIHsKICAgICAgdmFyIG1vZCA9ICF0ZXN0ICYmIChiaXRzID4+IGkgJiAxKSA9PSAxOwoKICAgICAgaWYgKGkgPCA2KSB7CiAgICAgICAgX21vZHVsZXNbaV1bOF0gPSBtb2Q7CiAgICAgIH0gZWxzZSBpZiAoaSA8IDgpIHsKICAgICAgICBfbW9kdWxlc1tpICsgMV1bOF0gPSBtb2Q7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgX21vZHVsZXNbX21vZHVsZUNvdW50IC0gMTUgKyBpXVs4XSA9IG1vZDsKICAgICAgfQogICAgfQogICAgLyoqaG9yaXpvbnRhbCAqLwoKCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IDE1OyBpICs9IDEpIHsKICAgICAgdmFyIG1vZCA9ICF0ZXN0ICYmIChiaXRzID4+IGkgJiAxKSA9PSAxOwoKICAgICAgaWYgKGkgPCA4KSB7CiAgICAgICAgX21vZHVsZXNbOF1bX21vZHVsZUNvdW50IC0gaSAtIDFdID0gbW9kOwogICAgICB9IGVsc2UgaWYgKGkgPCA5KSB7CiAgICAgICAgX21vZHVsZXNbOF1bMTUgLSBpIC0gMSArIDFdID0gbW9kOwogICAgICB9IGVsc2UgewogICAgICAgIF9tb2R1bGVzWzhdWzE1IC0gaSAtIDFdID0gbW9kOwogICAgICB9CiAgICB9CiAgICAvKipmaXhlZCBtb2R1bGUgKi8KCgogICAgX21vZHVsZXNbX21vZHVsZUNvdW50IC0gOF1bOF0gPSAhdGVzdDsKICB9OwoKICB2YXIgbWFwRGF0YSA9IGZ1bmN0aW9uIG1hcERhdGEoZGF0YSwgbWFza1BhdHRlcm4pIHsKICAgIHZhciBpbmMgPSAtMTsKICAgIHZhciByb3cgPSBfbW9kdWxlQ291bnQgLSAxOwogICAgdmFyIGJpdEluZGV4ID0gNzsKICAgIHZhciBieXRlSW5kZXggPSAwOwogICAgdmFyIG1hc2tGdW5jID0gUVJVdGlsLmdldE1hc2tGdW5jdGlvbihtYXNrUGF0dGVybik7CgogICAgZm9yICh2YXIgY29sID0gX21vZHVsZUNvdW50IC0gMTsgY29sID4gMDsgY29sIC09IDIpIHsKICAgICAgaWYgKGNvbCA9PSA2KSBjb2wgLT0gMTsKCiAgICAgIHdoaWxlICh0cnVlKSB7CiAgICAgICAgZm9yICh2YXIgYyA9IDA7IGMgPCAyOyBjICs9IDEpIHsKICAgICAgICAgIGlmIChfbW9kdWxlc1tyb3ddW2NvbCAtIGNdID09IG51bGwpIHsKICAgICAgICAgICAgdmFyIGRhcmsgPSBmYWxzZTsKCiAgICAgICAgICAgIGlmIChieXRlSW5kZXggPCBkYXRhLmxlbmd0aCkgewogICAgICAgICAgICAgIGRhcmsgPSAoZGF0YVtieXRlSW5kZXhdID4+PiBiaXRJbmRleCAmIDEpID09IDE7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHZhciBtYXNrID0gbWFza0Z1bmMocm93LCBjb2wgLSBjKTsKCiAgICAgICAgICAgIGlmIChtYXNrKSB7CiAgICAgICAgICAgICAgZGFyayA9ICFkYXJrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBfbW9kdWxlc1tyb3ddW2NvbCAtIGNdID0gZGFyazsKICAgICAgICAgICAgYml0SW5kZXggLT0gMTsKCiAgICAgICAgICAgIGlmIChiaXRJbmRleCA9PSAtMSkgewogICAgICAgICAgICAgIGJ5dGVJbmRleCArPSAxOwogICAgICAgICAgICAgIGJpdEluZGV4ID0gNzsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcm93ICs9IGluYzsKCiAgICAgICAgaWYgKHJvdyA8IDAgfHwgX21vZHVsZUNvdW50IDw9IHJvdykgewogICAgICAgICAgcm93IC09IGluYzsKICAgICAgICAgIGluYyA9IC1pbmM7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9OwoKICB2YXIgY3JlYXRlQnl0ZXMgPSBmdW5jdGlvbiBjcmVhdGVCeXRlcyhidWZmZXIsIHJzQmxvY2tzKSB7CiAgICB2YXIgb2Zmc2V0ID0gMDsKICAgIHZhciBtYXhEY0NvdW50ID0gMDsKICAgIHZhciBtYXhFY0NvdW50ID0gMDsKICAgIHZhciBkY2RhdGEgPSBuZXcgQXJyYXkocnNCbG9ja3MubGVuZ3RoKTsKICAgIHZhciBlY2RhdGEgPSBuZXcgQXJyYXkocnNCbG9ja3MubGVuZ3RoKTsKCiAgICBmb3IgKHZhciByID0gMDsgciA8IHJzQmxvY2tzLmxlbmd0aDsgciArPSAxKSB7CiAgICAgIHZhciBkY0NvdW50ID0gcnNCbG9ja3Nbcl0uZGF0YUNvdW50OwogICAgICB2YXIgZWNDb3VudCA9IHJzQmxvY2tzW3JdLnRvdGFsQ291bnQgLSBkY0NvdW50OwogICAgICBtYXhEY0NvdW50ID0gTWF0aC5tYXgobWF4RGNDb3VudCwgZGNDb3VudCk7CiAgICAgIG1heEVjQ291bnQgPSBNYXRoLm1heChtYXhFY0NvdW50LCBlY0NvdW50KTsKICAgICAgZGNkYXRhW3JdID0gbmV3IEFycmF5KGRjQ291bnQpOwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkY2RhdGFbcl0ubGVuZ3RoOyBpICs9IDEpIHsKICAgICAgICBkY2RhdGFbcl1baV0gPSAweGZmICYgYnVmZmVyLmdldEJ1ZmZlcigpW2kgKyBvZmZzZXRdOwogICAgICB9CgogICAgICBvZmZzZXQgKz0gZGNDb3VudDsKICAgICAgdmFyIHJzUG9seSA9IFFSVXRpbC5nZXRFcnJvckNvcnJlY3RQb2x5bm9taWFsKGVjQ291bnQpOwogICAgICB2YXIgcmF3UG9seSA9IHFyUG9seW5vbWlhbChkY2RhdGFbcl0sIHJzUG9seS5nZXRMZW5ndGgoKSAtIDEpOwogICAgICB2YXIgbW9kUG9seSA9IHJhd1BvbHkubW9kKHJzUG9seSk7CiAgICAgIGVjZGF0YVtyXSA9IG5ldyBBcnJheShyc1BvbHkuZ2V0TGVuZ3RoKCkgLSAxKTsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZWNkYXRhW3JdLmxlbmd0aDsgaSArPSAxKSB7CiAgICAgICAgdmFyIG1vZEluZGV4ID0gaSArIG1vZFBvbHkuZ2V0TGVuZ3RoKCkgLSBlY2RhdGFbcl0ubGVuZ3RoOwogICAgICAgIGVjZGF0YVtyXVtpXSA9IG1vZEluZGV4ID49IDAgPyBtb2RQb2x5LmdldEF0KG1vZEluZGV4KSA6IDA7CiAgICAgIH0KICAgIH0KCiAgICB2YXIgdG90YWxDb2RlQ291bnQgPSAwOwoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcnNCbG9ja3MubGVuZ3RoOyBpICs9IDEpIHsKICAgICAgdG90YWxDb2RlQ291bnQgKz0gcnNCbG9ja3NbaV0udG90YWxDb3VudDsKICAgIH0KCiAgICB2YXIgZGF0YSA9IG5ldyBBcnJheSh0b3RhbENvZGVDb3VudCk7CiAgICB2YXIgaW5kZXggPSAwOwoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWF4RGNDb3VudDsgaSArPSAxKSB7CiAgICAgIGZvciAodmFyIHIgPSAwOyByIDwgcnNCbG9ja3MubGVuZ3RoOyByICs9IDEpIHsKICAgICAgICBpZiAoaSA8IGRjZGF0YVtyXS5sZW5ndGgpIHsKICAgICAgICAgIGRhdGFbaW5kZXhdID0gZGNkYXRhW3JdW2ldOwogICAgICAgICAgaW5kZXggKz0gMTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1heEVjQ291bnQ7IGkgKz0gMSkgewogICAgICBmb3IgKHZhciByID0gMDsgciA8IHJzQmxvY2tzLmxlbmd0aDsgciArPSAxKSB7CiAgICAgICAgaWYgKGkgPCBlY2RhdGFbcl0ubGVuZ3RoKSB7CiAgICAgICAgICBkYXRhW2luZGV4XSA9IGVjZGF0YVtyXVtpXTsKICAgICAgICAgIGluZGV4ICs9IDE7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgcmV0dXJuIGRhdGE7CiAgfTsKCiAgdmFyIGNyZWF0ZURhdGEgPSBmdW5jdGlvbiBjcmVhdGVEYXRhKHR5cGVOdW1iZXIsIGVycm9yQ29ycmVjdExldmVsLCBkYXRhTGlzdCkgewogICAgdmFyIHJzQmxvY2tzID0gUVJSU0Jsb2NrLmdldFJTQmxvY2tzKHR5cGVOdW1iZXIsIGVycm9yQ29ycmVjdExldmVsKTsKICAgIHZhciBidWZmZXIgPSBxckJpdEJ1ZmZlcigpOwoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YUxpc3QubGVuZ3RoOyBpICs9IDEpIHsKICAgICAgdmFyIGRhdGEgPSBkYXRhTGlzdFtpXTsKICAgICAgYnVmZmVyLnB1dChkYXRhLmdldE1vZGUoKSwgNCk7CiAgICAgIGJ1ZmZlci5wdXQoZGF0YS5nZXRMZW5ndGgoKSwgUVJVdGlsLmdldExlbmd0aEluQml0cyhkYXRhLmdldE1vZGUoKSwgdHlwZU51bWJlcikpOwogICAgICBkYXRhLndyaXRlKGJ1ZmZlcik7CiAgICB9CiAgICAvKipjYWxjIG51bSBtYXggZGF0YS4gKi8KCgogICAgdmFyIHRvdGFsRGF0YUNvdW50ID0gMDsKCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJzQmxvY2tzLmxlbmd0aDsgaSArPSAxKSB7CiAgICAgIHRvdGFsRGF0YUNvdW50ICs9IHJzQmxvY2tzW2ldLmRhdGFDb3VudDsKICAgIH0KCiAgICBpZiAoYnVmZmVyLmdldExlbmd0aEluQml0cygpID4gdG90YWxEYXRhQ291bnQgKiA4KSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignY29kZSBsZW5ndGggb3ZlcmZsb3cuICgnICsgYnVmZmVyLmdldExlbmd0aEluQml0cygpICsgJz4nICsgdG90YWxEYXRhQ291bnQgKiA4ICsgJyknKTsKICAgIH0KICAgIC8qKmVuZCBjb2RlICovCgoKICAgIGlmIChidWZmZXIuZ2V0TGVuZ3RoSW5CaXRzKCkgKyA0IDw9IHRvdGFsRGF0YUNvdW50ICogOCkgewogICAgICBidWZmZXIucHV0KDAsIDQpOwogICAgfQogICAgLyoqIHBhZGRpbmcgKi8KCgogICAgd2hpbGUgKGJ1ZmZlci5nZXRMZW5ndGhJbkJpdHMoKSAlIDggIT0gMCkgewogICAgICBidWZmZXIucHV0Qml0KGZhbHNlKTsKICAgIH0KICAgIC8qKnBhZGRpbmcgKi8KCgogICAgd2hpbGUgKHRydWUpIHsKICAgICAgaWYgKGJ1ZmZlci5nZXRMZW5ndGhJbkJpdHMoKSA+PSB0b3RhbERhdGFDb3VudCAqIDgpIHsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgYnVmZmVyLnB1dChQQUQwLCA4KTsKCiAgICAgIGlmIChidWZmZXIuZ2V0TGVuZ3RoSW5CaXRzKCkgPj0gdG90YWxEYXRhQ291bnQgKiA4KSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGJ1ZmZlci5wdXQoUEFEMSwgOCk7CiAgICB9CgogICAgcmV0dXJuIGNyZWF0ZUJ5dGVzKGJ1ZmZlciwgcnNCbG9ja3MpOwogIH07CgogIF90aGlzLmFkZERhdGEgPSBmdW5jdGlvbiAoZGF0YSkgewogICAgdmFyIG5ld0RhdGEgPSBxcjhCaXRCeXRlKGRhdGEpOwoKICAgIF9kYXRhTGlzdC5wdXNoKG5ld0RhdGEpOwoKICAgIF9kYXRhQ2FjaGUgPSBudWxsOwogIH07CgogIF90aGlzLmlzRGFyayA9IGZ1bmN0aW9uIChyb3csIGNvbCkgewogICAgaWYgKHJvdyA8IDAgfHwgX21vZHVsZUNvdW50IDw9IHJvdyB8fCBjb2wgPCAwIHx8IF9tb2R1bGVDb3VudCA8PSBjb2wpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKHJvdyArICcsJyArIGNvbCk7CiAgICB9CgogICAgcmV0dXJuIF9tb2R1bGVzW3Jvd11bY29sXTsKICB9OwoKICBfdGhpcy5nZXRNb2R1bGVDb3VudCA9IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiBfbW9kdWxlQ291bnQ7CiAgfTsKCiAgX3RoaXMubWFrZSA9IGZ1bmN0aW9uICgpIHsKICAgIG1ha2VJbXBsKGZhbHNlLCBnZXRCZXN0TWFza1BhdHRlcm4oKSk7CiAgfTsKCiAgX3RoaXMuY3JlYXRlVGFibGVUYWcgPSBmdW5jdGlvbiAoY2VsbFNpemUsIG1hcmdpbikgewogICAgY2VsbFNpemUgPSBjZWxsU2l6ZSB8fCAyOwogICAgbWFyZ2luID0gdHlwZW9mIG1hcmdpbiA9PSAndW5kZWZpbmVkJyA/IGNlbGxTaXplICogNCA6IG1hcmdpbjsKICAgIHZhciBxckh0bWwgPSAnJzsKICAgIHFySHRtbCArPSAnPHRhYmxlIHN0eWxlPSInOwogICAgcXJIdG1sICs9ICcgYm9yZGVyLXdpZHRoOiAwcHg7IGJvcmRlci1zdHlsZTogbm9uZTsnOwogICAgcXJIdG1sICs9ICcgYm9yZGVyLWNvbGxhcHNlOiBjb2xsYXBzZTsnOwogICAgcXJIdG1sICs9ICcgcGFkZGluZzogMHB4OyBtYXJnaW46ICcgKyBtYXJnaW4gKyAncHg7JzsKICAgIHFySHRtbCArPSAnIj4nOwogICAgcXJIdG1sICs9ICc8dGJvZHk+JzsKCiAgICBmb3IgKHZhciByID0gMDsgciA8IF90aGlzLmdldE1vZHVsZUNvdW50KCk7IHIgKz0gMSkgewogICAgICBxckh0bWwgKz0gJzx0cj4nOwoKICAgICAgZm9yICh2YXIgYyA9IDA7IGMgPCBfdGhpcy5nZXRNb2R1bGVDb3VudCgpOyBjICs9IDEpIHsKICAgICAgICBxckh0bWwgKz0gJzx0ZCBzdHlsZT0iJzsKICAgICAgICBxckh0bWwgKz0gJyBib3JkZXItd2lkdGg6IDBweDsgYm9yZGVyLXN0eWxlOiBub25lOyc7CiAgICAgICAgcXJIdG1sICs9ICcgYm9yZGVyLWNvbGxhcHNlOiBjb2xsYXBzZTsnOwogICAgICAgIHFySHRtbCArPSAnIHBhZGRpbmc6IDBweDsgbWFyZ2luOiAwcHg7JzsKICAgICAgICBxckh0bWwgKz0gJyB3aWR0aDogJyArIGNlbGxTaXplICsgJ3B4Oyc7CiAgICAgICAgcXJIdG1sICs9ICcgaGVpZ2h0OiAnICsgY2VsbFNpemUgKyAncHg7JzsKICAgICAgICBxckh0bWwgKz0gJyBiYWNrZ3JvdW5kLWNvbG9yOiAnOwogICAgICAgIHFySHRtbCArPSBfdGhpcy5pc0RhcmsociwgYykgPyAnIzAwMDAwMCcgOiAnI2ZmZmZmZic7CiAgICAgICAgcXJIdG1sICs9ICc7JzsKICAgICAgICBxckh0bWwgKz0gJyIvPic7CiAgICAgIH0KCiAgICAgIHFySHRtbCArPSAnPC90cj4nOwogICAgfQoKICAgIHFySHRtbCArPSAnPC90Ym9keT4nOwogICAgcXJIdG1sICs9ICc8L3RhYmxlPic7CiAgICByZXR1cm4gcXJIdG1sOwogIH07CgogIF90aGlzLmNyZWF0ZUltZ1RhZyA9IGZ1bmN0aW9uIChjZWxsU2l6ZSwgbWFyZ2luLCBzaXplKSB7CiAgICBjZWxsU2l6ZSA9IGNlbGxTaXplIHx8IDI7CiAgICBtYXJnaW4gPSB0eXBlb2YgbWFyZ2luID09ICd1bmRlZmluZWQnID8gY2VsbFNpemUgKiA0IDogbWFyZ2luOwogICAgdmFyIG1pbiA9IG1hcmdpbjsKICAgIHZhciBtYXggPSBfdGhpcy5nZXRNb2R1bGVDb3VudCgpICogY2VsbFNpemUgKyBtYXJnaW47CiAgICByZXR1cm4gY3JlYXRlSW1nVGFnKHNpemUsIHNpemUsIGZ1bmN0aW9uICh4LCB5KSB7CiAgICAgIGlmIChtaW4gPD0geCAmJiB4IDwgbWF4ICYmIG1pbiA8PSB5ICYmIHkgPCBtYXgpIHsKICAgICAgICB2YXIgYyA9IE1hdGguZmxvb3IoKHggLSBtaW4pIC8gY2VsbFNpemUpOwogICAgICAgIHZhciByID0gTWF0aC5mbG9vcigoeSAtIG1pbikgLyBjZWxsU2l6ZSk7CiAgICAgICAgcmV0dXJuIF90aGlzLmlzRGFyayhyLCBjKSA/IDAgOiAxOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiAxOwogICAgICB9CiAgICB9KTsKICB9OwoKICByZXR1cm4gX3RoaXM7Cn07Ci8qKiANCi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQovLyBxcmNvZGUuc3RyaW5nVG9CeXRlcw0KLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiovCgoKcXJjb2RlLnN0cmluZ1RvQnl0ZXMgPSBmdW5jdGlvbiAocykgewogIHZhciBieXRlcyA9IG5ldyBBcnJheSgpOwoKICBmb3IgKHZhciBpID0gMDsgaSA8IHMubGVuZ3RoOyBpICs9IDEpIHsKICAgIHZhciBjID0gcy5jaGFyQ29kZUF0KGkpOwogICAgYnl0ZXMucHVzaChjICYgMHhmZik7CiAgfQoKICByZXR1cm4gYnl0ZXM7Cn07Ci8qKg0KLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCi8vIHFyY29kZS5jcmVhdGVTdHJpbmdUb0J5dGVzDQovLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICovCgovKioNCiAqIEBwYXJhbSB1bmljb2RlRGF0YSBiYXNlNjQgc3RyaW5nIG9mIGJ5dGUgYXJyYXkuDQogKiBbMTZiaXQgVW5pY29kZV0sWzE2Yml0IEJ5dGVzXSwgLi4uDQogKiBAcGFyYW0gbnVtQ2hhcnMNCiAqLwoKCnFyY29kZS5jcmVhdGVTdHJpbmdUb0J5dGVzID0gZnVuY3Rpb24gKHVuaWNvZGVEYXRhLCBudW1DaGFycykgewogIC8qKiBjcmVhdGUgY29udmVyc2lvbiBtYXAuICovCiAgdmFyIHVuaWNvZGVNYXAgPSBmdW5jdGlvbiAoKSB7CiAgICB2YXIgYmluID0gYmFzZTY0RGVjb2RlSW5wdXRTdHJlYW0odW5pY29kZURhdGEpOwoKICAgIHZhciByZWFkID0gZnVuY3Rpb24gcmVhZCgpIHsKICAgICAgdmFyIGIgPSBiaW4ucmVhZCgpOwogICAgICBpZiAoYiA9PSAtMSkgdGhyb3cgbmV3IEVycm9yKCk7CiAgICAgIHJldHVybiBiOwogICAgfTsKCiAgICB2YXIgY291bnQgPSAwOwogICAgdmFyIHVuaWNvZGVNYXAgPSB7fTsKCiAgICB3aGlsZSAodHJ1ZSkgewogICAgICB2YXIgYjAgPSBiaW4ucmVhZCgpOwogICAgICBpZiAoYjAgPT0gLTEpIGJyZWFrOwogICAgICB2YXIgYjEgPSByZWFkKCk7CiAgICAgIHZhciBiMiA9IHJlYWQoKTsKICAgICAgdmFyIGIzID0gcmVhZCgpOwogICAgICB2YXIgayA9IFN0cmluZy5mcm9tQ2hhckNvZGUoYjAgPDwgOCB8IGIxKTsKICAgICAgdmFyIHYgPSBiMiA8PCA4IHwgYjM7CiAgICAgIHVuaWNvZGVNYXBba10gPSB2OwogICAgICBjb3VudCArPSAxOwogICAgfQoKICAgIGlmIChjb3VudCAhPSBudW1DaGFycykgewogICAgICB0aHJvdyBuZXcgRXJyb3IoY291bnQgKyAnICE9ICcgKyBudW1DaGFycyk7CiAgICB9CgogICAgcmV0dXJuIHVuaWNvZGVNYXA7CiAgfSgpOwoKICB2YXIgdW5rbm93bkNoYXIgPSAnPycuY2hhckNvZGVBdCgwKTsKICByZXR1cm4gZnVuY3Rpb24gKHMpIHsKICAgIHZhciBieXRlcyA9IG5ldyBBcnJheSgpOwoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcy5sZW5ndGg7IGkgKz0gMSkgewogICAgICB2YXIgYyA9IHMuY2hhckNvZGVBdChpKTsKCiAgICAgIGlmIChjIDwgMTI4KSB7CiAgICAgICAgYnl0ZXMucHVzaChjKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgYiA9IHVuaWNvZGVNYXBbcy5jaGFyQXQoaSldOwoKICAgICAgICBpZiAodHlwZW9mIGIgPT0gJ251bWJlcicpIHsKICAgICAgICAgIGlmICgoYiAmIDB4ZmYpID09IGIpIHsKICAgICAgICAgICAgLyoqMWJ5dGUgKi8KICAgICAgICAgICAgYnl0ZXMucHVzaChiKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8qKiAyYnl0ZXMgKi8KICAgICAgICAgICAgYnl0ZXMucHVzaChiID4+PiA4KTsKICAgICAgICAgICAgYnl0ZXMucHVzaChiICYgMHhmZik7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGJ5dGVzLnB1c2godW5rbm93bkNoYXIpOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHJldHVybiBieXRlczsKICB9Owp9OwovKiogDQovLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KLy8gUVJNb2RlDQovLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KKi8KCgp2YXIgUVJNb2RlID0gewogIE1PREVfTlVNQkVSOiAxIDw8IDAsCiAgTU9ERV9BTFBIQV9OVU06IDEgPDwgMSwKICBNT0RFXzhCSVRfQllURTogMSA8PCAyLAogIE1PREVfS0FOSkk6IDEgPDwgMwp9OwovKiogDQovLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KLy8gUVJFcnJvckNvcnJlY3RMZXZlbA0KLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiovCgp2YXIgUVJFcnJvckNvcnJlY3RMZXZlbCA9IHsKICBMOiAxLAogIE06IDAsCiAgUTogMywKICBIOiAyCn07Ci8qKiANCi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQovLyBRUk1hc2tQYXR0ZXJuDQovLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KKi8KCnZhciBRUk1hc2tQYXR0ZXJuID0gewogIFBBVFRFUk4wMDA6IDAsCiAgUEFUVEVSTjAwMTogMSwKICBQQVRURVJOMDEwOiAyLAogIFBBVFRFUk4wMTE6IDMsCiAgUEFUVEVSTjEwMDogNCwKICBQQVRURVJOMTAxOiA1LAogIFBBVFRFUk4xMTA6IDYsCiAgUEFUVEVSTjExMTogNwp9OwovKiogDQovLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KLy8gUVJVdGlsDQovLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KKi8KCnZhciBRUlV0aWwgPSBmdW5jdGlvbiAoKSB7CiAgdmFyIFBBVFRFUk5fUE9TSVRJT05fVEFCTEUgPSBbW10sIFs2LCAxOF0sIFs2LCAyMl0sIFs2LCAyNl0sIFs2LCAzMF0sIFs2LCAzNF0sIFs2LCAyMiwgMzhdLCBbNiwgMjQsIDQyXSwgWzYsIDI2LCA0Nl0sIFs2LCAyOCwgNTBdLCBbNiwgMzAsIDU0XSwgWzYsIDMyLCA1OF0sIFs2LCAzNCwgNjJdLCBbNiwgMjYsIDQ2LCA2Nl0sIFs2LCAyNiwgNDgsIDcwXSwgWzYsIDI2LCA1MCwgNzRdLCBbNiwgMzAsIDU0LCA3OF0sIFs2LCAzMCwgNTYsIDgyXSwgWzYsIDMwLCA1OCwgODZdLCBbNiwgMzQsIDYyLCA5MF0sIFs2LCAyOCwgNTAsIDcyLCA5NF0sIFs2LCAyNiwgNTAsIDc0LCA5OF0sIFs2LCAzMCwgNTQsIDc4LCAxMDJdLCBbNiwgMjgsIDU0LCA4MCwgMTA2XSwgWzYsIDMyLCA1OCwgODQsIDExMF0sIFs2LCAzMCwgNTgsIDg2LCAxMTRdLCBbNiwgMzQsIDYyLCA5MCwgMTE4XSwgWzYsIDI2LCA1MCwgNzQsIDk4LCAxMjJdLCBbNiwgMzAsIDU0LCA3OCwgMTAyLCAxMjZdLCBbNiwgMjYsIDUyLCA3OCwgMTA0LCAxMzBdLCBbNiwgMzAsIDU2LCA4MiwgMTA4LCAxMzRdLCBbNiwgMzQsIDYwLCA4NiwgMTEyLCAxMzhdLCBbNiwgMzAsIDU4LCA4NiwgMTE0LCAxNDJdLCBbNiwgMzQsIDYyLCA5MCwgMTE4LCAxNDZdLCBbNiwgMzAsIDU0LCA3OCwgMTAyLCAxMjYsIDE1MF0sIFs2LCAyNCwgNTAsIDc2LCAxMDIsIDEyOCwgMTU0XSwgWzYsIDI4LCA1NCwgODAsIDEwNiwgMTMyLCAxNThdLCBbNiwgMzIsIDU4LCA4NCwgMTEwLCAxMzYsIDE2Ml0sIFs2LCAyNiwgNTQsIDgyLCAxMTAsIDEzOCwgMTY2XSwgWzYsIDMwLCA1OCwgODYsIDExNCwgMTQyLCAxNzBdXTsKICB2YXIgRzE1ID0gMSA8PCAxMCB8IDEgPDwgOCB8IDEgPDwgNSB8IDEgPDwgNCB8IDEgPDwgMiB8IDEgPDwgMSB8IDEgPDwgMDsKICB2YXIgRzE4ID0gMSA8PCAxMiB8IDEgPDwgMTEgfCAxIDw8IDEwIHwgMSA8PCA5IHwgMSA8PCA4IHwgMSA8PCA1IHwgMSA8PCAyIHwgMSA8PCAwOwogIHZhciBHMTVfTUFTSyA9IDEgPDwgMTQgfCAxIDw8IDEyIHwgMSA8PCAxMCB8IDEgPDwgNCB8IDEgPDwgMTsKICB2YXIgX3RoaXMgPSB7fTsKCiAgdmFyIGdldEJDSERpZ2l0ID0gZnVuY3Rpb24gZ2V0QkNIRGlnaXQoZGF0YSkgewogICAgdmFyIGRpZ2l0ID0gMDsKCiAgICB3aGlsZSAoZGF0YSAhPSAwKSB7CiAgICAgIGRpZ2l0ICs9IDE7CiAgICAgIGRhdGEgPj4+PSAxOwogICAgfQoKICAgIHJldHVybiBkaWdpdDsKICB9OwoKICBfdGhpcy5nZXRCQ0hUeXBlSW5mbyA9IGZ1bmN0aW9uIChkYXRhKSB7CiAgICB2YXIgZCA9IGRhdGEgPDwgMTA7CgogICAgd2hpbGUgKGdldEJDSERpZ2l0KGQpIC0gZ2V0QkNIRGlnaXQoRzE1KSA+PSAwKSB7CiAgICAgIGQgXj0gRzE1IDw8IGdldEJDSERpZ2l0KGQpIC0gZ2V0QkNIRGlnaXQoRzE1KTsKICAgIH0KCiAgICByZXR1cm4gKGRhdGEgPDwgMTAgfCBkKSBeIEcxNV9NQVNLOwogIH07CgogIF90aGlzLmdldEJDSFR5cGVOdW1iZXIgPSBmdW5jdGlvbiAoZGF0YSkgewogICAgdmFyIGQgPSBkYXRhIDw8IDEyOwoKICAgIHdoaWxlIChnZXRCQ0hEaWdpdChkKSAtIGdldEJDSERpZ2l0KEcxOCkgPj0gMCkgewogICAgICBkIF49IEcxOCA8PCBnZXRCQ0hEaWdpdChkKSAtIGdldEJDSERpZ2l0KEcxOCk7CiAgICB9CgogICAgcmV0dXJuIGRhdGEgPDwgMTIgfCBkOwogIH07CgogIF90aGlzLmdldFBhdHRlcm5Qb3NpdGlvbiA9IGZ1bmN0aW9uICh0eXBlTnVtYmVyKSB7CiAgICByZXR1cm4gUEFUVEVSTl9QT1NJVElPTl9UQUJMRVt0eXBlTnVtYmVyIC0gMV07CiAgfTsKCiAgX3RoaXMuZ2V0TWFza0Z1bmN0aW9uID0gZnVuY3Rpb24gKG1hc2tQYXR0ZXJuKSB7CiAgICBzd2l0Y2ggKG1hc2tQYXR0ZXJuKSB7CiAgICAgIGNhc2UgUVJNYXNrUGF0dGVybi5QQVRURVJOMDAwOgogICAgICAgIHJldHVybiBmdW5jdGlvbiAoaSwgaikgewogICAgICAgICAgcmV0dXJuIChpICsgaikgJSAyID09IDA7CiAgICAgICAgfTsKCiAgICAgIGNhc2UgUVJNYXNrUGF0dGVybi5QQVRURVJOMDAxOgogICAgICAgIHJldHVybiBmdW5jdGlvbiAoaSwgaikgewogICAgICAgICAgcmV0dXJuIGkgJSAyID09IDA7CiAgICAgICAgfTsKCiAgICAgIGNhc2UgUVJNYXNrUGF0dGVybi5QQVRURVJOMDEwOgogICAgICAgIHJldHVybiBmdW5jdGlvbiAoaSwgaikgewogICAgICAgICAgcmV0dXJuIGogJSAzID09IDA7CiAgICAgICAgfTsKCiAgICAgIGNhc2UgUVJNYXNrUGF0dGVybi5QQVRURVJOMDExOgogICAgICAgIHJldHVybiBmdW5jdGlvbiAoaSwgaikgewogICAgICAgICAgcmV0dXJuIChpICsgaikgJSAzID09IDA7CiAgICAgICAgfTsKCiAgICAgIGNhc2UgUVJNYXNrUGF0dGVybi5QQVRURVJOMTAwOgogICAgICAgIHJldHVybiBmdW5jdGlvbiAoaSwgaikgewogICAgICAgICAgcmV0dXJuIChNYXRoLmZsb29yKGkgLyAyKSArIE1hdGguZmxvb3IoaiAvIDMpKSAlIDIgPT0gMDsKICAgICAgICB9OwoKICAgICAgY2FzZSBRUk1hc2tQYXR0ZXJuLlBBVFRFUk4xMDE6CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChpLCBqKSB7CiAgICAgICAgICByZXR1cm4gaSAqIGogJSAyICsgaSAqIGogJSAzID09IDA7CiAgICAgICAgfTsKCiAgICAgIGNhc2UgUVJNYXNrUGF0dGVybi5QQVRURVJOMTEwOgogICAgICAgIHJldHVybiBmdW5jdGlvbiAoaSwgaikgewogICAgICAgICAgcmV0dXJuIChpICogaiAlIDIgKyBpICogaiAlIDMpICUgMiA9PSAwOwogICAgICAgIH07CgogICAgICBjYXNlIFFSTWFza1BhdHRlcm4uUEFUVEVSTjExMToKICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGksIGopIHsKICAgICAgICAgIHJldHVybiAoaSAqIGogJSAzICsgKGkgKyBqKSAlIDIpICUgMiA9PSAwOwogICAgICAgIH07CgogICAgICBkZWZhdWx0OgogICAgICAgIHRocm93IG5ldyBFcnJvcignYmFkIG1hc2tQYXR0ZXJuOicgKyBtYXNrUGF0dGVybik7CiAgICB9CiAgfTsKCiAgX3RoaXMuZ2V0RXJyb3JDb3JyZWN0UG9seW5vbWlhbCA9IGZ1bmN0aW9uIChlcnJvckNvcnJlY3RMZW5ndGgpIHsKICAgIHZhciBhID0gcXJQb2x5bm9taWFsKFsxXSwgMCk7CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlcnJvckNvcnJlY3RMZW5ndGg7IGkgKz0gMSkgewogICAgICBhID0gYS5tdWx0aXBseShxclBvbHlub21pYWwoWzEsIFFSTWF0aC5nZXhwKGkpXSwgMCkpOwogICAgfQoKICAgIHJldHVybiBhOwogIH07CgogIF90aGlzLmdldExlbmd0aEluQml0cyA9IGZ1bmN0aW9uIChtb2RlLCB0eXBlKSB7CiAgICBpZiAoMSA8PSB0eXBlICYmIHR5cGUgPCAxMCkgewogICAgICAvKioxIC0gOSAqLwogICAgICBzd2l0Y2ggKG1vZGUpIHsKICAgICAgICBjYXNlIFFSTW9kZS5NT0RFX05VTUJFUjoKICAgICAgICAgIHJldHVybiAxMDsKCiAgICAgICAgY2FzZSBRUk1vZGUuTU9ERV9BTFBIQV9OVU06CiAgICAgICAgICByZXR1cm4gOTsKCiAgICAgICAgY2FzZSBRUk1vZGUuTU9ERV84QklUX0JZVEU6CiAgICAgICAgICByZXR1cm4gODsKCiAgICAgICAgY2FzZSBRUk1vZGUuTU9ERV9LQU5KSToKICAgICAgICAgIHJldHVybiA4OwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdtb2RlOicgKyBtb2RlKTsKICAgICAgfQogICAgfSBlbHNlIGlmICh0eXBlIDwgMjcpIHsKICAgICAgLyoqMTAgLSAyNiAqLwogICAgICBzd2l0Y2ggKG1vZGUpIHsKICAgICAgICBjYXNlIFFSTW9kZS5NT0RFX05VTUJFUjoKICAgICAgICAgIHJldHVybiAxMjsKCiAgICAgICAgY2FzZSBRUk1vZGUuTU9ERV9BTFBIQV9OVU06CiAgICAgICAgICByZXR1cm4gMTE7CgogICAgICAgIGNhc2UgUVJNb2RlLk1PREVfOEJJVF9CWVRFOgogICAgICAgICAgcmV0dXJuIDE2OwoKICAgICAgICBjYXNlIFFSTW9kZS5NT0RFX0tBTkpJOgogICAgICAgICAgcmV0dXJuIDEwOwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdtb2RlOicgKyBtb2RlKTsKICAgICAgfQogICAgfSBlbHNlIGlmICh0eXBlIDwgNDEpIHsKICAgICAgLyoqMjcgLSA0MCAqLwogICAgICBzd2l0Y2ggKG1vZGUpIHsKICAgICAgICBjYXNlIFFSTW9kZS5NT0RFX05VTUJFUjoKICAgICAgICAgIHJldHVybiAxNDsKCiAgICAgICAgY2FzZSBRUk1vZGUuTU9ERV9BTFBIQV9OVU06CiAgICAgICAgICByZXR1cm4gMTM7CgogICAgICAgIGNhc2UgUVJNb2RlLk1PREVfOEJJVF9CWVRFOgogICAgICAgICAgcmV0dXJuIDE2OwoKICAgICAgICBjYXNlIFFSTW9kZS5NT0RFX0tBTkpJOgogICAgICAgICAgcmV0dXJuIDEyOwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdtb2RlOicgKyBtb2RlKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCd0eXBlOicgKyB0eXBlKTsKICAgIH0KICB9OwoKICBfdGhpcy5nZXRMb3N0UG9pbnQgPSBmdW5jdGlvbiAocXJjb2RlKSB7CiAgICB2YXIgbW9kdWxlQ291bnQgPSBxcmNvZGUuZ2V0TW9kdWxlQ291bnQoKTsKICAgIHZhciBsb3N0UG9pbnQgPSAwOwogICAgLyoqTEVWRUwxICovCgogICAgZm9yICh2YXIgcm93ID0gMDsgcm93IDwgbW9kdWxlQ291bnQ7IHJvdyArPSAxKSB7CiAgICAgIGZvciAodmFyIGNvbCA9IDA7IGNvbCA8IG1vZHVsZUNvdW50OyBjb2wgKz0gMSkgewogICAgICAgIHZhciBzYW1lQ291bnQgPSAwOwogICAgICAgIHZhciBkYXJrID0gcXJjb2RlLmlzRGFyayhyb3csIGNvbCk7CgogICAgICAgIGZvciAodmFyIHIgPSAtMTsgciA8PSAxOyByICs9IDEpIHsKICAgICAgICAgIGlmIChyb3cgKyByIDwgMCB8fCBtb2R1bGVDb3VudCA8PSByb3cgKyByKSB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGZvciAodmFyIGMgPSAtMTsgYyA8PSAxOyBjICs9IDEpIHsKICAgICAgICAgICAgaWYgKGNvbCArIGMgPCAwIHx8IG1vZHVsZUNvdW50IDw9IGNvbCArIGMpIHsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKHIgPT0gMCAmJiBjID09IDApIHsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGRhcmsgPT0gcXJjb2RlLmlzRGFyayhyb3cgKyByLCBjb2wgKyBjKSkgewogICAgICAgICAgICAgIHNhbWVDb3VudCArPSAxOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoc2FtZUNvdW50ID4gNSkgewogICAgICAgICAgbG9zdFBvaW50ICs9IDMgKyBzYW1lQ291bnQgLSA1OwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIDsKICAgIC8qKkxFVkVMMiAqLwoKICAgIGZvciAodmFyIHJvdyA9IDA7IHJvdyA8IG1vZHVsZUNvdW50IC0gMTsgcm93ICs9IDEpIHsKICAgICAgZm9yICh2YXIgY29sID0gMDsgY29sIDwgbW9kdWxlQ291bnQgLSAxOyBjb2wgKz0gMSkgewogICAgICAgIHZhciBjb3VudCA9IDA7CiAgICAgICAgaWYgKHFyY29kZS5pc0Rhcmsocm93LCBjb2wpKSBjb3VudCArPSAxOwogICAgICAgIGlmIChxcmNvZGUuaXNEYXJrKHJvdyArIDEsIGNvbCkpIGNvdW50ICs9IDE7CiAgICAgICAgaWYgKHFyY29kZS5pc0Rhcmsocm93LCBjb2wgKyAxKSkgY291bnQgKz0gMTsKICAgICAgICBpZiAocXJjb2RlLmlzRGFyayhyb3cgKyAxLCBjb2wgKyAxKSkgY291bnQgKz0gMTsKCiAgICAgICAgaWYgKGNvdW50ID09IDAgfHwgY291bnQgPT0gNCkgewogICAgICAgICAgbG9zdFBvaW50ICs9IDM7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICAvKipMRVZFTDMgKi8KCgogICAgZm9yICh2YXIgcm93ID0gMDsgcm93IDwgbW9kdWxlQ291bnQ7IHJvdyArPSAxKSB7CiAgICAgIGZvciAodmFyIGNvbCA9IDA7IGNvbCA8IG1vZHVsZUNvdW50IC0gNjsgY29sICs9IDEpIHsKICAgICAgICBpZiAocXJjb2RlLmlzRGFyayhyb3csIGNvbCkgJiYgIXFyY29kZS5pc0Rhcmsocm93LCBjb2wgKyAxKSAmJiBxcmNvZGUuaXNEYXJrKHJvdywgY29sICsgMikgJiYgcXJjb2RlLmlzRGFyayhyb3csIGNvbCArIDMpICYmIHFyY29kZS5pc0Rhcmsocm93LCBjb2wgKyA0KSAmJiAhcXJjb2RlLmlzRGFyayhyb3csIGNvbCArIDUpICYmIHFyY29kZS5pc0Rhcmsocm93LCBjb2wgKyA2KSkgewogICAgICAgICAgbG9zdFBvaW50ICs9IDQwOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGZvciAodmFyIGNvbCA9IDA7IGNvbCA8IG1vZHVsZUNvdW50OyBjb2wgKz0gMSkgewogICAgICBmb3IgKHZhciByb3cgPSAwOyByb3cgPCBtb2R1bGVDb3VudCAtIDY7IHJvdyArPSAxKSB7CiAgICAgICAgaWYgKHFyY29kZS5pc0Rhcmsocm93LCBjb2wpICYmICFxcmNvZGUuaXNEYXJrKHJvdyArIDEsIGNvbCkgJiYgcXJjb2RlLmlzRGFyayhyb3cgKyAyLCBjb2wpICYmIHFyY29kZS5pc0Rhcmsocm93ICsgMywgY29sKSAmJiBxcmNvZGUuaXNEYXJrKHJvdyArIDQsIGNvbCkgJiYgIXFyY29kZS5pc0Rhcmsocm93ICsgNSwgY29sKSAmJiBxcmNvZGUuaXNEYXJrKHJvdyArIDYsIGNvbCkpIHsKICAgICAgICAgIGxvc3RQb2ludCArPSA0MDsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC8qKkxFVkVMNCAqLwoKCiAgICB2YXIgZGFya0NvdW50ID0gMDsKCiAgICBmb3IgKHZhciBjb2wgPSAwOyBjb2wgPCBtb2R1bGVDb3VudDsgY29sICs9IDEpIHsKICAgICAgZm9yICh2YXIgcm93ID0gMDsgcm93IDwgbW9kdWxlQ291bnQ7IHJvdyArPSAxKSB7CiAgICAgICAgaWYgKHFyY29kZS5pc0Rhcmsocm93LCBjb2wpKSB7CiAgICAgICAgICBkYXJrQ291bnQgKz0gMTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICB2YXIgcmF0aW8gPSBNYXRoLmFicygxMDAgKiBkYXJrQ291bnQgLyBtb2R1bGVDb3VudCAvIG1vZHVsZUNvdW50IC0gNTApIC8gNTsKICAgIGxvc3RQb2ludCArPSByYXRpbyAqIDEwOwogICAgcmV0dXJuIGxvc3RQb2ludDsKICB9OwoKICByZXR1cm4gX3RoaXM7Cn0oKTsKLyoqIA0KLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCi8vIFFSTWF0aA0KLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiovCgoKdmFyIFFSTWF0aCA9IGZ1bmN0aW9uICgpIHsKICB2YXIgRVhQX1RBQkxFID0gbmV3IEFycmF5KDI1Nik7CiAgdmFyIExPR19UQUJMRSA9IG5ldyBBcnJheSgyNTYpOwogIC8qKiBpbml0aWFsaXplIHRhYmxlcyovCgogIGZvciAodmFyIGkgPSAwOyBpIDwgODsgaSArPSAxKSB7CiAgICBFWFBfVEFCTEVbaV0gPSAxIDw8IGk7CiAgfQoKICBmb3IgKHZhciBpID0gODsgaSA8IDI1NjsgaSArPSAxKSB7CiAgICBFWFBfVEFCTEVbaV0gPSBFWFBfVEFCTEVbaSAtIDRdIF4gRVhQX1RBQkxFW2kgLSA1XSBeIEVYUF9UQUJMRVtpIC0gNl0gXiBFWFBfVEFCTEVbaSAtIDhdOwogIH0KCiAgZm9yICh2YXIgaSA9IDA7IGkgPCAyNTU7IGkgKz0gMSkgewogICAgTE9HX1RBQkxFW0VYUF9UQUJMRVtpXV0gPSBpOwogIH0KCiAgdmFyIF90aGlzID0ge307CgogIF90aGlzLmdsb2cgPSBmdW5jdGlvbiAobikgewogICAgaWYgKG4gPCAxKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignZ2xvZygnICsgbiArICcpJyk7CiAgICB9CgogICAgcmV0dXJuIExPR19UQUJMRVtuXTsKICB9OwoKICBfdGhpcy5nZXhwID0gZnVuY3Rpb24gKG4pIHsKICAgIHdoaWxlIChuIDwgMCkgewogICAgICBuICs9IDI1NTsKICAgIH0KCiAgICB3aGlsZSAobiA+PSAyNTYpIHsKICAgICAgbiAtPSAyNTU7CiAgICB9CgogICAgcmV0dXJuIEVYUF9UQUJMRVtuXTsKICB9OwoKICByZXR1cm4gX3RoaXM7Cn0oKTsKLyoqIA0KLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCi8vIHFyUG9seW5vbWlhbA0KLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiovCgoKZnVuY3Rpb24gcXJQb2x5bm9taWFsKG51bSwgc2hpZnQpIHsKICBpZiAodHlwZW9mIG51bS5sZW5ndGggPT0gJ3VuZGVmaW5lZCcpIHsKICAgIHRocm93IG5ldyBFcnJvcihudW0ubGVuZ3RoICsgJy8nICsgc2hpZnQpOwogIH0KCiAgdmFyIF9udW0gPSBmdW5jdGlvbiAoKSB7CiAgICB2YXIgb2Zmc2V0ID0gMDsKCiAgICB3aGlsZSAob2Zmc2V0IDwgbnVtLmxlbmd0aCAmJiBudW1bb2Zmc2V0XSA9PSAwKSB7CiAgICAgIG9mZnNldCArPSAxOwogICAgfQoKICAgIHZhciBfbnVtID0gbmV3IEFycmF5KG51bS5sZW5ndGggLSBvZmZzZXQgKyBzaGlmdCk7CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBudW0ubGVuZ3RoIC0gb2Zmc2V0OyBpICs9IDEpIHsKICAgICAgX251bVtpXSA9IG51bVtpICsgb2Zmc2V0XTsKICAgIH0KCiAgICByZXR1cm4gX251bTsKICB9KCk7CgogIHZhciBfdGhpcyA9IHt9OwoKICBfdGhpcy5nZXRBdCA9IGZ1bmN0aW9uIChpbmRleCkgewogICAgcmV0dXJuIF9udW1baW5kZXhdOwogIH07CgogIF90aGlzLmdldExlbmd0aCA9IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiBfbnVtLmxlbmd0aDsKICB9OwoKICBfdGhpcy5tdWx0aXBseSA9IGZ1bmN0aW9uIChlKSB7CiAgICB2YXIgbnVtID0gbmV3IEFycmF5KF90aGlzLmdldExlbmd0aCgpICsgZS5nZXRMZW5ndGgoKSAtIDEpOwoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgX3RoaXMuZ2V0TGVuZ3RoKCk7IGkgKz0gMSkgewogICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGUuZ2V0TGVuZ3RoKCk7IGogKz0gMSkgewogICAgICAgIG51bVtpICsgal0gXj0gUVJNYXRoLmdleHAoUVJNYXRoLmdsb2coX3RoaXMuZ2V0QXQoaSkpICsgUVJNYXRoLmdsb2coZS5nZXRBdChqKSkpOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHFyUG9seW5vbWlhbChudW0sIDApOwogIH07CgogIF90aGlzLm1vZCA9IGZ1bmN0aW9uIChlKSB7CiAgICBpZiAoX3RoaXMuZ2V0TGVuZ3RoKCkgLSBlLmdldExlbmd0aCgpIDwgMCkgewogICAgICByZXR1cm4gX3RoaXM7CiAgICB9CgogICAgdmFyIHJhdGlvID0gUVJNYXRoLmdsb2coX3RoaXMuZ2V0QXQoMCkpIC0gUVJNYXRoLmdsb2coZS5nZXRBdCgwKSk7CiAgICB2YXIgbnVtID0gbmV3IEFycmF5KF90aGlzLmdldExlbmd0aCgpKTsKCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IF90aGlzLmdldExlbmd0aCgpOyBpICs9IDEpIHsKICAgICAgbnVtW2ldID0gX3RoaXMuZ2V0QXQoaSk7CiAgICB9CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlLmdldExlbmd0aCgpOyBpICs9IDEpIHsKICAgICAgbnVtW2ldIF49IFFSTWF0aC5nZXhwKFFSTWF0aC5nbG9nKGUuZ2V0QXQoaSkpICsgcmF0aW8pOwogICAgfSAvLyByZWN1cnNpdmUgY2FsbAoKCiAgICByZXR1cm4gcXJQb2x5bm9taWFsKG51bSwgMCkubW9kKGUpOwogIH07CgogIHJldHVybiBfdGhpczsKfQoKOwovKiogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQovLyBRUlJTQmxvY2sNCi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoqLwoKdmFyIFFSUlNCbG9jayA9IGZ1bmN0aW9uICgpIHsKICAvKiogIFsxOiBbTCwgTSwgUSwgSF0sIC4uXSovCiAgdmFyIFJTX0JMT0NLX1RBQkxFID0gW1sxLCAyNiwgMTldLCBbMSwgMjYsIDE2XSwgWzEsIDI2LCAxM10sIFsxLCAyNiwgOV0sIFsxLCA0NCwgMzRdLCBbMSwgNDQsIDI4XSwgWzEsIDQ0LCAyMl0sIFsxLCA0NCwgMTZdLCBbMSwgNzAsIDU1XSwgWzEsIDcwLCA0NF0sIFsyLCAzNSwgMTddLCBbMiwgMzUsIDEzXSwgWzEsIDEwMCwgODBdLCBbMiwgNTAsIDMyXSwgWzIsIDUwLCAyNF0sIFs0LCAyNSwgOV0sIFsxLCAxMzQsIDEwOF0sIFsyLCA2NywgNDNdLCBbMiwgMzMsIDE1LCAyLCAzNCwgMTZdLCBbMiwgMzMsIDExLCAyLCAzNCwgMTJdLCBbMiwgODYsIDY4XSwgWzQsIDQzLCAyN10sIFs0LCA0MywgMTldLCBbNCwgNDMsIDE1XSwgWzIsIDk4LCA3OF0sIFs0LCA0OSwgMzFdLCBbMiwgMzIsIDE0LCA0LCAzMywgMTVdLCBbNCwgMzksIDEzLCAxLCA0MCwgMTRdLCBbMiwgMTIxLCA5N10sIFsyLCA2MCwgMzgsIDIsIDYxLCAzOV0sIFs0LCA0MCwgMTgsIDIsIDQxLCAxOV0sIFs0LCA0MCwgMTQsIDIsIDQxLCAxNV0sIFsyLCAxNDYsIDExNl0sIFszLCA1OCwgMzYsIDIsIDU5LCAzN10sIFs0LCAzNiwgMTYsIDQsIDM3LCAxN10sIFs0LCAzNiwgMTIsIDQsIDM3LCAxM10sIFsyLCA4NiwgNjgsIDIsIDg3LCA2OV0sIFs0LCA2OSwgNDMsIDEsIDcwLCA0NF0sIFs2LCA0MywgMTksIDIsIDQ0LCAyMF0sIFs2LCA0MywgMTUsIDIsIDQ0LCAxNl0sIFs0LCAxMDEsIDgxXSwgWzEsIDgwLCA1MCwgNCwgODEsIDUxXSwgWzQsIDUwLCAyMiwgNCwgNTEsIDIzXSwgWzMsIDM2LCAxMiwgOCwgMzcsIDEzXSwgWzIsIDExNiwgOTIsIDIsIDExNywgOTNdLCBbNiwgNTgsIDM2LCAyLCA1OSwgMzddLCBbNCwgNDYsIDIwLCA2LCA0NywgMjFdLCBbNywgNDIsIDE0LCA0LCA0MywgMTVdLCBbNCwgMTMzLCAxMDddLCBbOCwgNTksIDM3LCAxLCA2MCwgMzhdLCBbOCwgNDQsIDIwLCA0LCA0NSwgMjFdLCBbMTIsIDMzLCAxMSwgNCwgMzQsIDEyXSwgWzMsIDE0NSwgMTE1LCAxLCAxNDYsIDExNl0sIFs0LCA2NCwgNDAsIDUsIDY1LCA0MV0sIFsxMSwgMzYsIDE2LCA1LCAzNywgMTddLCBbMTEsIDM2LCAxMiwgNSwgMzcsIDEzXSwgWzUsIDEwOSwgODcsIDEsIDExMCwgODhdLCBbNSwgNjUsIDQxLCA1LCA2NiwgNDJdLCBbNSwgNTQsIDI0LCA3LCA1NSwgMjVdLCBbMTEsIDM2LCAxMl0sIFs1LCAxMjIsIDk4LCAxLCAxMjMsIDk5XSwgWzcsIDczLCA0NSwgMywgNzQsIDQ2XSwgWzE1LCA0MywgMTksIDIsIDQ0LCAyMF0sIFszLCA0NSwgMTUsIDEzLCA0NiwgMTZdLCBbMSwgMTM1LCAxMDcsIDUsIDEzNiwgMTA4XSwgWzEwLCA3NCwgNDYsIDEsIDc1LCA0N10sIFsxLCA1MCwgMjIsIDE1LCA1MSwgMjNdLCBbMiwgNDIsIDE0LCAxNywgNDMsIDE1XSwgWzUsIDE1MCwgMTIwLCAxLCAxNTEsIDEyMV0sIFs5LCA2OSwgNDMsIDQsIDcwLCA0NF0sIFsxNywgNTAsIDIyLCAxLCA1MSwgMjNdLCBbMiwgNDIsIDE0LCAxOSwgNDMsIDE1XSwgWzMsIDE0MSwgMTEzLCA0LCAxNDIsIDExNF0sIFszLCA3MCwgNDQsIDExLCA3MSwgNDVdLCBbMTcsIDQ3LCAyMSwgNCwgNDgsIDIyXSwgWzksIDM5LCAxMywgMTYsIDQwLCAxNF0sIFszLCAxMzUsIDEwNywgNSwgMTM2LCAxMDhdLCBbMywgNjcsIDQxLCAxMywgNjgsIDQyXSwgWzE1LCA1NCwgMjQsIDUsIDU1LCAyNV0sIFsxNSwgNDMsIDE1LCAxMCwgNDQsIDE2XSwgWzQsIDE0NCwgMTE2LCA0LCAxNDUsIDExN10sIFsxNywgNjgsIDQyXSwgWzE3LCA1MCwgMjIsIDYsIDUxLCAyM10sIFsxOSwgNDYsIDE2LCA2LCA0NywgMTddLCBbMiwgMTM5LCAxMTEsIDcsIDE0MCwgMTEyXSwgWzE3LCA3NCwgNDZdLCBbNywgNTQsIDI0LCAxNiwgNTUsIDI1XSwgWzM0LCAzNywgMTNdLCBbNCwgMTUxLCAxMjEsIDUsIDE1MiwgMTIyXSwgWzQsIDc1LCA0NywgMTQsIDc2LCA0OF0sIFsxMSwgNTQsIDI0LCAxNCwgNTUsIDI1XSwgWzE2LCA0NSwgMTUsIDE0LCA0NiwgMTZdLCBbNiwgMTQ3LCAxMTcsIDQsIDE0OCwgMTE4XSwgWzYsIDczLCA0NSwgMTQsIDc0LCA0Nl0sIFsxMSwgNTQsIDI0LCAxNiwgNTUsIDI1XSwgWzMwLCA0NiwgMTYsIDIsIDQ3LCAxN10sIFs4LCAxMzIsIDEwNiwgNCwgMTMzLCAxMDddLCBbOCwgNzUsIDQ3LCAxMywgNzYsIDQ4XSwgWzcsIDU0LCAyNCwgMjIsIDU1LCAyNV0sIFsyMiwgNDUsIDE1LCAxMywgNDYsIDE2XSwgWzEwLCAxNDIsIDExNCwgMiwgMTQzLCAxMTVdLCBbMTksIDc0LCA0NiwgNCwgNzUsIDQ3XSwgWzI4LCA1MCwgMjIsIDYsIDUxLCAyM10sIFszMywgNDYsIDE2LCA0LCA0NywgMTddLCBbOCwgMTUyLCAxMjIsIDQsIDE1MywgMTIzXSwgWzIyLCA3MywgNDUsIDMsIDc0LCA0Nl0sIFs4LCA1MywgMjMsIDI2LCA1NCwgMjRdLCBbMTIsIDQ1LCAxNSwgMjgsIDQ2LCAxNl0sIFszLCAxNDcsIDExNywgMTAsIDE0OCwgMTE4XSwgWzMsIDczLCA0NSwgMjMsIDc0LCA0Nl0sIFs0LCA1NCwgMjQsIDMxLCA1NSwgMjVdLCBbMTEsIDQ1LCAxNSwgMzEsIDQ2LCAxNl0sIFs3LCAxNDYsIDExNiwgNywgMTQ3LCAxMTddLCBbMjEsIDczLCA0NSwgNywgNzQsIDQ2XSwgWzEsIDUzLCAyMywgMzcsIDU0LCAyNF0sIFsxOSwgNDUsIDE1LCAyNiwgNDYsIDE2XSwgWzUsIDE0NSwgMTE1LCAxMCwgMTQ2LCAxMTZdLCBbMTksIDc1LCA0NywgMTAsIDc2LCA0OF0sIFsxNSwgNTQsIDI0LCAyNSwgNTUsIDI1XSwgWzIzLCA0NSwgMTUsIDI1LCA0NiwgMTZdLCBbMTMsIDE0NSwgMTE1LCAzLCAxNDYsIDExNl0sIFsyLCA3NCwgNDYsIDI5LCA3NSwgNDddLCBbNDIsIDU0LCAyNCwgMSwgNTUsIDI1XSwgWzIzLCA0NSwgMTUsIDI4LCA0NiwgMTZdLCBbMTcsIDE0NSwgMTE1XSwgWzEwLCA3NCwgNDYsIDIzLCA3NSwgNDddLCBbMTAsIDU0LCAyNCwgMzUsIDU1LCAyNV0sIFsxOSwgNDUsIDE1LCAzNSwgNDYsIDE2XSwgWzE3LCAxNDUsIDExNSwgMSwgMTQ2LCAxMTZdLCBbMTQsIDc0LCA0NiwgMjEsIDc1LCA0N10sIFsyOSwgNTQsIDI0LCAxOSwgNTUsIDI1XSwgWzExLCA0NSwgMTUsIDQ2LCA0NiwgMTZdLCBbMTMsIDE0NSwgMTE1LCA2LCAxNDYsIDExNl0sIFsxNCwgNzQsIDQ2LCAyMywgNzUsIDQ3XSwgWzQ0LCA1NCwgMjQsIDcsIDU1LCAyNV0sIFs1OSwgNDYsIDE2LCAxLCA0NywgMTddLCBbMTIsIDE1MSwgMTIxLCA3LCAxNTIsIDEyMl0sIFsxMiwgNzUsIDQ3LCAyNiwgNzYsIDQ4XSwgWzM5LCA1NCwgMjQsIDE0LCA1NSwgMjVdLCBbMjIsIDQ1LCAxNSwgNDEsIDQ2LCAxNl0sIFs2LCAxNTEsIDEyMSwgMTQsIDE1MiwgMTIyXSwgWzYsIDc1LCA0NywgMzQsIDc2LCA0OF0sIFs0NiwgNTQsIDI0LCAxMCwgNTUsIDI1XSwgWzIsIDQ1LCAxNSwgNjQsIDQ2LCAxNl0sIFsxNywgMTUyLCAxMjIsIDQsIDE1MywgMTIzXSwgWzI5LCA3NCwgNDYsIDE0LCA3NSwgNDddLCBbNDksIDU0LCAyNCwgMTAsIDU1LCAyNV0sIFsyNCwgNDUsIDE1LCA0NiwgNDYsIDE2XSwgWzQsIDE1MiwgMTIyLCAxOCwgMTUzLCAxMjNdLCBbMTMsIDc0LCA0NiwgMzIsIDc1LCA0N10sIFs0OCwgNTQsIDI0LCAxNCwgNTUsIDI1XSwgWzQyLCA0NSwgMTUsIDMyLCA0NiwgMTZdLCBbMjAsIDE0NywgMTE3LCA0LCAxNDgsIDExOF0sIFs0MCwgNzUsIDQ3LCA3LCA3NiwgNDhdLCBbNDMsIDU0LCAyNCwgMjIsIDU1LCAyNV0sIFsxMCwgNDUsIDE1LCA2NywgNDYsIDE2XSwgWzE5LCAxNDgsIDExOCwgNiwgMTQ5LCAxMTldLCBbMTgsIDc1LCA0NywgMzEsIDc2LCA0OF0sIFszNCwgNTQsIDI0LCAzNCwgNTUsIDI1XSwgWzIwLCA0NSwgMTUsIDYxLCA0NiwgMTZdXTsKCiAgdmFyIHFyUlNCbG9jayA9IGZ1bmN0aW9uIHFyUlNCbG9jayh0b3RhbENvdW50LCBkYXRhQ291bnQpIHsKICAgIHZhciBfdGhpcyA9IHt9OwogICAgX3RoaXMudG90YWxDb3VudCA9IHRvdGFsQ291bnQ7CiAgICBfdGhpcy5kYXRhQ291bnQgPSBkYXRhQ291bnQ7CiAgICByZXR1cm4gX3RoaXM7CiAgfTsKCiAgdmFyIF90aGlzID0ge307CgogIHZhciBnZXRSc0Jsb2NrVGFibGUgPSBmdW5jdGlvbiBnZXRSc0Jsb2NrVGFibGUodHlwZU51bWJlciwgZXJyb3JDb3JyZWN0TGV2ZWwpIHsKICAgIHN3aXRjaCAoZXJyb3JDb3JyZWN0TGV2ZWwpIHsKICAgICAgY2FzZSBRUkVycm9yQ29ycmVjdExldmVsLkw6CiAgICAgICAgcmV0dXJuIFJTX0JMT0NLX1RBQkxFWyh0eXBlTnVtYmVyIC0gMSkgKiA0ICsgMF07CgogICAgICBjYXNlIFFSRXJyb3JDb3JyZWN0TGV2ZWwuTToKICAgICAgICByZXR1cm4gUlNfQkxPQ0tfVEFCTEVbKHR5cGVOdW1iZXIgLSAxKSAqIDQgKyAxXTsKCiAgICAgIGNhc2UgUVJFcnJvckNvcnJlY3RMZXZlbC5ROgogICAgICAgIHJldHVybiBSU19CTE9DS19UQUJMRVsodHlwZU51bWJlciAtIDEpICogNCArIDJdOwoKICAgICAgY2FzZSBRUkVycm9yQ29ycmVjdExldmVsLkg6CiAgICAgICAgcmV0dXJuIFJTX0JMT0NLX1RBQkxFWyh0eXBlTnVtYmVyIC0gMSkgKiA0ICsgM107CgogICAgICBkZWZhdWx0OgogICAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICB9CiAgfTsKCiAgX3RoaXMuZ2V0UlNCbG9ja3MgPSBmdW5jdGlvbiAodHlwZU51bWJlciwgZXJyb3JDb3JyZWN0TGV2ZWwpIHsKICAgIHZhciByc0Jsb2NrID0gZ2V0UnNCbG9ja1RhYmxlKHR5cGVOdW1iZXIsIGVycm9yQ29ycmVjdExldmVsKTsKCiAgICBpZiAodHlwZW9mIHJzQmxvY2sgPT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdiYWQgcnMgYmxvY2sgQCB0eXBlTnVtYmVyOicgKyB0eXBlTnVtYmVyICsgJy9lcnJvckNvcnJlY3RMZXZlbDonICsgZXJyb3JDb3JyZWN0TGV2ZWwpOwogICAgfQoKICAgIHZhciBsZW5ndGggPSByc0Jsb2NrLmxlbmd0aCAvIDM7CiAgICB2YXIgbGlzdCA9IG5ldyBBcnJheSgpOwoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpICs9IDEpIHsKICAgICAgdmFyIGNvdW50ID0gcnNCbG9ja1tpICogMyArIDBdOwogICAgICB2YXIgdG90YWxDb3VudCA9IHJzQmxvY2tbaSAqIDMgKyAxXTsKICAgICAgdmFyIGRhdGFDb3VudCA9IHJzQmxvY2tbaSAqIDMgKyAyXTsKCiAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgY291bnQ7IGogKz0gMSkgewogICAgICAgIGxpc3QucHVzaChxclJTQmxvY2sodG90YWxDb3VudCwgZGF0YUNvdW50KSk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gbGlzdDsKICB9OwoKICByZXR1cm4gX3RoaXM7Cn0oKTsKLyoqIA0KICAvLyBxckJpdEJ1ZmZlcg0KKi8KCgp2YXIgcXJCaXRCdWZmZXIgPSBmdW5jdGlvbiBxckJpdEJ1ZmZlcigpIHsKICB2YXIgX2J1ZmZlciA9IG5ldyBBcnJheSgpOwoKICB2YXIgX2xlbmd0aCA9IDA7CiAgdmFyIF90aGlzID0ge307CgogIF90aGlzLmdldEJ1ZmZlciA9IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiBfYnVmZmVyOwogIH07CgogIF90aGlzLmdldEF0ID0gZnVuY3Rpb24gKGluZGV4KSB7CiAgICB2YXIgYnVmSW5kZXggPSBNYXRoLmZsb29yKGluZGV4IC8gOCk7CiAgICByZXR1cm4gKF9idWZmZXJbYnVmSW5kZXhdID4+PiA3IC0gaW5kZXggJSA4ICYgMSkgPT0gMTsKICB9OwoKICBfdGhpcy5wdXQgPSBmdW5jdGlvbiAobnVtLCBsZW5ndGgpIHsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpICs9IDEpIHsKICAgICAgX3RoaXMucHV0Qml0KChudW0gPj4+IGxlbmd0aCAtIGkgLSAxICYgMSkgPT0gMSk7CiAgICB9CiAgfTsKCiAgX3RoaXMuZ2V0TGVuZ3RoSW5CaXRzID0gZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIF9sZW5ndGg7CiAgfTsKCiAgX3RoaXMucHV0Qml0ID0gZnVuY3Rpb24gKGJpdCkgewogICAgdmFyIGJ1ZkluZGV4ID0gTWF0aC5mbG9vcihfbGVuZ3RoIC8gOCk7CgogICAgaWYgKF9idWZmZXIubGVuZ3RoIDw9IGJ1ZkluZGV4KSB7CiAgICAgIF9idWZmZXIucHVzaCgwKTsKICAgIH0KCiAgICBpZiAoYml0KSB7CiAgICAgIF9idWZmZXJbYnVmSW5kZXhdIHw9IDB4ODAgPj4+IF9sZW5ndGggJSA4OwogICAgfQoKICAgIF9sZW5ndGggKz0gMTsKICB9OwoKICByZXR1cm4gX3RoaXM7Cn07Ci8qKiANCi8vIHFyOEJpdEJ5dGUNCiovCgoKdmFyIHFyOEJpdEJ5dGUgPSBmdW5jdGlvbiBxcjhCaXRCeXRlKGRhdGEpIHsKICB2YXIgX21vZGUgPSBRUk1vZGUuTU9ERV84QklUX0JZVEU7CiAgdmFyIF9kYXRhID0gZGF0YTsKICB2YXIgX3BhcnNlZERhdGEgPSBbXTsKICB2YXIgX3RoaXMgPSB7fTsKICAvKiogIEFkZGVkIHRvIHN1cHBvcnQgVVRGLTggQ2hhcmFjdGVycyovCgogIGZvciAodmFyIGkgPSAwLCBsID0gX2RhdGEubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICB2YXIgYnl0ZUFycmF5ID0gW107CgogICAgdmFyIGNvZGUgPSBfZGF0YS5jaGFyQ29kZUF0KGkpOwoKICAgIGlmIChjb2RlID4gMHgxMDAwMCkgewogICAgICBieXRlQXJyYXlbMF0gPSAweEYwIHwgKGNvZGUgJiAweDFDMDAwMCkgPj4+IDE4OwogICAgICBieXRlQXJyYXlbMV0gPSAweDgwIHwgKGNvZGUgJiAweDNGMDAwKSA+Pj4gMTI7CiAgICAgIGJ5dGVBcnJheVsyXSA9IDB4ODAgfCAoY29kZSAmIDB4RkMwKSA+Pj4gNjsKICAgICAgYnl0ZUFycmF5WzNdID0gMHg4MCB8IGNvZGUgJiAweDNGOwogICAgfSBlbHNlIGlmIChjb2RlID4gMHg4MDApIHsKICAgICAgYnl0ZUFycmF5WzBdID0gMHhFMCB8IChjb2RlICYgMHhGMDAwKSA+Pj4gMTI7CiAgICAgIGJ5dGVBcnJheVsxXSA9IDB4ODAgfCAoY29kZSAmIDB4RkMwKSA+Pj4gNjsKICAgICAgYnl0ZUFycmF5WzJdID0gMHg4MCB8IGNvZGUgJiAweDNGOwogICAgfSBlbHNlIGlmIChjb2RlID4gMHg4MCkgewogICAgICBieXRlQXJyYXlbMF0gPSAweEMwIHwgKGNvZGUgJiAweDdDMCkgPj4+IDY7CiAgICAgIGJ5dGVBcnJheVsxXSA9IDB4ODAgfCBjb2RlICYgMHgzRjsKICAgIH0gZWxzZSB7CiAgICAgIGJ5dGVBcnJheVswXSA9IGNvZGU7CiAgICB9CiAgICAvKiogRml4IFVuaWNvZGUgY29ycnVwdGlvbiBidWcqLwoKCiAgICBfcGFyc2VkRGF0YS5wdXNoKGJ5dGVBcnJheSk7CiAgfQoKICBfcGFyc2VkRGF0YSA9IEFycmF5LnByb3RvdHlwZS5jb25jYXQuYXBwbHkoW10sIF9wYXJzZWREYXRhKTsKCiAgaWYgKF9wYXJzZWREYXRhLmxlbmd0aCAhPSBfZGF0YS5sZW5ndGgpIHsKICAgIF9wYXJzZWREYXRhLnVuc2hpZnQoMTkxKTsKCiAgICBfcGFyc2VkRGF0YS51bnNoaWZ0KDE4Nyk7CgogICAgX3BhcnNlZERhdGEudW5zaGlmdCgyMzkpOwogIH0KCiAgdmFyIF9ieXRlcyA9IF9wYXJzZWREYXRhOwoKICBfdGhpcy5nZXRNb2RlID0gZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIF9tb2RlOwogIH07CgogIF90aGlzLmdldExlbmd0aCA9IGZ1bmN0aW9uIChidWZmZXIpIHsKICAgIHJldHVybiBfYnl0ZXMubGVuZ3RoOwogIH07CgogIF90aGlzLndyaXRlID0gZnVuY3Rpb24gKGJ1ZmZlcikgewogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBfYnl0ZXMubGVuZ3RoOyBpICs9IDEpIHsKICAgICAgYnVmZmVyLnB1dChfYnl0ZXNbaV0sIDgpOwogICAgfQogIH07CgogIHJldHVybiBfdGhpczsKfTsKLyoqIEdJRiBTdXBwb3J0IGV0Yy4qLwoKLyoqDQogKiAvLyBieXRlQXJyYXlPdXRwdXRTdHJlYW0NCiAqLwoKCnZhciBieXRlQXJyYXlPdXRwdXRTdHJlYW0gPSBmdW5jdGlvbiBieXRlQXJyYXlPdXRwdXRTdHJlYW0oKSB7CiAgdmFyIF9ieXRlcyA9IG5ldyBBcnJheSgpOwoKICB2YXIgX3RoaXMgPSB7fTsKCiAgX3RoaXMud3JpdGVCeXRlID0gZnVuY3Rpb24gKGIpIHsKICAgIF9ieXRlcy5wdXNoKGIgJiAweGZmKTsKICB9OwoKICBfdGhpcy53cml0ZVNob3J0ID0gZnVuY3Rpb24gKGkpIHsKICAgIF90aGlzLndyaXRlQnl0ZShpKTsKCiAgICBfdGhpcy53cml0ZUJ5dGUoaSA+Pj4gOCk7CiAgfTsKCiAgX3RoaXMud3JpdGVCeXRlcyA9IGZ1bmN0aW9uIChiLCBvZmYsIGxlbikgewogICAgb2ZmID0gb2ZmIHx8IDA7CiAgICBsZW4gPSBsZW4gfHwgYi5sZW5ndGg7CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkgKz0gMSkgewogICAgICBfdGhpcy53cml0ZUJ5dGUoYltpICsgb2ZmXSk7CiAgICB9CiAgfTsKCiAgX3RoaXMud3JpdGVTdHJpbmcgPSBmdW5jdGlvbiAocykgewogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzLmxlbmd0aDsgaSArPSAxKSB7CiAgICAgIF90aGlzLndyaXRlQnl0ZShzLmNoYXJDb2RlQXQoaSkpOwogICAgfQogIH07CgogIF90aGlzLnRvQnl0ZUFycmF5ID0gZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIF9ieXRlczsKICB9OwoKICBfdGhpcy50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKICAgIHZhciBzID0gJyc7CiAgICBzICs9ICdbJzsKCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IF9ieXRlcy5sZW5ndGg7IGkgKz0gMSkgewogICAgICBpZiAoaSA+IDApIHsKICAgICAgICBzICs9ICcsJzsKICAgICAgfQoKICAgICAgcyArPSBfYnl0ZXNbaV07CiAgICB9CgogICAgcyArPSAnXSc7CiAgICByZXR1cm4gczsKICB9OwoKICByZXR1cm4gX3RoaXM7Cn07Ci8qKiANCi8vIGJhc2U2NEVuY29kZU91dHB1dFN0cmVhbQ0KKi8KCgp2YXIgYmFzZTY0RW5jb2RlT3V0cHV0U3RyZWFtID0gZnVuY3Rpb24gYmFzZTY0RW5jb2RlT3V0cHV0U3RyZWFtKCkgewogIHZhciBfYnVmZmVyID0gMDsKICB2YXIgX2J1ZmxlbiA9IDA7CiAgdmFyIF9sZW5ndGggPSAwOwogIHZhciBfYmFzZTY0ID0gJyc7CiAgdmFyIF90aGlzID0ge307CgogIHZhciB3cml0ZUVuY29kZWQgPSBmdW5jdGlvbiB3cml0ZUVuY29kZWQoYikgewogICAgX2Jhc2U2NCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGVuY29kZShiICYgMHgzZikpOwogIH07CgogIHZhciBlbmNvZGUgPSBmdW5jdGlvbiBlbmNvZGUobikgewogICAgaWYgKG4gPCAwKSB7CiAgICAgIC8qKmVycm9yLiAqLwogICAgfSBlbHNlIGlmIChuIDwgMjYpIHsKICAgICAgcmV0dXJuIDB4NDEgKyBuOwogICAgfSBlbHNlIGlmIChuIDwgNTIpIHsKICAgICAgcmV0dXJuIDB4NjEgKyAobiAtIDI2KTsKICAgIH0gZWxzZSBpZiAobiA8IDYyKSB7CiAgICAgIHJldHVybiAweDMwICsgKG4gLSA1Mik7CiAgICB9IGVsc2UgaWYgKG4gPT0gNjIpIHsKICAgICAgcmV0dXJuIDB4MmI7CiAgICB9IGVsc2UgaWYgKG4gPT0gNjMpIHsKICAgICAgcmV0dXJuIDB4MmY7CiAgICB9CgogICAgdGhyb3cgbmV3IEVycm9yKCduOicgKyBuKTsKICB9OwoKICBfdGhpcy53cml0ZUJ5dGUgPSBmdW5jdGlvbiAobikgewogICAgX2J1ZmZlciA9IF9idWZmZXIgPDwgOCB8IG4gJiAweGZmOwogICAgX2J1ZmxlbiArPSA4OwogICAgX2xlbmd0aCArPSAxOwoKICAgIHdoaWxlIChfYnVmbGVuID49IDYpIHsKICAgICAgd3JpdGVFbmNvZGVkKF9idWZmZXIgPj4+IF9idWZsZW4gLSA2KTsKICAgICAgX2J1ZmxlbiAtPSA2OwogICAgfQogIH07CgogIF90aGlzLmZsdXNoID0gZnVuY3Rpb24gKCkgewogICAgaWYgKF9idWZsZW4gPiAwKSB7CiAgICAgIHdyaXRlRW5jb2RlZChfYnVmZmVyIDw8IDYgLSBfYnVmbGVuKTsKICAgICAgX2J1ZmZlciA9IDA7CiAgICAgIF9idWZsZW4gPSAwOwogICAgfQoKICAgIGlmIChfbGVuZ3RoICUgMyAhPSAwKSB7CiAgICAgIC8qKnBhZGRpbmcgKi8KICAgICAgdmFyIHBhZGxlbiA9IDMgLSBfbGVuZ3RoICUgMzsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGFkbGVuOyBpICs9IDEpIHsKICAgICAgICBfYmFzZTY0ICs9ICc9JzsKICAgICAgfQogICAgfQogIH07CgogIF90aGlzLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIF9iYXNlNjQ7CiAgfTsKCiAgcmV0dXJuIF90aGlzOwp9OwovKiogDQovLyBiYXNlNjREZWNvZGVJbnB1dFN0cmVhbQ0KKi8KCgp2YXIgYmFzZTY0RGVjb2RlSW5wdXRTdHJlYW0gPSBmdW5jdGlvbiBiYXNlNjREZWNvZGVJbnB1dFN0cmVhbShzdHIpIHsKICB2YXIgX3N0ciA9IHN0cjsKICB2YXIgX3BvcyA9IDA7CiAgdmFyIF9idWZmZXIgPSAwOwogIHZhciBfYnVmbGVuID0gMDsKICB2YXIgX3RoaXMgPSB7fTsKCiAgX3RoaXMucmVhZCA9IGZ1bmN0aW9uICgpIHsKICAgIHdoaWxlIChfYnVmbGVuIDwgOCkgewogICAgICBpZiAoX3BvcyA+PSBfc3RyLmxlbmd0aCkgewogICAgICAgIGlmIChfYnVmbGVuID09IDApIHsKICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICB9CgogICAgICAgIHRocm93IG5ldyBFcnJvcigndW5leHBlY3RlZCBlbmQgb2YgZmlsZS4vJyArIF9idWZsZW4pOwogICAgICB9CgogICAgICB2YXIgYyA9IF9zdHIuY2hhckF0KF9wb3MpOwoKICAgICAgX3BvcyArPSAxOwoKICAgICAgaWYgKGMgPT0gJz0nKSB7CiAgICAgICAgX2J1ZmxlbiA9IDA7CiAgICAgICAgcmV0dXJuIC0xOwogICAgICB9IGVsc2UgaWYgKGMubWF0Y2goL15ccyQvKSkgewogICAgICAgIC8qKiBpZ25vcmUgaWYgd2hpdGVzcGFjZS4gKi8KICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgX2J1ZmZlciA9IF9idWZmZXIgPDwgNiB8IGRlY29kZShjLmNoYXJDb2RlQXQoMCkpOwogICAgICBfYnVmbGVuICs9IDY7CiAgICB9CgogICAgdmFyIG4gPSBfYnVmZmVyID4+PiBfYnVmbGVuIC0gOCAmIDB4ZmY7CiAgICBfYnVmbGVuIC09IDg7CiAgICByZXR1cm4gbjsKICB9OwoKICB2YXIgZGVjb2RlID0gZnVuY3Rpb24gZGVjb2RlKGMpIHsKICAgIGlmICgweDQxIDw9IGMgJiYgYyA8PSAweDVhKSB7CiAgICAgIHJldHVybiBjIC0gMHg0MTsKICAgIH0gZWxzZSBpZiAoMHg2MSA8PSBjICYmIGMgPD0gMHg3YSkgewogICAgICByZXR1cm4gYyAtIDB4NjEgKyAyNjsKICAgIH0gZWxzZSBpZiAoMHgzMCA8PSBjICYmIGMgPD0gMHgzOSkgewogICAgICByZXR1cm4gYyAtIDB4MzAgKyA1MjsKICAgIH0gZWxzZSBpZiAoYyA9PSAweDJiKSB7CiAgICAgIHJldHVybiA2MjsKICAgIH0gZWxzZSBpZiAoYyA9PSAweDJmKSB7CiAgICAgIHJldHVybiA2MzsKICAgIH0gZWxzZSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignYzonICsgYyk7CiAgICB9CiAgfTsKCiAgcmV0dXJuIF90aGlzOwp9OwovKioNCi8vIGdpZkltYWdlIChCL1cpDQogKi8KCgp2YXIgZ2lmSW1hZ2UgPSBmdW5jdGlvbiBnaWZJbWFnZSh3aWR0aCwgaGVpZ2h0KSB7CiAgdmFyIF93aWR0aCA9IHdpZHRoOwogIHZhciBfaGVpZ2h0ID0gaGVpZ2h0OwoKICB2YXIgX2RhdGEgPSBuZXcgQXJyYXkod2lkdGggKiBoZWlnaHQpOwoKICB2YXIgX3RoaXMgPSB7fTsKCiAgX3RoaXMuc2V0UGl4ZWwgPSBmdW5jdGlvbiAoeCwgeSwgcGl4ZWwpIHsKICAgIF9kYXRhW3kgKiBfd2lkdGggKyB4XSA9IHBpeGVsOwogIH07CgogIF90aGlzLndyaXRlID0gZnVuY3Rpb24gKG91dCkgewogICAgLyoqIEdJRiBTaWduYXR1cmUqLwogICAgb3V0LndyaXRlU3RyaW5nKCdHSUY4N2EnKTsKICAgIC8qKlNjcmVlbiBEZXNjcmlwdG9yICovCgogICAgb3V0LndyaXRlU2hvcnQoX3dpZHRoKTsKICAgIG91dC53cml0ZVNob3J0KF9oZWlnaHQpOwogICAgb3V0LndyaXRlQnl0ZSgweDgwKTsKICAgIC8qKjJiaXQgKi8KCiAgICBvdXQud3JpdGVCeXRlKDApOwogICAgb3V0LndyaXRlQnl0ZSgwKTsKICAgIC8qKkdsb2JhbCBDb2xvciBNYXAgKi8KCiAgICAvKipibGFjayAqLwoKICAgIG91dC53cml0ZUJ5dGUoMHgwMCk7CiAgICBvdXQud3JpdGVCeXRlKDB4MDApOwogICAgb3V0LndyaXRlQnl0ZSgweDAwKTsKICAgIC8qKiB3aGl0ZSAqLwoKICAgIG91dC53cml0ZUJ5dGUoMHhmZik7CiAgICBvdXQud3JpdGVCeXRlKDB4ZmYpOwogICAgb3V0LndyaXRlQnl0ZSgweGZmKTsKICAgIC8qKkltYWdlIERlc2NyaXB0b3IgKi8KCiAgICBvdXQud3JpdGVTdHJpbmcoJywnKTsKICAgIG91dC53cml0ZVNob3J0KDApOwogICAgb3V0LndyaXRlU2hvcnQoMCk7CiAgICBvdXQud3JpdGVTaG9ydChfd2lkdGgpOwogICAgb3V0LndyaXRlU2hvcnQoX2hlaWdodCk7CiAgICBvdXQud3JpdGVCeXRlKDApOwogICAgLyoqUmFzdGVyIERhdGEgKi8KCiAgICB2YXIgbHp3TWluQ29kZVNpemUgPSAyOwogICAgdmFyIHJhc3RlciA9IGdldExaV1Jhc3RlcihsendNaW5Db2RlU2l6ZSk7CiAgICBvdXQud3JpdGVCeXRlKGx6d01pbkNvZGVTaXplKTsKICAgIHZhciBvZmZzZXQgPSAwOwoKICAgIHdoaWxlIChyYXN0ZXIubGVuZ3RoIC0gb2Zmc2V0ID4gMjU1KSB7CiAgICAgIG91dC53cml0ZUJ5dGUoMjU1KTsKICAgICAgb3V0LndyaXRlQnl0ZXMocmFzdGVyLCBvZmZzZXQsIDI1NSk7CiAgICAgIG9mZnNldCArPSAyNTU7CiAgICB9CgogICAgb3V0LndyaXRlQnl0ZShyYXN0ZXIubGVuZ3RoIC0gb2Zmc2V0KTsKICAgIG91dC53cml0ZUJ5dGVzKHJhc3Rlciwgb2Zmc2V0LCByYXN0ZXIubGVuZ3RoIC0gb2Zmc2V0KTsKICAgIG91dC53cml0ZUJ5dGUoMHgwMCk7CiAgICAvKioNCiAgICAgICogR0lGIFRlcm1pbmF0b3IgKi8KCiAgICBvdXQud3JpdGVTdHJpbmcoJzsnKTsKICB9OwoKICB2YXIgYml0T3V0cHV0U3RyZWFtID0gZnVuY3Rpb24gYml0T3V0cHV0U3RyZWFtKG91dCkgewogICAgdmFyIF9vdXQgPSBvdXQ7CiAgICB2YXIgX2JpdExlbmd0aCA9IDA7CiAgICB2YXIgX2JpdEJ1ZmZlciA9IDA7CiAgICB2YXIgX3RoaXMgPSB7fTsKCiAgICBfdGhpcy53cml0ZSA9IGZ1bmN0aW9uIChkYXRhLCBsZW5ndGgpIHsKICAgICAgaWYgKGRhdGEgPj4+IGxlbmd0aCAhPSAwKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdsZW5ndGggb3ZlcicpOwogICAgICB9CgogICAgICB3aGlsZSAoX2JpdExlbmd0aCArIGxlbmd0aCA+PSA4KSB7CiAgICAgICAgX291dC53cml0ZUJ5dGUoMHhmZiAmIChkYXRhIDw8IF9iaXRMZW5ndGggfCBfYml0QnVmZmVyKSk7CgogICAgICAgIGxlbmd0aCAtPSA4IC0gX2JpdExlbmd0aDsKICAgICAgICBkYXRhID4+Pj0gOCAtIF9iaXRMZW5ndGg7CiAgICAgICAgX2JpdEJ1ZmZlciA9IDA7CiAgICAgICAgX2JpdExlbmd0aCA9IDA7CiAgICAgIH0KCiAgICAgIF9iaXRCdWZmZXIgPSBkYXRhIDw8IF9iaXRMZW5ndGggfCBfYml0QnVmZmVyOwogICAgICBfYml0TGVuZ3RoID0gX2JpdExlbmd0aCArIGxlbmd0aDsKICAgIH07CgogICAgX3RoaXMuZmx1c2ggPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmIChfYml0TGVuZ3RoID4gMCkgewogICAgICAgIF9vdXQud3JpdGVCeXRlKF9iaXRCdWZmZXIpOwogICAgICB9CiAgICB9OwoKICAgIHJldHVybiBfdGhpczsKICB9OwoKICB2YXIgZ2V0TFpXUmFzdGVyID0gZnVuY3Rpb24gZ2V0TFpXUmFzdGVyKGx6d01pbkNvZGVTaXplKSB7CiAgICB2YXIgY2xlYXJDb2RlID0gMSA8PCBsendNaW5Db2RlU2l6ZTsKICAgIHZhciBlbmRDb2RlID0gKDEgPDwgbHp3TWluQ29kZVNpemUpICsgMTsKICAgIHZhciBiaXRMZW5ndGggPSBsendNaW5Db2RlU2l6ZSArIDE7CiAgICAvKiogDQogICAgICAqIFNldHVwIExaV1RhYmxlDQogICAgICovCgogICAgdmFyIHRhYmxlID0gbHp3VGFibGUoKTsKCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNsZWFyQ29kZTsgaSArPSAxKSB7CiAgICAgIHRhYmxlLmFkZChTdHJpbmcuZnJvbUNoYXJDb2RlKGkpKTsKICAgIH0KCiAgICB0YWJsZS5hZGQoU3RyaW5nLmZyb21DaGFyQ29kZShjbGVhckNvZGUpKTsKICAgIHRhYmxlLmFkZChTdHJpbmcuZnJvbUNoYXJDb2RlKGVuZENvZGUpKTsKICAgIHZhciBieXRlT3V0ID0gYnl0ZUFycmF5T3V0cHV0U3RyZWFtKCk7CiAgICB2YXIgYml0T3V0ID0gYml0T3V0cHV0U3RyZWFtKGJ5dGVPdXQpOwogICAgLyoqIA0KICAgICAgKiAgY2xlYXIgY29kZQ0KICAgICAqLwoKICAgIGJpdE91dC53cml0ZShjbGVhckNvZGUsIGJpdExlbmd0aCk7CiAgICB2YXIgZGF0YUluZGV4ID0gMDsKICAgIHZhciBzID0gU3RyaW5nLmZyb21DaGFyQ29kZShfZGF0YVtkYXRhSW5kZXhdKTsKICAgIGRhdGFJbmRleCArPSAxOwoKICAgIHdoaWxlIChkYXRhSW5kZXggPCBfZGF0YS5sZW5ndGgpIHsKICAgICAgdmFyIGMgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKF9kYXRhW2RhdGFJbmRleF0pOwogICAgICBkYXRhSW5kZXggKz0gMTsKCiAgICAgIGlmICh0YWJsZS5jb250YWlucyhzICsgYykpIHsKICAgICAgICBzID0gcyArIGM7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYml0T3V0LndyaXRlKHRhYmxlLmluZGV4T2YocyksIGJpdExlbmd0aCk7CgogICAgICAgIGlmICh0YWJsZS5zaXplKCkgPCAweGZmZikgewogICAgICAgICAgaWYgKHRhYmxlLnNpemUoKSA9PSAxIDw8IGJpdExlbmd0aCkgewogICAgICAgICAgICBiaXRMZW5ndGggKz0gMTsKICAgICAgICAgIH0KCiAgICAgICAgICB0YWJsZS5hZGQocyArIGMpOwogICAgICAgIH0KCiAgICAgICAgcyA9IGM7CiAgICAgIH0KICAgIH0KCiAgICBiaXRPdXQud3JpdGUodGFibGUuaW5kZXhPZihzKSwgYml0TGVuZ3RoKTsKICAgIC8qKiANCiAgICAgICogZW5kIGNvZGUNCiAgICAgICogKi8KCiAgICBiaXRPdXQud3JpdGUoZW5kQ29kZSwgYml0TGVuZ3RoKTsKICAgIGJpdE91dC5mbHVzaCgpOwogICAgcmV0dXJuIGJ5dGVPdXQudG9CeXRlQXJyYXkoKTsKICB9OwoKICB2YXIgbHp3VGFibGUgPSBmdW5jdGlvbiBsendUYWJsZSgpIHsKICAgIHZhciBfbWFwID0ge307CiAgICB2YXIgX3NpemUgPSAwOwogICAgdmFyIF90aGlzID0ge307CgogICAgX3RoaXMuYWRkID0gZnVuY3Rpb24gKGtleSkgewogICAgICBpZiAoX3RoaXMuY29udGFpbnMoa2V5KSkgewogICAgICAgIHRocm93IG5ldyBFcnJvcignZHVwIGtleTonICsga2V5KTsKICAgICAgfQoKICAgICAgX21hcFtrZXldID0gX3NpemU7CiAgICAgIF9zaXplICs9IDE7CiAgICB9OwoKICAgIF90aGlzLnNpemUgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBfc2l6ZTsKICAgIH07CgogICAgX3RoaXMuaW5kZXhPZiA9IGZ1bmN0aW9uIChrZXkpIHsKICAgICAgcmV0dXJuIF9tYXBba2V5XTsKICAgIH07CgogICAgX3RoaXMuY29udGFpbnMgPSBmdW5jdGlvbiAoa2V5KSB7CiAgICAgIHJldHVybiB0eXBlb2YgX21hcFtrZXldICE9ICd1bmRlZmluZWQnOwogICAgfTsKCiAgICByZXR1cm4gX3RoaXM7CiAgfTsKCiAgcmV0dXJuIF90aGlzOwp9OwoKdmFyIGNyZWF0ZUltZ1RhZyA9IGZ1bmN0aW9uIGNyZWF0ZUltZ1RhZyh3aWR0aCwgaGVpZ2h0LCBnZXRQaXhlbCwgYWx0KSB7CiAgdmFyIGdpZiA9IGdpZkltYWdlKHdpZHRoLCBoZWlnaHQpOwoKICBmb3IgKHZhciB5ID0gMDsgeSA8IGhlaWdodDsgeSArPSAxKSB7CiAgICBmb3IgKHZhciB4ID0gMDsgeCA8IHdpZHRoOyB4ICs9IDEpIHsKICAgICAgZ2lmLnNldFBpeGVsKHgsIHksIGdldFBpeGVsKHgsIHkpKTsKICAgIH0KICB9CgogIHZhciBiID0gYnl0ZUFycmF5T3V0cHV0U3RyZWFtKCk7CiAgZ2lmLndyaXRlKGIpOwogIHZhciBiYXNlNjQgPSBiYXNlNjRFbmNvZGVPdXRwdXRTdHJlYW0oKTsKICB2YXIgYnl0ZXMgPSBiLnRvQnl0ZUFycmF5KCk7CgogIGZvciAodmFyIGkgPSAwOyBpIDwgYnl0ZXMubGVuZ3RoOyBpICs9IDEpIHsKICAgIGJhc2U2NC53cml0ZUJ5dGUoYnl0ZXNbaV0pOwogIH0KCiAgYmFzZTY0LmZsdXNoKCk7CiAgdmFyIGltZyA9ICcnOwogIGltZyArPSAnZGF0YTppbWFnZS9naWY7YmFzZTY0LCc7CiAgaW1nICs9IGJhc2U2NDsKICByZXR1cm4gaW1nOwp9OwovKiogDQogKiByZXR1cm5zIHFyY29kZSBmdW5jdGlvbi4NCiAqICovCgoKdmFyIGNyZWF0ZVFyQ29kZUltZyA9IGZ1bmN0aW9uIGNyZWF0ZVFyQ29kZUltZyhvcHRpb25zKSB7CiAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307CiAgb3B0aW9ucy5zaXplID0gb3B0aW9ucy5zaXplOwogIHZhciB0eXBlTnVtYmVyID0gb3B0aW9ucy50eXBlTnVtYmVyIHx8IDQ7CiAgdmFyIGVycm9yQ29ycmVjdExldmVsID0gb3B0aW9ucy5lcnJvckNvcnJlY3RMZXZlbCB8fCAnTSc7CiAgdmFyIHNpemUgPSBvcHRpb25zLnNpemUgfHwgNTAwOwogIHZhciBxcjsKCiAgdHJ5IHsKICAgIHFyID0gcXJjb2RlKHR5cGVOdW1iZXIsIGVycm9yQ29ycmVjdExldmVsIHx8ICdNJyk7CiAgICBxci5hZGREYXRhKG9wdGlvbnMudGV4dCk7CiAgICBxci5tYWtlKCk7CiAgfSBjYXRjaCAoZSkgewogICAgaWYgKHR5cGVOdW1iZXIgPj0gNDApIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdUZXh0IHRvbyBsb25nIHRvIGVuY29kZScpOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIGNyZWF0ZVFyQ29kZUltZyhvcHRpb25zLnRleHQsIHsKICAgICAgICBzaXplOiBzaXplLAogICAgICAgIGVycm9yQ29ycmVjdExldmVsOiBlcnJvckNvcnJlY3RMZXZlbCwKICAgICAgICB0eXBlTnVtYmVyOiB0eXBlTnVtYmVyICsgMQogICAgICB9KTsKICAgIH0KICB9CiAgLyoqY2FsYyBjZWxsc2l6ZSBhbmQgbWFyZ2luICovCgoKICB2YXIgY2VsbHNpemUgPSBwYXJzZUludChzaXplIC8gcXIuZ2V0TW9kdWxlQ291bnQoKSk7CiAgdmFyIG1hcmdpbiA9IHBhcnNlSW50KChzaXplIC0gcXIuZ2V0TW9kdWxlQ291bnQoKSAqIGNlbGxzaXplKSAvIDIpOwogIHJldHVybiBxci5jcmVhdGVJbWdUYWcoY2VsbHNpemUsIG1hcmdpbiwgc2l6ZSk7Cn07Cgp2YXIgbW9kdWxlID0ge307CmV4cG9ydCBkZWZhdWx0IGNyZWF0ZVFyQ29kZUltZzs="},null]}